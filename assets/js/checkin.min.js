jQuery(function(e){"use strict";window.wc_sb_checkin={init:function(){if(this.isCheckinEnabled()){var n=this;e(document.body).on("click change","#checkin_country",function(){n.loadCheckIn(e(this).val())});let o=e("#checkin_country");o.length>0?n.loadCheckIn(o.val()):n.loadCheckIn(WC_Gateway_Swedbank_Pay_Checkin.checkin_country),e(document.body).on("click","#change-address-info",function(e){e.preventDefault(),n.showAddressFields()}),n.hideAddressFields()}},isCheckinEnabled:()=>WC_Gateway_Swedbank_Pay_Checkin.enabled,loadCheckIn:function(n){return e.ajax({type:"POST",url:WC_Gateway_Swedbank_Pay_Checkin.ajax_url,data:{action:"swedbank_pay_checkin",nonce:WC_Gateway_Swedbank_Pay_Checkin.nonce,country:n},dataType:"json"}).done(function(n){if(!n.success)return wc_sb_common.logError("sb-checkin-loader",n),void alert(n.details);window.hasOwnProperty("payex")&&window.payex.hasOwnProperty("hostedView")&&void 0!==window.payex.hostedView.consumer&&window.payex.hostedView.consumer().close(),e("script[src*='px.consumer.client']").remove(),e("#swedbank-pay-checkin iframe").remove(),wc_sb_common.loadJs(n.data,function(){wc_sb_checkin.initCheckIn()})})},initCheckIn:function(){"undefined"!=typeof payex&&wc_sb_common.waitForLoading("payex.hostedView.consumer",function(e){e?console.warn(e):window.payex.hostedView.consumer({container:"swedbank-pay-checkin",culture:WC_Gateway_Swedbank_Pay_Checkin.culture,style:WC_Gateway_Swedbank_Pay_Checkin.checkInStyle?JSON.parse(WC_Gateway_Swedbank_Pay_Checkin.checkInStyle):null,onConsumerIdentified:function(e){console.log("hostedView: onConsumerIdentified"),wc_sb_checkin.onConsumerIdentified(e)},onNewConsumer:function(e){console.log("hostedView: onNewConsumer"),wc_sb_checkin.onConsumerIdentified(e)},onConsumerRemoved:function(e){console.log("hostedView: onConsumerRemoved"),console.log(e)},onBillingDetailsAvailable:function(e){wc_sb_checkin.onAddressDetailsAvailable("billing",e)},onShippingDetailsAvailable:function(e){(WC_Gateway_Swedbank_Pay_Checkin.needs_shipping_address||WC_Gateway_Swedbank_Pay_Checkin.ship_to_billing_address_only)&&wc_sb_checkin.onAddressDetailsAvailable("billing",e),wc_sb_checkin.onAddressDetailsAvailable("shipping",e)},onError:function(e){wc_sb_common.logError("sb-checkin",e),alert(e.details)}}).open()})},onConsumerIdentified:function(n){return console.log("onConsumerIdentified",n),e.ajax({type:"POST",url:WC_Gateway_Swedbank_Pay_Checkin.ajax_url,data:{action:"swedbank_pay_checkout_customer_profile",nonce:WC_Gateway_Swedbank_Pay_Checkin.nonce,consumerProfileRef:n.consumerProfileRef},dataType:"json"}).always(function(e){}).done(function(o){if(!o.success)return void alert(o.data.message);let c=e("form.checkout, form#order_review, form#add_payment_method");c.find(".swedbank_pay_customer_reference").remove(),c.append("<input type='hidden' class='swedbank_pay_customer_reference' name='swedbank_pay_customer_reference' value='"+n.consumerProfileRef+"'/>"),wc_sb_common.isInstantCheckout()&&wc_sb_checkout.initCheckout(n.consumerProfileRef)})},onAddressDetailsAvailable:function(n,o){return console.log("onAddressDetailsAvailable",n,o),wc_sb_common.block(),e.ajax({type:"POST",url:WC_Gateway_Swedbank_Pay_Checkin.ajax_url,data:{action:"swedbank_pay_checkout_get_address",nonce:WC_Gateway_Swedbank_Pay_Checkin.nonce,type:n,url:o.url},dataType:"json"}).always(function(){wc_sb_common.unblock()}).done(function(o){if(console.log(o),!o.success)return wc_sb_common.logError("sb-address-details",o),void alert(o.data.message);let c=o.data;e.each(c,function(o,c){[n].forEach(function(n){let a=e('input[name="'+n+"_"+o+'"]');if(0!==a.length&&(a.prop("readonly",!1),a.closest(".form-row").removeClass("swedbank-pay-locked"),a.val(c).change(),"country"===o||"state"===o)){let a=e("#"+n+"_"+o);void 0!==window.Select2?a.select2("val",c):void 0!==e.fn.chosen?a.val(c).trigger("chosen:updated"):a.change()}})}),e(document.body).trigger("update_checkout")})},hideAddressFields:function(){e(".woocommerce-billing-fields__field-wrapper, .woocommerce-shipping-fields").hide()},showAddressFields:function(){e(".woocommerce-billing-fields__field-wrapper, .woocommerce-shipping-fields").show()}},e(document).ready(function(){wc_sb_checkin.init(e("form.checkout, form#order_review, form#add_payment_method"))})});
//# sourceMappingURL=checkin.min.js.map
