jQuery((function(e){"use strict";window.wc_sb_checkin={customer_identified:!1,init:function(){if(this.isCheckinEnabled()){var n=this;n.loadCheckIn(),e(document.body).on("click","#change-address-info",(function(e){e.preventDefault(),n.showAddressFields()})),n.hideAddressFields()}},isCheckinEnabled:()=>"yes"===WC_Gateway_Swedbank_Pay_Checkin.enabled,isCheckinRequired(){return this.isCheckinEnabled()&&"yes"===WC_Gateway_Swedbank_Pay_Checkin.checkin_required},isCustomerIdentified(){return!0===this.customer_identified},loadCheckIn:function(){return e.ajax({type:"POST",url:WC_Gateway_Swedbank_Pay_Checkin.ajax_url,data:{action:"swedbank_pay_checkin",nonce:WC_Gateway_Swedbank_Pay_Checkin.nonce},dataType:"json"}).done((function(e){if(!e.success)return wc_sb_common.logError("sb-checkin-loader",e),void alert(e.details);window.hasOwnProperty("payex")&&window.payex.hasOwnProperty("hostedView"),wc_sb_common.loadJs(e.data,(function(){wc_sb_checkin.initCheckIn()}))}))},initCheckIn:function(){"undefined"!=typeof payex&&wc_sb_common.waitForLoading("payex.hostedView.consumer",(function(e){e?console.warn(e):window.payex.hostedView.consumer({container:"swedbank-pay-checkin",culture:WC_Gateway_Swedbank_Pay_Checkin.culture,style:WC_Gateway_Swedbank_Pay_Checkin.checkInStyle?JSON.parse(WC_Gateway_Swedbank_Pay_Checkin.checkInStyle):null,onConsumerIdentified:function(e){console.log("hostedView: onConsumerIdentified"),wc_sb_checkin.onConsumerIdentified(e)},onNewConsumer:function(e){console.log("hostedView: onNewConsumer"),wc_sb_checkin.onConsumerIdentified(e)},onConsumerRemoved:function(e){console.log("hostedView: onConsumerRemoved"),console.log(e)},onBillingDetailsAvailable:function(e){wc_sb_checkin.onAddressDetailsAvailable("billing",e)},onShippingDetailsAvailable:function(e){"yes"!==WC_Gateway_Swedbank_Pay_Checkin.needs_shipping_address&&"yes"!==WC_Gateway_Swedbank_Pay_Checkin.ship_to_billing_address_only||wc_sb_checkin.onAddressDetailsAvailable("billing",e),wc_sb_checkin.onAddressDetailsAvailable("shipping",e)},onError:function(e){wc_sb_common.logError("sb-checkin",e),alert(e.details)}}).open()}))},onConsumerIdentified:function(n){console.log("onConsumerIdentified",n);var o=this;return e.ajax({type:"POST",url:WC_Gateway_Swedbank_Pay_Checkin.ajax_url,data:{action:"swedbank_pay_checkout_customer_profile",nonce:WC_Gateway_Swedbank_Pay_Checkin.nonce,consumerProfileRef:n.consumerProfileRef},dataType:"json"}).always((function(e){})).done((function(i){if(!i.success)return void alert(i.data.message);o.customer_identified=!0,e("#swedbank-pay-checkin-edit").show();let a=e("form.checkout, form#order_review, form#add_payment_method");a.find(".swedbank_pay_customer_reference").remove(),a.append("<input type='hidden' class='swedbank_pay_customer_reference' name='swedbank_pay_customer_reference' value='"+n.consumerProfileRef+"'/>"),wc_sb_common.isInstantCheckout()&&wc_sb_checkout.initCheckout(n.consumerProfileRef)}))},onAddressDetailsAvailable:function(n,o){return console.log("onAddressDetailsAvailable",n,o),wc_sb_common.block(),e.ajax({type:"POST",url:WC_Gateway_Swedbank_Pay_Checkin.ajax_url,data:{action:"swedbank_pay_checkout_get_address",nonce:WC_Gateway_Swedbank_Pay_Checkin.nonce,type:n,url:o.url},dataType:"json"}).always((function(){wc_sb_common.unblock()})).done((function(o){if(console.log(o),!o.success)return wc_sb_common.logError("sb-address-details",o),void alert(o.data.message);let i=o.data;e.each(i,(function(o,i){[n].forEach((function(n){let a=e('input[name="'+n+"_"+o+'"]');if(0!==a.length&&(a.prop("readonly",!1),a.closest(".form-row").removeClass("swedbank-pay-locked"),a.val(i).change(),"country"===o||"state"===o)){let a=e("#"+n+"_"+o);void 0!==window.Select2?a.select2("val",i):void 0!==e.fn.chosen?a.val(i).trigger("chosen:updated"):a.change()}}))})),e(document.body).trigger("update_checkout")}))},hideAddressFields:function(){e(".woocommerce-billing-fields__field-wrapper, .woocommerce-shipping-fields").hide()},showAddressFields:function(){e(".woocommerce-billing-fields__field-wrapper, .woocommerce-shipping-fields").show()}},e(document).ready((function(){wc_sb_checkin.init(e("form.checkout, form#order_review, form#add_payment_method"))}))}));
//# sourceMappingURL=checkin.min.js.map
