jQuery(function($){"use strict";window.wc_payex_checkout={js_url:null,paymentMenu:null,isPaymentMenuLoaded:!1,xhr:!1,init:function(e){this.form=e,this.form_submit=!1,$(this.form).on("click","#place_order",this.onSubmit).on("submit checkout_place_order_payex_checkout"),$(document.body).bind("update_checkout",this.onUpdateCheckout),$(document.body).on("checkout_error",this.resetCheckout),$(document.body).on("updated_checkout",this.onUpdatedCheckout),$(document.body).on("blur",this.onUpdatedCheckout),$(document.body).on("click","#change-shipping-info",function(){$("#change-shipping-info").hide(),wc_payex_checkout.showAddressFields()}),$(document.body).on("change","#checkin_country",function(){wc_payex_checkout.loadCheckIn($(this).val())}),wc_payex_checkout.isInstantCheckout()&&wc_payex_checkout.initInstantCheckout()},initInstantCheckout:function(){console.log("Initialization of Instant Checkout..."),wc_payex_checkout.isCheckinEnabled()&&wc_payex_checkout.hideAddressFields();let e=$("#payex-consumer-profile");if(e.length>0){let o=e.data("reference");console.log("Initiate consumerProfileRef",o),wc_payex_checkout.initCheckIn()}else wc_payex_checkout.initCheckIn()},loadCheckIn:function(e){return $.ajax({type:"POST",url:WC_Gateway_PayEx_Checkout.ajax_url,data:{action:"sb_checkin",nonce:WC_Gateway_PayEx_Checkout.nonce,country:e},dataType:"json"}).done(function(e){if(!e.success)return wc_payex_checkout.logError("payex-checkin-loader",e),void alert(e.details);window.hasOwnProperty("payex")&&window.payex.hasOwnProperty("hostedView")&&void 0!==window.payex.hostedView.consumer&&window.payex.hostedView.consumer().close(),$("script[src*='px.consumer.client']").remove(),$("#payex-checkin iframe").remove(),wc_payex_checkout.loadJs(e.data,function(){wc_payex_checkout.initCheckIn()})})},initCheckIn:function(){"undefined"!=typeof payex&&wc_payex_checkout.waitForLoading("payex.hostedView.consumer",function(e){e?console.warn(e):window.payex.hostedView.consumer({container:"payex-checkin",culture:WC_Gateway_PayEx_Checkout.culture,style:WC_Gateway_PayEx_Checkout.checkInStyle?JSON.parse(WC_Gateway_PayEx_Checkout.checkInStyle):null,onConsumerIdentified:function(e){console.log("hostedView: onConsumerIdentified"),wc_payex_checkout.onConsumerIdentified(e)},onNewConsumer:function(e){console.log("hostedView: onNewConsumer"),wc_payex_checkout.onConsumerIdentified(e)},onConsumerRemoved:function(e){console.log("hostedView: onConsumerRemoved")},onBillingDetailsAvailable:function(e){wc_payex_checkout.onAddressDetailsAvailable("billing",e)},onShippingDetailsAvailable:function(e){(WC_Gateway_PayEx_Checkout.needs_shipping_address||WC_Gateway_PayEx_Checkout.ship_to_billing_address_only)&&wc_payex_checkout.onAddressDetailsAvailable("billing",e),wc_payex_checkout.onAddressDetailsAvailable("shipping",e)},onError:function(e){wc_payex_checkout.logError("payex-checkin",e),alert(e.details),wc_payex_checkout.onError(e.details)}}).open()})},initCheckout:function(e){$("#change-shipping-info").show(),wc_payex_checkout.form.find(".payex_customer_reference").remove(),wc_payex_checkout.form.append("<input type='hidden' class='payex_customer_reference' name='payex_customer_reference' value='"+e+"'/>"),wc_payex_checkout.onSubmit()},isInstantCheckout:()=>WC_Gateway_PayEx_Checkout.instant_checkout,isCheckinEnabled:()=>WC_Gateway_PayEx_Checkout.checkin,isPaymentMethodChosen:function(){return $("#payment_method_payex_checkout").is(":checked")},block:function(){1!==wc_payex_checkout.form.data()["blockUI.isBlocked"]&&wc_payex_checkout.form.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblock:function(){wc_payex_checkout.form.unblock()},onClose:function(){wc_payex_checkout.unblock()},onReady:function(){console.log("Ready")},onUpdateCheckout:function(){if(console.log("onUpdateCheckout"),!wc_payex_checkout.isInstantCheckout())return!1},onUpdatedCheckout:function(){return console.log("onUpdatedCheckout"),!!wc_payex_checkout.isInstantCheckout()&&(!wc_payex_checkout.form.is(".processing")&&(wc_payex_checkout.validateForm()?(wc_payex_checkout.xhr&&wc_payex_checkout.xhr.abort(),$(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),wc_payex_checkout.form.addClass("processing"),wc_payex_checkout.block(),void(wc_payex_checkout.xhr=wc_payex_checkout.updateOrder().always(function(e){wc_payex_checkout.form.removeClass("processing"),wc_payex_checkout.unblock()}).fail(function(e,o){console.log("updateOrder error:"+o),wc_payex_checkout.onError(o)}).done(function(e){if(console.log(e),this.xhr=!1,"success"!==e.result)return e.hasOwnProperty("reload")&&!0===e.reload?void window.location.reload():(!0===e.result.refresh&&$(document.body).trigger("update_checkout"),void wc_payex_checkout.onError(e.messages));wc_payex_checkout.js_url=e.js_url,wc_payex_checkout.refreshPaymentMenu()}))):(console.log("onUpdatedCheckout: Validation is failed"),!1)))},onSubmit:function(e){return!!wc_payex_checkout.form_submit||(!wc_payex_checkout.isPaymentMethodChosen()||(void 0!==e&&e.preventDefault(),!!wc_payex_checkout.validateForm()&&(console.log("onSubmit"),!wc_payex_checkout.form.is(".processing")&&($(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),wc_payex_checkout.form.addClass("processing"),wc_payex_checkout.block(),wc_payex_checkout.placeOrder().always(function(e){wc_payex_checkout.form.removeClass("processing"),wc_payex_checkout.unblock()}).fail(function(e,o){wc_payex_checkout.onError(o)}).done(function(e){if(console.log(e),"success"!==e.result)return e.hasOwnProperty("reload")&&!0===e.reload?void window.location.reload():(!0===e.result.refresh&&$(document.body).trigger("update_checkout"),void wc_payex_checkout.onError(e.messages));wc_payex_checkout.js_url=e.js_url,wc_payex_checkout.initPaymentJS(wc_payex_checkout.js_url)}),!1))))},resetCheckout:function(){wc_payex_checkout.form_submit=!1},validateForm:function(){var e,o=!0;return(e=$("#ship-to-different-address-checkbox").is(":checked")?$(".woocommerce-billing-fields .validate-required, .woocommerce-shipping-fields .validate-required").find("input, select").not($("#account_password, #account_username")):$(".woocommerce-billing-fields .validate-required").find("input, select").not($("#account_password, #account_username"))).length&&e.each(function(){var e=$(this),c=e.closest(".form-row"),t=c.is(".validate-required"),n=c.is(".validate-email");(t&&("checkbox"!==e.attr("type")||e.is(":checked")?""===e.val()&&(o=!1):o=!1),n)&&(e.val()&&(new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i).test(e.val())||(o=!1)))}),o},waitForLoading:function(var_string,callback){try{var obj=eval(var_string)}catch(e){return void callback(e)}let attempts=0,timer=window.setInterval(function(){void 0!==obj?(window.clearInterval(timer),callback(null,obj)):++attempts>=120&&(window.clearInterval(timer),callback("Timeout"))},500)},loadJs:function(e,o){console.log("Loading of "+e);let c=document.createElement("script");c.setAttribute("src",e),c.setAttribute("type","text/javascript"),c.setAttribute("async",""),c.addEventListener("load",function(){console.log("Loaded: "+e),o()},!1);let t=document.getElementsByTagName("head")[0];return t&&t.appendChild(c),c},initPaymentJS:function(e,o){void 0===o&&(o=function(){}),window.hasOwnProperty("payex")&&window.payex.hasOwnProperty("hostedView")&&(void 0!==window.payex.hostedView.paymentMenu&&window.payex.hostedView.paymentMenu().close(),$("#payment-payex-checkout iframe").remove()),$("script[src*='px.paymentmenu.client']").remove(),wc_payex_checkout.loadJs(e,function(){$("#payment-payex-checkout iframe").remove(),wc_payex_checkout.isInstantCheckout()?($("#payment").hide(),wc_payex_checkout.initPaymentMenu("payment-payex-checkout")):$.featherlight('<div id="payex-paymentmenu">&nbsp;</div>',{variant:"featherlight-payex",persist:!0,closeOnClick:!1,closeOnEsc:!1,afterOpen:function(){wc_payex_checkout.initPaymentMenu("payex-paymentmenu")},afterClose:function(){wc_payex_checkout.form.removeClass("processing").unblock()}}),o()})},initPaymentMenu:function(e,o){console.log("initPaymentMenu"),void 0===o&&(o=function(){}),this.paymentMenu=window.payex.hostedView.paymentMenu({container:e,culture:WC_Gateway_PayEx_Checkout.culture,style:WC_Gateway_PayEx_Checkout.paymentMenuStyle?JSON.parse(WC_Gateway_PayEx_Checkout.paymentMenuStyle):null,onApplicationConfigured:function(e){console.log("onApplicationConfigured"),console.log(e),wc_payex_checkout.isPaymentMenuLoaded=!0,o(null)},onPaymentMenuInstrumentSelected:function(e){console.log("onPaymentMenuInstrumentSelected"),console.log(e),wc_payex_checkout.onPaymentMenuInstrumentSelected(e.name,e.instrument)},onPaymentCreated:function(){console.log("onPaymentCreated")},onPaymentCompleted:function(e){console.log("onPaymentCompleted"),console.log(e),self.location.href=e.redirectUrl},onPaymentCanceled:function(e){console.log("onPaymentCanceled"),console.log(e),wc_payex_checkout.logError("payment-menu-cancel",e)},onPaymentFailed:function(e){console.log("onPaymentFailed"),console.log(e),wc_payex_checkout.logError("payment-menu-failed",e)},onError:function(e){wc_payex_checkout.logError("payment-menu-error",e),o(e)}}),this.paymentMenu.open()},refreshPaymentMenu:function(){console.log("refreshPaymentMenu"),void 0!==this.paymentMenu&&"function"==typeof this.paymentMenu.refresh?this.paymentMenu.refresh():console.warn("refreshPaymentMenu: refresh workaround")},placeOrder:function(){console.log("placeOrder");let e=$(".woocommerce-checkout").serialize();return $.ajax({type:"POST",url:WC_Gateway_PayEx_Checkout.ajax_url,data:{action:"payex_place_order",nonce:WC_Gateway_PayEx_Checkout.nonce,data:e},dataType:"json"}).done(function(e){e.hasOwnProperty("reload")&&!0===e.reload?window.location.reload():e.hasOwnProperty("result")&&"failure"===e.result&&(wc_payex_checkout.logError("payex-place-order",e),wc_payex_checkout.onError(e.messages))})},updateOrder:function(){console.log("updateOrder");let e=$(".woocommerce-checkout").serialize();return $.ajax({type:"POST",url:WC_Gateway_PayEx_Checkout.ajax_url,data:{action:"payex_update_order",nonce:WC_Gateway_PayEx_Checkout.nonce,data:e},dataType:"json"}).done(function(e){if(e.hasOwnProperty("result")&&"failure"===e.result){if(e.messages.indexOf("Order update is not available.")>-1)return console.warn("refreshPaymentMenu: refresh workaround. Force reload."),void wc_payex_checkout.initPaymentJS(wc_payex_checkout.js_url);if(e.hasOwnProperty("reload")&&!0===e.reload)return void window.location.reload();wc_payex_checkout.logError("payex-update-order",e),wc_payex_checkout.onError(e.messages)}})},onConsumerIdentified:function(e){return console.log("onConsumerIdentified",e),$("#change-shipping-info").show(),$.ajax({type:"POST",url:WC_Gateway_PayEx_Checkout.ajax_url,data:{action:"payex_checkout_customer_profile",nonce:WC_Gateway_PayEx_Checkout.nonce,consumerProfileRef:e.consumerProfileRef},dataType:"json"}).always(function(e){}).done(function(o){console.log(o),o.success?wc_payex_checkout.initCheckout(e.consumerProfileRef):alert(o.data.message)})},onAddressDetailsAvailable:function(e,o){return console.log("onAddressDetailsAvailable",e,o),$("#change-shipping-info").show(),wc_payex_checkout.block(),$.ajax({type:"POST",url:WC_Gateway_PayEx_Checkout.ajax_url,data:{action:"payex_checkout_get_address",nonce:WC_Gateway_PayEx_Checkout.nonce,type:e,url:o.url},dataType:"json"}).always(function(e){wc_payex_checkout.unblock()}).done(function(o){if(console.log(o),!o.success)return wc_payex_checkout.logError("payex-address-details",o),void alert(o.data.message);let c=o.data;$.each(c,function(o,c){[e].forEach(function(e){let t=$('input[name="'+e+"_"+o+'"]');if(0!==t.length&&(t.prop("readonly",!1),t.closest(".form-row").removeClass("payex-locked"),t.val(c).change(),"country"===o||"state"===o)){let t=$("#"+e+"_"+o);void 0!==window.Select2?t.select2("val",c):void 0!==$.fn.chosen?t.val(c).trigger("chosen:updated"):t.change()}})}),$(document.body).trigger("update_checkout")})},onPaymentMenuInstrumentSelected:function(e,o){console.log("onPaymentMenuInstrumentSelected",e,o)},logError:function(e,o){return console.warn(o),$.ajax({type:"POST",url:WC_Gateway_PayEx_Checkout.ajax_url,data:{action:"payex_checkout_log_error",nonce:WC_Gateway_PayEx_Checkout.nonce,id:e,data:JSON.stringify(o)},dataType:"json"})},onError:function(e){console.log("onError",e),wc_payex_checkout.submit_error('<div class="woocommerce-error">'+e+"</div>")},submit_error:function(e){$(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),wc_payex_checkout.form.prepend('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout">'+e+"</div>"),wc_payex_checkout.form.removeClass("processing").unblock(),wc_payex_checkout.form.find(".input-text, select, input:checkbox").trigger("validate").blur(),wc_payex_checkout.scroll_to_notices(),$(document.body).trigger("checkout_error")},scroll_to_notices:function(){let e=$(".woocommerce-NoticeGroup-updateOrderReview, .woocommerce-NoticeGroup-checkout");e.length||(e=$(".form.checkout")),$.scroll_to_notices(e)},hideAddressFields:function(){$(".woocommerce-billing-fields__field-wrapper, .woocommerce-shipping-fields").hide()},showAddressFields:function(){$(".woocommerce-billing-fields__field-wrapper, .woocommerce-shipping-fields").show()}},$(document).ready(function(){wc_payex_checkout.init($("form.checkout, form#order_review, form#add_payment_method"))})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNoZWNrb3V0LmpzIl0sIm5hbWVzIjpbImpRdWVyeSIsIiQiLCJ3aW5kb3ciLCJ3Y19wYXlleF9jaGVja291dCIsImpzX3VybCIsInBheW1lbnRNZW51IiwiaXNQYXltZW50TWVudUxvYWRlZCIsInhociIsImluaXQiLCJmb3JtIiwidGhpcyIsImZvcm1fc3VibWl0Iiwib24iLCJvblN1Ym1pdCIsImRvY3VtZW50IiwiYm9keSIsImJpbmQiLCJvblVwZGF0ZUNoZWNrb3V0IiwicmVzZXRDaGVja291dCIsIm9uVXBkYXRlZENoZWNrb3V0IiwiaGlkZSIsInNob3dBZGRyZXNzRmllbGRzIiwibG9hZENoZWNrSW4iLCJ2YWwiLCJpc0luc3RhbnRDaGVja291dCIsImluaXRJbnN0YW50Q2hlY2tvdXQiLCJjb25zb2xlIiwibG9nIiwiaXNDaGVja2luRW5hYmxlZCIsImhpZGVBZGRyZXNzRmllbGRzIiwiY29uc3VtZXJQcm9maWxlRWxtIiwibGVuZ3RoIiwicmVmZXJlbmNlIiwiZGF0YSIsImluaXRDaGVja0luIiwiY291bnRyeSIsImFqYXgiLCJ0eXBlIiwidXJsIiwiV0NfR2F0ZXdheV9QYXlFeF9DaGVja291dCIsImFqYXhfdXJsIiwiYWN0aW9uIiwibm9uY2UiLCJkYXRhVHlwZSIsImRvbmUiLCJzdWNjZXNzIiwibG9nRXJyb3IiLCJhbGVydCIsImRldGFpbHMiLCJoYXNPd25Qcm9wZXJ0eSIsInBheWV4IiwiaG9zdGVkVmlldyIsImNvbnN1bWVyIiwiY2xvc2UiLCJyZW1vdmUiLCJsb2FkSnMiLCJ3YWl0Rm9yTG9hZGluZyIsImVyciIsIndhcm4iLCJjb250YWluZXIiLCJjdWx0dXJlIiwic3R5bGUiLCJjaGVja0luU3R5bGUiLCJKU09OIiwicGFyc2UiLCJvbkNvbnN1bWVySWRlbnRpZmllZCIsIm9uTmV3Q29uc3VtZXIiLCJvbkNvbnN1bWVyUmVtb3ZlZCIsIm9uQmlsbGluZ0RldGFpbHNBdmFpbGFibGUiLCJvbkFkZHJlc3NEZXRhaWxzQXZhaWxhYmxlIiwib25TaGlwcGluZ0RldGFpbHNBdmFpbGFibGUiLCJuZWVkc19zaGlwcGluZ19hZGRyZXNzIiwic2hpcF90b19iaWxsaW5nX2FkZHJlc3Nfb25seSIsIm9uRXJyb3IiLCJvcGVuIiwiaW5pdENoZWNrb3V0Iiwic2hvdyIsImZpbmQiLCJhcHBlbmQiLCJpbnN0YW50X2NoZWNrb3V0IiwiY2hlY2tpbiIsImlzUGF5bWVudE1ldGhvZENob3NlbiIsImlzIiwiYmxvY2siLCJtZXNzYWdlIiwib3ZlcmxheUNTUyIsImJhY2tncm91bmQiLCJvcGFjaXR5IiwidW5ibG9jayIsIm9uQ2xvc2UiLCJvblJlYWR5IiwidmFsaWRhdGVGb3JtIiwiYWJvcnQiLCJhZGRDbGFzcyIsInVwZGF0ZU9yZGVyIiwiYWx3YXlzIiwicmVzcG9uc2UiLCJyZW1vdmVDbGFzcyIsImZhaWwiLCJqcVhIUiIsInRleHRTdGF0dXMiLCJyZXN1bHQiLCJyZWxvYWQiLCJsb2NhdGlvbiIsInJlZnJlc2giLCJ0cmlnZ2VyIiwibWVzc2FnZXMiLCJyZWZyZXNoUGF5bWVudE1lbnUiLCJlIiwicHJldmVudERlZmF1bHQiLCJwbGFjZU9yZGVyIiwiaW5pdFBheW1lbnRKUyIsIiRyZXF1aXJlZF9pbnB1dHMiLCJ2YWxpZGF0ZWQiLCJub3QiLCJlYWNoIiwiJHRoaXMiLCIkcGFyZW50IiwiY2xvc2VzdCIsInZhbGlkYXRlX3JlcXVpcmVkIiwidmFsaWRhdGVfZW1haWwiLCJhdHRyIiwiUmVnRXhwIiwidGVzdCIsInZhcl9zdHJpbmciLCJjYWxsYmFjayIsIm9iaiIsImV2YWwiLCJhdHRlbXB0cyIsInRpbWVyIiwic2V0SW50ZXJ2YWwiLCJjbGVhckludGVydmFsIiwianMiLCJzY3JpcHQiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9IZWFkIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJhcHBlbmRDaGlsZCIsImluaXRQYXltZW50TWVudSIsImZlYXRoZXJsaWdodCIsInZhcmlhbnQiLCJwZXJzaXN0IiwiY2xvc2VPbkNsaWNrIiwiY2xvc2VPbkVzYyIsImFmdGVyT3BlbiIsImFmdGVyQ2xvc2UiLCJpZCIsInBheW1lbnRNZW51U3R5bGUiLCJvbkFwcGxpY2F0aW9uQ29uZmlndXJlZCIsIm9uUGF5bWVudE1lbnVJbnN0cnVtZW50U2VsZWN0ZWQiLCJuYW1lIiwiaW5zdHJ1bWVudCIsIm9uUGF5bWVudENyZWF0ZWQiLCJvblBheW1lbnRDb21wbGV0ZWQiLCJzZWxmIiwiaHJlZiIsInJlZGlyZWN0VXJsIiwib25QYXltZW50Q2FuY2VsZWQiLCJvblBheW1lbnRGYWlsZWQiLCJmaWVsZHMiLCJzZXJpYWxpemUiLCJpbmRleE9mIiwiY29uc3VtZXJQcm9maWxlUmVmIiwia2V5IiwidmFsdWUiLCJmb3JFYWNoIiwic2VjdGlvbiIsImVsIiwicHJvcCIsImNoYW5nZSIsImVsMSIsIlNlbGVjdDIiLCJzZWxlY3QyIiwiZm4iLCJjaG9zZW4iLCJzdHJpbmdpZnkiLCJzdWJtaXRfZXJyb3IiLCJlcnJvcl9tZXNzYWdlIiwicHJlcGVuZCIsImJsdXIiLCJzY3JvbGxfdG9fbm90aWNlcyIsInNjcm9sbEVsZW1lbnQiLCJyZWFkeSJdLCJtYXBwaW5ncyI6IkFBQ0FBLE9BQVEsU0FBVUMsR0FDZCxhQUtBQyxPQUFPQyxrQkFBb0IsQ0FDdkJDLE9BQVEsS0FDUkMsWUFBYSxLQUNiQyxxQkFBcUIsRUFDckJDLEtBQUssRUFLTEMsS0FBTSxTQUFVQyxHQUNaQyxLQUFLRCxLQUFlQSxFQUNwQkMsS0FBS0MsYUFBZSxFQUVwQlYsRUFBR1MsS0FBS0QsTUFHSEcsR0FBSSxRQUFTLGVBQWdCRixLQUFLRyxVQUdsQ0QsR0FBSSw4Q0FFVFgsRUFBR2EsU0FBU0MsTUFBT0MsS0FBTSxrQkFBbUJOLEtBQUtPLGtCQUNqRGhCLEVBQUdhLFNBQVNDLE1BQU9ILEdBQUksaUJBQWtCRixLQUFLUSxlQUM5Q2pCLEVBQUdhLFNBQVNDLE1BQU9ILEdBQUksbUJBQW9CRixLQUFLUyxtQkFDaERsQixFQUFHYSxTQUFTQyxNQUFPSCxHQUFJ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QyxHQUNoQlAsUUFBUUMsSUFBSyxVQUFXTSxHQUN4QjlCLGtCQUFrQitLLGFBQWMsa0NBQW9DakosRUFBTyxXQUUvRWlKLGFBQWMsU0FBVUMsR0FDcEJsTCxFQUFHLCtFQUFnRnFELFNBQ25GbkQsa0JBQWtCTSxLQUFLMkssUUFBUyx5RUFBMkVELEVBQWdCLFVBQzNIaEwsa0JBQWtCTSxLQUFLd0YsWUFBYSxjQUFlVCxVQUNuRHJGLGtCQUFrQk0sS0FBS29FLEtBQU0sdUNBQXdDNEIsUUFBUyxZQUFhNEUsT0FDM0ZsTCxrQkFBa0JtTCxvQkFDbEJyTCxFQUFHYSxTQUFTQyxNQUFPMEYsUUFBUyxtQkFFaEM2RSxrQkFBbUIsV0FDZixJQUFJQyxFQUFnQnRMLEVBQUcsaUZBQ2hCc0wsRUFBY3hKLFNBQ2pCd0osRUFBZ0J0TCxFQUFHLG1CQUd2QkEsRUFBRXFMLGtCQUFtQkMsSUFFekIxSixrQkFBbUIsV0FDZjVCLEVBQUcsNEVBQTZFbUIsUUFFcEZDLGtCQUFtQixXQUNmcEIsRUFBRyw0RUFBNkUyRSxTQUl4RjNFLEVBQUVhLFVBQVUwSyxNQUFPLFdBQ2ZyTCxrQkFBa0JLLEtBQU1QLEVBQUciLCJmaWxlIjoiY2hlY2tvdXQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZ2xvYmFsIHdjX2NoZWNrb3V0X3BhcmFtcyAqL1xualF1ZXJ5KCBmdW5jdGlvbiggJCApIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICAvKipcbiAgICAgKiBPYmplY3QgdG8gaGFuZGxlIFBheUV4IGNoZWNrb3V0IHBheW1lbnQgZm9ybXMuXG4gICAgICovXG4gICAgd2luZG93LndjX3BheWV4X2NoZWNrb3V0ID0ge1xuICAgICAgICBqc191cmw6IG51bGwsXG4gICAgICAgIHBheW1lbnRNZW51OiBudWxsLFxuICAgICAgICBpc1BheW1lbnRNZW51TG9hZGVkOiBmYWxzZSxcbiAgICAgICAgeGhyOiBmYWxzZSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogSW5pdGlhbGl6ZSBlIGhhbmRsZXJzIGFuZCBVSSBzdGF0ZS5cbiAgICAgICAgICovXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCBmb3JtICkge1xuICAgICAgICAgICAgdGhpcy5mb3JtICAgICAgICAgPSBmb3JtO1xuICAgICAgICAgICAgdGhpcy5mb3JtX3N1Ym1pdCAgPSBmYWxzZTtcblxuICAgICAgICAgICAgJCggdGhpcy5mb3JtIClcbiAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gYmluZCBkaXJlY3RseSB0byB0aGUgY2xpY2sgKGFuZCBub3QgY2hlY2tvdXRfcGxhY2Vfb3JkZXJfcGF5ZXhfY2hlY2tvdXQpIHRvIGF2b2lkIHBvcHVwIGJsb2NrZXJzXG4gICAgICAgICAgICAvLyBlc3BlY2lhbGx5IG9uIG1vYmlsZSBkZXZpY2VzIChsaWtlIG9uIENocm9tZSBmb3IgaU9TKSBmcm9tIGJsb2NraW5nIHBheWV4X2NoZWNrb3V0KHBheW1lbnRfaWQsIHt9LCAnb3BlbicpOyBmcm9tIG9wZW5pbmcgYSB0YWJcbiAgICAgICAgICAgICAgICAub24oICdjbGljaycsICcjcGxhY2Vfb3JkZXInLCB0aGlzLm9uU3VibWl0IClcblxuICAgICAgICAgICAgICAgIC8vIFdvb0NvbW1lcmNlIGxldHMgdXMgcmV0dXJuIGEgZmFsc2Ugb24gY2hlY2tvdXRfcGxhY2Vfb3JkZXJfe2dhdGV3YXl9IHRvIGtlZXAgdGhlIGZvcm0gZnJvbSBzdWJtaXR0aW5nXG4gICAgICAgICAgICAgICAgLm9uKCAnc3VibWl0IGNoZWNrb3V0X3BsYWNlX29yZGVyX3BheWV4X2NoZWNrb3V0JyApO1xuXG4gICAgICAgICAgICAkKCBkb2N1bWVudC5ib2R5ICkuYmluZCggJ3VwZGF0ZV9jaGVja291dCcsIHRoaXMub25VcGRhdGVDaGVja291dCApO1xuICAgICAgICAgICAgJCggZG9jdW1lbnQuYm9keSApLm9uKCAnY2hlY2tvdXRfZXJyb3InLCB0aGlzLnJlc2V0Q2hlY2tvdXQgKTtcbiAgICAgICAgICAgICQoIGRvY3VtZW50LmJvZHkgKS5vbiggJ3VwZGF0ZWRfY2hlY2tvdXQnLCB0aGlzLm9uVXBkYXRlZENoZWNrb3V0ICk7XG4gICAgICAgICAgICAkKCBkb2N1bWVudC5ib2R5ICkub24oICdibHVyJywgdGhpcy5vblVwZGF0ZWRDaGVja291dCApO1xuXG4gICAgICAgICAgICAkKCBkb2N1bWVudC5ib2R5ICkub24oICdjbGljaycsICcjY2hhbmdlLXNoaXBwaW5nLWluZm8nLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gSGlkZSBcIkNoYW5nZSBzaGlwcGluZyBpbmZvXCIgYnV0dG9uXG4gICAgICAgICAgICAgICAgJCggJyNjaGFuZ2Utc2hpcHBpbmctaW5mbycgKS5oaWRlKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBTaG93IEFkZHJlc3MgRmllbGRzXG4gICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuc2hvd0FkZHJlc3NGaWVsZHMoKTtcbiAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgJCggZG9jdW1lbnQuYm9keSApLm9uKCAnY2hhbmdlJywgJyNjaGVja2luX2NvdW50cnknLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQubG9hZENoZWNrSW4oICQodGhpcykudmFsKCkgKTtcbiAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSBJbnN0YW50IENoZWNrb3V0XG4gICAgICAgICAgICBpZiAoIHdjX3BheWV4X2NoZWNrb3V0LmlzSW5zdGFudENoZWNrb3V0KCkgKSB7XG4gICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuaW5pdEluc3RhbnRDaGVja291dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbml0aWFsaXplIEluc3RhbnQgQ2hlY2tvdXRcbiAgICAgICAgICovXG4gICAgICAgIGluaXRJbnN0YW50Q2hlY2tvdXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnSW5pdGlhbGl6YXRpb24gb2YgSW5zdGFudCBDaGVja291dC4uLicgKTtcblxuICAgICAgICAgICAgaWYgKCB3Y19wYXlleF9jaGVja291dC5pc0NoZWNraW5FbmFibGVkKCkgKSB7XG4gICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuaGlkZUFkZHJlc3NGaWVsZHMoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVXNlIHNhdmVkIGNvbnN1bWVyUHJvZmlsZVJlZlxuICAgICAgICAgICAgbGV0IGNvbnN1bWVyUHJvZmlsZUVsbSA9ICQoICcjcGF5ZXgtY29uc3VtZXItcHJvZmlsZScgKTtcbiAgICAgICAgICAgIGlmICggY29uc3VtZXJQcm9maWxlRWxtLmxlbmd0aCA+IDAgKSB7XG4gICAgICAgICAgICAgICAgbGV0IHJlZmVyZW5jZSA9IGNvbnN1bWVyUHJvZmlsZUVsbS5kYXRhKCAncmVmZXJlbmNlJyApO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnSW5pdGlhdGUgY29uc3VtZXJQcm9maWxlUmVmJywgcmVmZXJlbmNlICk7XG4gICAgICAgICAgICAgICAgLy93Y19wYXlleF9jaGVja291dC5pbml0Q2hlY2tvdXQoIHJlZmVyZW5jZSApO1xuICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmluaXRDaGVja0luKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEluaXRpYXRlIGNoZWNraW5cblxuICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmluaXRDaGVja0luKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIExvYWQgQ2hlY2tJblxuICAgICAgICAgKiBAcGFyYW0gY291bnRyeVxuICAgICAgICAgKiBAcmV0dXJucyB7Kn1cbiAgICAgICAgICovXG4gICAgICAgIGxvYWRDaGVja0luOiBmdW5jdGlvbiggY291bnRyeSApIHtcbiAgICAgICAgICAgIHJldHVybiAkLmFqYXgoIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgdXJsOiBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0LmFqYXhfdXJsLFxuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAnc2JfY2hlY2tpbicsXG4gICAgICAgICAgICAgICAgICAgIG5vbmNlOiBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0Lm5vbmNlLFxuICAgICAgICAgICAgICAgICAgICBjb3VudHJ5OiBjb3VudHJ5XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXG4gICAgICAgICAgICB9ICkuZG9uZSggZnVuY3Rpb24gKCBkYXRhICkge1xuICAgICAgICAgICAgICAgIGlmICggISBkYXRhLnN1Y2Nlc3MgKSB7XG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmxvZ0Vycm9yKCAncGF5ZXgtY2hlY2tpbi1sb2FkZXInLCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KCBkYXRhLmRldGFpbHMgKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIERlc3Ryb3lcbiAgICAgICAgICAgICAgICBpZiAoIHdpbmRvdy5oYXNPd25Qcm9wZXJ0eSggJ3BheWV4JyApICYmIHdpbmRvdy5wYXlleC5oYXNPd25Qcm9wZXJ0eSggJ2hvc3RlZFZpZXcnICkgKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICggdHlwZW9mIHdpbmRvdy5wYXlleC5ob3N0ZWRWaWV3LmNvbnN1bWVyICE9PSAndW5kZWZpbmVkJyApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5wYXlleC5ob3N0ZWRWaWV3LmNvbnN1bWVyKCkuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIERlc3Ryb3kgSlNcbiAgICAgICAgICAgICAgICAkKCBcInNjcmlwdFtzcmMqPSdweC5jb25zdW1lci5jbGllbnQnXVwiICkucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgJCggJyNwYXlleC1jaGVja2luIGlmcmFtZScgKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5sb2FkSnMoIGRhdGEuZGF0YSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5pbml0Q2hlY2tJbigpO1xuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgIH0gKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogSW5pdGlhbGl6ZSBDaGVja0luXG4gICAgICAgICAqL1xuICAgICAgICBpbml0Q2hlY2tJbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoIHR5cGVvZiBwYXlleCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LndhaXRGb3JMb2FkaW5nKCdwYXlleC5ob3N0ZWRWaWV3LmNvbnN1bWVyJywgZnVuY3Rpb24gKCBlcnIgKSB7XG4gICAgICAgICAgICAgICAgaWYgKCBlcnIgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybiggZXJyICk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBJbml0IFBheUV4IGhvc3RlZFZpZXdcbiAgICAgICAgICAgICAgICB3aW5kb3cucGF5ZXguaG9zdGVkVmlldy5jb25zdW1lcigge1xuICAgICAgICAgICAgICAgICAgICBjb250YWluZXI6ICdwYXlleC1jaGVja2luJyxcbiAgICAgICAgICAgICAgICAgICAgY3VsdHVyZTogV0NfR2F0ZXdheV9QYXlFeF9DaGVja291dC5jdWx0dXJlLFxuICAgICAgICAgICAgICAgICAgICBzdHlsZTogV0NfR2F0ZXdheV9QYXlFeF9DaGVja291dC5jaGVja0luU3R5bGUgPyBKU09OLnBhcnNlKCBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0LmNoZWNrSW5TdHlsZSApIDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgb25Db25zdW1lcklkZW50aWZpZWQ6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coICdob3N0ZWRWaWV3OiBvbkNvbnN1bWVySWRlbnRpZmllZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0Lm9uQ29uc3VtZXJJZGVudGlmaWVkKCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG9uTmV3Q29uc3VtZXI6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coICdob3N0ZWRWaWV3OiBvbk5ld0NvbnN1bWVyJyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQub25Db25zdW1lcklkZW50aWZpZWQoIGRhdGEgKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgb25Db25zdW1lclJlbW92ZWQ6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coICdob3N0ZWRWaWV3OiBvbkNvbnN1bWVyUmVtb3ZlZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgb25CaWxsaW5nRGV0YWlsc0F2YWlsYWJsZTogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5vbkFkZHJlc3NEZXRhaWxzQXZhaWxhYmxlKCAnYmlsbGluZycsIGRhdGEgKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgb25TaGlwcGluZ0RldGFpbHNBdmFpbGFibGU6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0Lm5lZWRzX3NoaXBwaW5nX2FkZHJlc3MgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0LnNoaXBfdG9fYmlsbGluZ19hZGRyZXNzX29ubHlcbiAgICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0Lm9uQWRkcmVzc0RldGFpbHNBdmFpbGFibGUoICdiaWxsaW5nJywgZGF0YSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5vbkFkZHJlc3NEZXRhaWxzQXZhaWxhYmxlKCAnc2hpcHBpbmcnLCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uICggZGF0YSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmxvZ0Vycm9yKCAncGF5ZXgtY2hlY2tpbicsIGRhdGEgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCBkYXRhLmRldGFpbHMgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0Lm9uRXJyb3IoIGRhdGEuZGV0YWlscyApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApLm9wZW4oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIGluaXRDaGVja291dDogZnVuY3Rpb24oIHJlZmVyZW5jZSApIHtcbiAgICAgICAgICAgIC8vIFNob3cgXCJDaGFuZ2Ugc2hpcHBpbmcgaW5mb1wiIGJ1dHRvblxuICAgICAgICAgICAgJCggJyNjaGFuZ2Utc2hpcHBpbmctaW5mbycgKS5zaG93KCk7XG5cbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmZvcm0uZmluZCggJy5wYXlleF9jdXN0b21lcl9yZWZlcmVuY2UnICkucmVtb3ZlKCk7XG4gICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5mb3JtLmFwcGVuZCggXCI8aW5wdXQgdHlwZT0naGlkZGVuJyBjbGFzcz0ncGF5ZXhfY3VzdG9tZXJfcmVmZXJlbmNlJyBuYW1lPSdwYXlleF9jdXN0b21lcl9yZWZlcmVuY2UnIHZhbHVlPSdcIiArIHJlZmVyZW5jZSArIFwiJy8+XCIgKTtcblxuICAgICAgICAgICAgLy93Y19wYXlleF9jaGVja291dC5mb3JtLnN1Ym1pdCgpO1xuICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQub25TdWJtaXQoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBpc0luc3RhbnRDaGVja291dCgpIHtcbiAgICAgICAgICAgIHJldHVybiBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0Lmluc3RhbnRfY2hlY2tvdXQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaXNDaGVja2luRW5hYmxlZCgpIHtcbiAgICAgICAgICAgIHJldHVybiBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0LmNoZWNraW47XG4gICAgICAgIH0sXG5cbiAgICAgICAgaXNQYXltZW50TWV0aG9kQ2hvc2VuOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAkKCAnI3BheW1lbnRfbWV0aG9kX3BheWV4X2NoZWNrb3V0JyApLmlzKCAnOmNoZWNrZWQnICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYmxvY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgbGV0IGZvcm1fZGF0YSA9IHdjX3BheWV4X2NoZWNrb3V0LmZvcm0uZGF0YSgpO1xuICAgICAgICAgICAgaWYgKCAxICE9PSBmb3JtX2RhdGFbJ2Jsb2NrVUkuaXNCbG9ja2VkJ10gKSB7XG4gICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuZm9ybS5ibG9jayh7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIG92ZXJsYXlDU1M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICcjZmZmJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDAuNlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgdW5ibG9jazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5mb3JtLnVuYmxvY2soKTtcbiAgICAgICAgfSxcblxuICAgICAgICBvbkNsb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LnVuYmxvY2soKTtcbiAgICAgICAgfSxcblxuICAgICAgICBvblJlYWR5OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnUmVhZHknICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgb25VcGRhdGVDaGVja291dDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uVXBkYXRlQ2hlY2tvdXQnICk7XG5cbiAgICAgICAgICAgIGlmICggISB3Y19wYXlleF9jaGVja291dC5pc0luc3RhbnRDaGVja291dCgpICkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQHRvZG9cbiAgICAgICAgfSxcblxuICAgICAgICBvblVwZGF0ZWRDaGVja291dDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uVXBkYXRlZENoZWNrb3V0JyApO1xuXG4gICAgICAgICAgICBpZiAoICEgd2NfcGF5ZXhfY2hlY2tvdXQuaXNJbnN0YW50Q2hlY2tvdXQoKSApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICggd2NfcGF5ZXhfY2hlY2tvdXQuZm9ybS5pcyggJy5wcm9jZXNzaW5nJyApICkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCAhIHdjX3BheWV4X2NoZWNrb3V0LnZhbGlkYXRlRm9ybSgpICkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25VcGRhdGVkQ2hlY2tvdXQ6IFZhbGlkYXRpb24gaXMgZmFpbGVkJyApO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCB3Y19wYXlleF9jaGVja291dC54aHIgKSB7XG4gICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQueGhyLmFib3J0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICQoICcud29vY29tbWVyY2UtTm90aWNlR3JvdXAtY2hlY2tvdXQsIC53b29jb21tZXJjZS1lcnJvciwgLndvb2NvbW1lcmNlLW1lc3NhZ2UnICkucmVtb3ZlKCk7XG4gICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5mb3JtLmFkZENsYXNzKCAncHJvY2Vzc2luZycgKTtcbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmJsb2NrKCk7XG5cbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LnhociA9IHdjX3BheWV4X2NoZWNrb3V0LnVwZGF0ZU9yZGVyKClcbiAgICAgICAgICAgICAgICAuYWx3YXlzKCBmdW5jdGlvbiAoIHJlc3BvbnNlICkge1xuICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5mb3JtLnJlbW92ZUNsYXNzKCAncHJvY2Vzc2luZycgKTtcbiAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQudW5ibG9jaygpO1xuICAgICAgICAgICAgICAgIH0gKVxuICAgICAgICAgICAgICAgIC5mYWlsKCBmdW5jdGlvbigganFYSFIsIHRleHRTdGF0dXMgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAndXBkYXRlT3JkZXIgZXJyb3I6JyArIHRleHRTdGF0dXMgKTtcbiAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQub25FcnJvciggdGV4dFN0YXR1cyApO1xuICAgICAgICAgICAgICAgIH0gKVxuICAgICAgICAgICAgICAgIC5kb25lKCBmdW5jdGlvbiAoIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCByZXNwb25zZSApO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnhociA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5yZXN1bHQgIT09ICdzdWNjZXNzJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVsb2FkIHBhZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggcmVzcG9uc2UuaGFzT3duUHJvcGVydHkoJ3JlbG9hZCcpICYmIHRydWUgPT09IHJlc3BvbnNlLnJlbG9hZCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUcmlnZ2VyIHVwZGF0ZSBpbiBjYXNlIHdlIG5lZWQgYSBmcmVzaCBub25jZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0cnVlID09PSByZXNwb25zZS5yZXN1bHQucmVmcmVzaCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCBkb2N1bWVudC5ib2R5ICkudHJpZ2dlciggJ3VwZGF0ZV9jaGVja291dCcgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQub25FcnJvciggcmVzcG9uc2UubWVzc2FnZXMgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vd2NfcGF5ZXhfY2hlY2tvdXQuZm9ybS5zdWJtaXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlZnJlc2ggUGF5bWVudCBNZW51XG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmpzX3VybCA9IHJlc3BvbnNlWydqc191cmwnXTtcbiAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQucmVmcmVzaFBheW1lbnRNZW51KCk7XG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICB9LFxuXG4gICAgICAgIG9uU3VibWl0OiBmdW5jdGlvbiggZSApIHtcbiAgICAgICAgICAgIGlmICggd2NfcGF5ZXhfY2hlY2tvdXQuZm9ybV9zdWJtaXQgKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICggd2NfcGF5ZXhfY2hlY2tvdXQuaXNQYXltZW50TWV0aG9kQ2hvc2VuKCkgKSB7XG4gICAgICAgICAgICAgICAgaWYgKCB0eXBlb2YgZSAhPT0gJ3VuZGVmaW5lZCcgKSB7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoICEgd2NfcGF5ZXhfY2hlY2tvdXQudmFsaWRhdGVGb3JtKCkgKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uU3VibWl0JyApO1xuXG4gICAgICAgICAgICAgICAgaWYgKCB3Y19wYXlleF9jaGVja291dC5mb3JtLmlzKCAnLnByb2Nlc3NpbmcnICkgKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAkKCAnLndvb2NvbW1lcmNlLU5vdGljZUdyb3VwLWNoZWNrb3V0LCAud29vY29tbWVyY2UtZXJyb3IsIC53b29jb21tZXJjZS1tZXNzYWdlJyApLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmZvcm0uYWRkQ2xhc3MoICdwcm9jZXNzaW5nJyApO1xuICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmJsb2NrKCk7XG4gICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQucGxhY2VPcmRlcigpXG4gICAgICAgICAgICAgICAgICAgIC5hbHdheXMoIGZ1bmN0aW9uICggcmVzcG9uc2UgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5mb3JtLnJlbW92ZUNsYXNzKCAncHJvY2Vzc2luZycgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LnVuYmxvY2soKTtcbiAgICAgICAgICAgICAgICAgICAgfSApXG4gICAgICAgICAgICAgICAgICAgIC5mYWlsKCBmdW5jdGlvbigganFYSFIsIHRleHRTdGF0dXMgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5vbkVycm9yKCB0ZXh0U3RhdHVzICk7XG4gICAgICAgICAgICAgICAgICAgIH0gKVxuICAgICAgICAgICAgICAgICAgICAuZG9uZSggZnVuY3Rpb24gKCByZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIHJlc3BvbnNlICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIHJlc3BvbnNlLnJlc3VsdCAhPT0gJ3N1Y2Nlc3MnICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbG9hZCBwYWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCByZXNwb25zZS5oYXNPd25Qcm9wZXJ0eSgncmVsb2FkJykgJiYgdHJ1ZSA9PT0gcmVzcG9uc2UucmVsb2FkICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUcmlnZ2VyIHVwZGF0ZSBpbiBjYXNlIHdlIG5lZWQgYSBmcmVzaCBub25jZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggdHJ1ZSA9PT0gcmVzcG9uc2UucmVzdWx0LnJlZnJlc2ggKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIGRvY3VtZW50LmJvZHkgKS50cmlnZ2VyKCAndXBkYXRlX2NoZWNrb3V0JyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0Lm9uRXJyb3IoIHJlc3BvbnNlLm1lc3NhZ2VzICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBMb2FkIFBheUV4IENoZWNrb3V0IGZyYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5qc191cmwgPSByZXNwb25zZVsnanNfdXJsJ107XG4gICAgICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5pbml0UGF5bWVudEpTKCB3Y19wYXlleF9jaGVja291dC5qc191cmwgKTtcbiAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSxcblxuICAgICAgICByZXNldENoZWNrb3V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmZvcm1fc3VibWl0ID0gZmFsc2U7XG4gICAgICAgIH0sXG5cbiAgICAgICAgdmFsaWRhdGVGb3JtOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgJHJlcXVpcmVkX2lucHV0cyxcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZWQgPSB0cnVlO1xuXG4gICAgICAgICAgICAvLyBjaGVjayB0byBzZWUgaWYgd2UgbmVlZCB0byB2YWxpZGF0ZSBzaGlwcGluZyBhZGRyZXNzXG4gICAgICAgICAgICBpZiAoICQoICcjc2hpcC10by1kaWZmZXJlbnQtYWRkcmVzcy1jaGVja2JveCcgKS5pcyggJzpjaGVja2VkJyApICkge1xuICAgICAgICAgICAgICAgICRyZXF1aXJlZF9pbnB1dHMgPSAkKCAnLndvb2NvbW1lcmNlLWJpbGxpbmctZmllbGRzIC52YWxpZGF0ZS1yZXF1aXJlZCwgLndvb2NvbW1lcmNlLXNoaXBwaW5nLWZpZWxkcyAudmFsaWRhdGUtcmVxdWlyZWQnICkuZmluZCgnaW5wdXQsIHNlbGVjdCcpLm5vdCggJCggJyNhY2NvdW50X3Bhc3N3b3JkLCAjYWNjb3VudF91c2VybmFtZScgKSApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkcmVxdWlyZWRfaW5wdXRzID0gJCggJy53b29jb21tZXJjZS1iaWxsaW5nLWZpZWxkcyAudmFsaWRhdGUtcmVxdWlyZWQnICkuZmluZCgnaW5wdXQsIHNlbGVjdCcpLm5vdCggJCggJyNhY2NvdW50X3Bhc3N3b3JkLCAjYWNjb3VudF91c2VybmFtZScgKSApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoICRyZXF1aXJlZF9pbnB1dHMubGVuZ3RoICkge1xuICAgICAgICAgICAgICAgICRyZXF1aXJlZF9pbnB1dHMuZWFjaCggZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciAkdGhpcyA9ICQoIHRoaXMgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICRwYXJlbnQgICAgICAgICAgID0gJHRoaXMuY2xvc2VzdCggJy5mb3JtLXJvdycgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkYXRlX3JlcXVpcmVkID0gJHBhcmVudC5pcyggJy52YWxpZGF0ZS1yZXF1aXJlZCcgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkYXRlX2VtYWlsICAgID0gJHBhcmVudC5pcyggJy52YWxpZGF0ZS1lbWFpbCcgKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIHZhbGlkYXRlX3JlcXVpcmVkICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAnY2hlY2tib3gnID09PSAkdGhpcy5hdHRyKCAndHlwZScgKSAmJiAhICR0aGlzLmlzKCAnOmNoZWNrZWQnICkgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCAkdGhpcy52YWwoKSA9PT0gJycgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoIHZhbGlkYXRlX2VtYWlsICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAkdGhpcy52YWwoKSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8yODU1ODY1L2pxdWVyeS12YWxpZGF0ZS1lLW1haWwtYWRkcmVzcy1yZWdleCAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXR0ZXJuID0gbmV3IFJlZ0V4cCgvXigoKFthLXpdfFxcZHxbISNcXCQlJidcXCpcXCtcXC1cXC89XFw/XFxeX2B7XFx8fX5dfFtcXHUwMEEwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdKSsoXFwuKFthLXpdfFxcZHxbISNcXCQlJidcXCpcXCtcXC1cXC89XFw/XFxeX2B7XFx8fX5dfFtcXHUwMEEwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdKSspKil8KChcXHgyMikoKCgoXFx4MjB8XFx4MDkpKihcXHgwZFxceDBhKSk/KFxceDIwfFxceDA5KSspPygoW1xceDAxLVxceDA4XFx4MGJcXHgwY1xceDBlLVxceDFmXFx4N2ZdfFxceDIxfFtcXHgyMy1cXHg1Yl18W1xceDVkLVxceDdlXXxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSl8KFxcXFwoW1xceDAxLVxceDA5XFx4MGJcXHgwY1xceDBkLVxceDdmXXxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSkpKSkqKCgoXFx4MjB8XFx4MDkpKihcXHgwZFxceDBhKSk/KFxceDIwfFxceDA5KSspPyhcXHgyMikpKUAoKChbYS16XXxcXGR8W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pfCgoW2Etel18XFxkfFtcXHUwMEEwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdKShbYS16XXxcXGR8LXxcXC58X3x+fFtcXHUwMEEwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdKSooW2Etel18XFxkfFtcXHUwMEEwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdKSkpXFwuKSsoKFthLXpdfFtcXHUwMEEwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdKXwoKFthLXpdfFtcXHUwMEEwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdKShbYS16XXxcXGR8LXxcXC58X3x+fFtcXHUwMEEwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdKSooW2Etel18W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKSlcXC4/JC9pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoICEgcGF0dGVybi50ZXN0KCAkdGhpcy52YWwoKSAgKSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB2YWxpZGF0ZWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgd2FpdEZvckxvYWRpbmc6IGZ1bmN0aW9uICggdmFyX3N0cmluZywgY2FsbGJhY2sgKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciBvYmogPSBldmFsKCB2YXJfc3RyaW5nICk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soIGUgKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBhdHRlbXB0cyA9IDA7XG4gICAgICAgICAgICBsZXQgdGltZXIgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmICggdHlwZW9mIG9iaiAhPT0gJ3VuZGVmaW5lZCcgKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKCB0aW1lciApO1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayggbnVsbCwgb2JqICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYXR0ZW1wdHMrKztcbiAgICAgICAgICAgICAgICAgICAgaWYgKCBhdHRlbXB0cyA+PSAxMjAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCggdGltZXIgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCAnVGltZW91dCcgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDUwMCApO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBMb2FkIEpTXG4gICAgICAgICAqIEBwYXJhbSBqc1xuICAgICAgICAgKiBAcGFyYW0gY2FsbGJhY2tcbiAgICAgICAgICovXG4gICAgICAgIGxvYWRKczogZnVuY3Rpb24gKCBqcywgY2FsbGJhY2sgKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ0xvYWRpbmcgb2YgJyArIGpzICk7XG4gICAgICAgICAgICAvLyBDcmVhdGVzIGEgbmV3IHNjcmlwdCB0YWdcbiAgICAgICAgICAgIGxldCBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnc2NyaXB0JyApO1xuXG4gICAgICAgICAgICAvLyBTZXQgc2NyaXB0IHRhZyBwYXJhbXNcbiAgICAgICAgICAgIHNjcmlwdC5zZXRBdHRyaWJ1dGUoICdzcmMnLCBqcyApO1xuICAgICAgICAgICAgc2NyaXB0LnNldEF0dHJpYnV0ZSggJ3R5cGUnLCAndGV4dC9qYXZhc2NyaXB0JyApO1xuICAgICAgICAgICAgc2NyaXB0LnNldEF0dHJpYnV0ZSggJ2FzeW5jJywgJycgKTtcbiAgICAgICAgICAgIHNjcmlwdC5hZGRFdmVudExpc3RlbmVyKCAnbG9hZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ0xvYWRlZDogJyArIGpzICk7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIH0sIGZhbHNlICk7XG5cbiAgICAgICAgICAgIC8vIEdldHMgZG9jdW1lbnQgaGVhZCBlbGVtZW50XG4gICAgICAgICAgICBsZXQgb0hlYWQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSggJ2hlYWQnIClbMF07XG4gICAgICAgICAgICBpZiAoIG9IZWFkICkge1xuICAgICAgICAgICAgICAgIC8vIEFkZCBzY3JpcHQgdGFnIHRvIGhlYWRcbiAgICAgICAgICAgICAgICBvSGVhZC5hcHBlbmRDaGlsZCggc2NyaXB0ICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBzY3JpcHQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluaXRpYXRlIFBheW1lbnQgSmF2YXNjcmlwdFxuICAgICAgICAgKiBAcGFyYW0gdXJsXG4gICAgICAgICAqIEBwYXJhbSBjYWxsYmFja1xuICAgICAgICAgKi9cbiAgICAgICAgaW5pdFBheW1lbnRKUzogZnVuY3Rpb24gKCB1cmwsIGNhbGxiYWNrICkge1xuICAgICAgICAgICAgaWYgKCB0eXBlb2YgY2FsbGJhY2sgPT09ICd1bmRlZmluZWQnICkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrID0gZnVuY3Rpb24gKCkge307XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIERlc3Ryb3lcbiAgICAgICAgICAgIGlmICggd2luZG93Lmhhc093blByb3BlcnR5KCAncGF5ZXgnICkgJiYgd2luZG93LnBheWV4Lmhhc093blByb3BlcnR5KCAnaG9zdGVkVmlldycgKSApIHtcbiAgICAgICAgICAgICAgICBpZiAoIHR5cGVvZiB3aW5kb3cucGF5ZXguaG9zdGVkVmlldy5wYXltZW50TWVudSAhPT0gJ3VuZGVmaW5lZCcgKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5wYXlleC5ob3N0ZWRWaWV3LnBheW1lbnRNZW51KCkuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAkKCAnI3BheW1lbnQtcGF5ZXgtY2hlY2tvdXQgaWZyYW1lJyApLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIC8vZGVsZXRlIHdpbmRvdy5wYXlleC5ob3N0ZWRWaWV3O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBEZXN0cm95IEpTXG4gICAgICAgICAgICAkKCBcInNjcmlwdFtzcmMqPSdweC5wYXltZW50bWVudS5jbGllbnQnXVwiICkucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgIC8vIExvYWQgSlNcbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmxvYWRKcyggdXJsLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJCggJyNwYXltZW50LXBheWV4LWNoZWNrb3V0IGlmcmFtZScgKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgICAgIC8vIExvYWQgUGF5RXggQ2hlY2tvdXQgZnJhbWVcbiAgICAgICAgICAgICAgICBpZiAoIHdjX3BheWV4X2NoZWNrb3V0LmlzSW5zdGFudENoZWNrb3V0KCkgKSB7XG4gICAgICAgICAgICAgICAgICAgICQoJyNwYXltZW50JykuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5pbml0UGF5bWVudE1lbnUoJ3BheW1lbnQtcGF5ZXgtY2hlY2tvdXQnICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJC5mZWF0aGVybGlnaHQoICc8ZGl2IGlkPVwicGF5ZXgtcGF5bWVudG1lbnVcIj4mbmJzcDs8L2Rpdj4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50OiAnZmVhdGhlcmxpZ2h0LXBheWV4JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNpc3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBjbG9zZU9uQ2xpY2s6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VPbkVzYzogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBhZnRlck9wZW46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5pbml0UGF5bWVudE1lbnUoJ3BheWV4LXBheW1lbnRtZW51JyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyQ2xvc2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5mb3JtLnJlbW92ZUNsYXNzKCAncHJvY2Vzc2luZycgKS51bmJsb2NrKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpXG4gICAgICAgICAgICB9ICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluaXRpYXRlIFBheW1lbnQgTWVudS5cbiAgICAgICAgICogUGF5bWVudCBKYXZhc2NyaXB0IG11c3QgYmUgbG9hZGVkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gaWRcbiAgICAgICAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAgICAgICAqL1xuICAgICAgICBpbml0UGF5bWVudE1lbnU6IGZ1bmN0aW9uICggaWQsIGNhbGxiYWNrICkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coICdpbml0UGF5bWVudE1lbnUnICk7XG5cbiAgICAgICAgICAgIGlmICggdHlwZW9mIGNhbGxiYWNrID09PSAndW5kZWZpbmVkJyApIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayA9IGZ1bmN0aW9uICgpIHt9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBMb2FkIFBheUV4IENoZWNrb3V0IGZyYW1lXG4gICAgICAgICAgICB0aGlzLnBheW1lbnRNZW51ID0gd2luZG93LnBheWV4Lmhvc3RlZFZpZXcucGF5bWVudE1lbnUoIHtcbiAgICAgICAgICAgICAgICBjb250YWluZXI6IGlkLFxuICAgICAgICAgICAgICAgIGN1bHR1cmU6IFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQuY3VsdHVyZSxcbiAgICAgICAgICAgICAgICBzdHlsZTogV0NfR2F0ZXdheV9QYXlFeF9DaGVja291dC5wYXltZW50TWVudVN0eWxlID8gSlNPTi5wYXJzZSggV0NfR2F0ZXdheV9QYXlFeF9DaGVja291dC5wYXltZW50TWVudVN0eWxlICkgOiBudWxsLFxuICAgICAgICAgICAgICAgIG9uQXBwbGljYXRpb25Db25maWd1cmVkOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coICdvbkFwcGxpY2F0aW9uQ29uZmlndXJlZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIGRhdGEgKTtcbiAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuaXNQYXltZW50TWVudUxvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCBudWxsICk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvblBheW1lbnRNZW51SW5zdHJ1bWVudFNlbGVjdGVkOiBmdW5jdGlvbiAoIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25QYXltZW50TWVudUluc3RydW1lbnRTZWxlY3RlZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIGRhdGEgKTtcbiAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQub25QYXltZW50TWVudUluc3RydW1lbnRTZWxlY3RlZCggZGF0YS5uYW1lLCBkYXRhLmluc3RydW1lbnQgKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9uUGF5bWVudENyZWF0ZWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coICdvblBheW1lbnRDcmVhdGVkJyApO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgb25QYXltZW50Q29tcGxldGVkOiBmdW5jdGlvbiAoIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25QYXltZW50Q29tcGxldGVkJyApO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggZGF0YSApO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmxvY2F0aW9uLmhyZWYgPSBkYXRhLnJlZGlyZWN0VXJsO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgb25QYXltZW50Q2FuY2VsZWQ6IGZ1bmN0aW9uICggZGF0YSApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coICdvblBheW1lbnRDYW5jZWxlZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIGRhdGEgKTtcbiAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQubG9nRXJyb3IoICdwYXltZW50LW1lbnUtY2FuY2VsJywgZGF0YSApO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgb25QYXltZW50RmFpbGVkOiBmdW5jdGlvbiAoIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25QYXltZW50RmFpbGVkJyApO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggZGF0YSApO1xuICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5sb2dFcnJvciggJ3BheW1lbnQtbWVudS1mYWlsZWQnLCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgIC8vc2VsZi5sb2NhdGlvbi5ocmVmID0gZGF0YS5yZWRpcmVjdFVybDtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uICggZGF0YSApIHtcbiAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQubG9nRXJyb3IoICdwYXltZW50LW1lbnUtZXJyb3InLCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCBkYXRhICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICB0aGlzLnBheW1lbnRNZW51Lm9wZW4oKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVmcmVzaFxuICAgICAgICAgKi9cbiAgICAgICAgcmVmcmVzaFBheW1lbnRNZW51OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAncmVmcmVzaFBheW1lbnRNZW51JyApO1xuICAgICAgICAgICAgaWYgKCB0eXBlb2YgdGhpcy5wYXltZW50TWVudSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHRoaXMucGF5bWVudE1lbnUucmVmcmVzaCA9PT0gJ2Z1bmN0aW9uJyApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBheW1lbnRNZW51LnJlZnJlc2goKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCAncmVmcmVzaFBheW1lbnRNZW51OiByZWZyZXNoIHdvcmthcm91bmQnICk7XG4gICAgICAgICAgICAgICAgLy93Y19wYXlleF9jaGVja291dC5pbml0UGF5bWVudEpTKCB3Y19wYXlleF9jaGVja291dC5qc191cmwgKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBAdG9kbyBVc2UgdGhpcy5wYXltZW50TWVudS5yZWZyZXNoKCk7IGluc3RlYWQgb2YgdGhhdFxuICAgICAgICAgICAgLy93Y19wYXlleF9jaGVja291dC5pbml0UGF5bWVudEpTKCB3Y19wYXlleF9jaGVja291dC5qc191cmwgKVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBQbGFjZSBPcmRlclxuICAgICAgICAgKiBAcmV0dXJuIHtKUXVlcnlQcm9taXNlPGFueT59XG4gICAgICAgICAqL1xuICAgICAgICBwbGFjZU9yZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ3BsYWNlT3JkZXInICk7XG4gICAgICAgICAgICBsZXQgZmllbGRzID0gJCgnLndvb2NvbW1lcmNlLWNoZWNrb3V0Jykuc2VyaWFsaXplKCk7XG5cbiAgICAgICAgICAgIHJldHVybiAkLmFqYXgoIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgdXJsOiBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0LmFqYXhfdXJsLFxuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAncGF5ZXhfcGxhY2Vfb3JkZXInLFxuICAgICAgICAgICAgICAgICAgICBub25jZTogV0NfR2F0ZXdheV9QYXlFeF9DaGVja291dC5ub25jZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogZmllbGRzXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXG4gICAgICAgICAgICB9ICkuZG9uZSggZnVuY3Rpb24gKCByZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIC8vIFJlbG9hZCBwYWdlXG4gICAgICAgICAgICAgICAgaWYgKCByZXNwb25zZS5oYXNPd25Qcm9wZXJ0eSgncmVsb2FkJykgJiYgdHJ1ZSA9PT0gcmVzcG9uc2UucmVsb2FkICkge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgIFx0XHR9XG5cbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuaGFzT3duUHJvcGVydHkoJ3Jlc3VsdCcpICYmIHJlc3BvbnNlLnJlc3VsdCA9PT0gJ2ZhaWx1cmUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmxvZ0Vycm9yKCdwYXlleC1wbGFjZS1vcmRlcicsIHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQub25FcnJvciggcmVzcG9uc2UubWVzc2FnZXMgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9ICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFVwZGF0ZSBPcmRlclxuICAgICAgICAgKiBAcmV0dXJuIHtKUXVlcnlQcm9taXNlPGFueT59XG4gICAgICAgICAqL1xuICAgICAgICB1cGRhdGVPcmRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coICd1cGRhdGVPcmRlcicgKTtcbiAgICAgICAgICAgIGxldCBmaWVsZHMgPSAkKCcud29vY29tbWVyY2UtY2hlY2tvdXQnKS5zZXJpYWxpemUoKTtcblxuICAgICAgICAgICAgcmV0dXJuICQuYWpheCgge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICB1cmw6IFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQuYWpheF91cmwsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdwYXlleF91cGRhdGVfb3JkZXInLFxuICAgICAgICAgICAgICAgICAgICBub25jZTogV0NfR2F0ZXdheV9QYXlFeF9DaGVja291dC5ub25jZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogZmllbGRzXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXG4gICAgICAgICAgICB9ICkuZG9uZSggZnVuY3Rpb24gKCByZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5oYXNPd25Qcm9wZXJ0eSgncmVzdWx0JykgJiYgcmVzcG9uc2UucmVzdWx0ID09PSAnZmFpbHVyZScpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLm1lc3NhZ2VzLmluZGV4T2YoJ09yZGVyIHVwZGF0ZSBpcyBub3QgYXZhaWxhYmxlLicpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvcmNlIHJlbG9hZFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCAncmVmcmVzaFBheW1lbnRNZW51OiByZWZyZXNoIHdvcmthcm91bmQuIEZvcmNlIHJlbG9hZC4nICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5pbml0UGF5bWVudEpTKCB3Y19wYXlleF9jaGVja291dC5qc191cmwgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbG9hZCBwYWdlXG4gICAgICAgICAgICAgICAgICAgIGlmICggcmVzcG9uc2UuaGFzT3duUHJvcGVydHkoJ3JlbG9hZCcpICYmIHRydWUgPT09IHJlc3BvbnNlLnJlbG9hZCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICBcdFx0fVxuXG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmxvZ0Vycm9yKCdwYXlleC11cGRhdGUtb3JkZXInLCByZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0Lm9uRXJyb3IoIHJlc3BvbnNlLm1lc3NhZ2VzICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSApO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBPbiBDb25zdW1lciBJZGVudGlmaWVkXG4gICAgICAgICAqIEBwYXJhbSBkYXRhXG4gICAgICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAgICAgKi9cbiAgICAgICAgb25Db25zdW1lcklkZW50aWZpZWQ6IGZ1bmN0aW9uICggZGF0YSApIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25Db25zdW1lcklkZW50aWZpZWQnLCBkYXRhICk7XG4gICAgICAgICAgICAkKCAnI2NoYW5nZS1zaGlwcGluZy1pbmZvJyApLnNob3coKTtcblxuICAgICAgICAgICAgcmV0dXJuICQuYWpheCgge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICB1cmw6IFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQuYWpheF91cmwsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdwYXlleF9jaGVja291dF9jdXN0b21lcl9wcm9maWxlJyxcbiAgICAgICAgICAgICAgICAgICAgbm9uY2U6IFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQubm9uY2UsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN1bWVyUHJvZmlsZVJlZjogZGF0YS5jb25zdW1lclByb2ZpbGVSZWZcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbidcbiAgICAgICAgICAgIH0gKS5hbHdheXMoIGZ1bmN0aW9uICggcmVzcG9uc2UgKSB7XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIH0gKS5kb25lKCBmdW5jdGlvbiAoIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2Uuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICBhbGVydChyZXNwb25zZS5kYXRhLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gSW5pdGlhdGUgQ2hlY2tvdXRcbiAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5pbml0Q2hlY2tvdXQoIGRhdGEuY29uc3VtZXJQcm9maWxlUmVmICk7XG4gICAgICAgICAgICB9ICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE9uIEFkZHJlc3MgRGV0YWlscyBBdmFpbGFibGVcbiAgICAgICAgICogQHBhcmFtIHR5cGVcbiAgICAgICAgICogQHBhcmFtIGRhdGFcbiAgICAgICAgICogQHJldHVybnMgeyp9XG4gICAgICAgICAqL1xuICAgICAgICBvbkFkZHJlc3NEZXRhaWxzQXZhaWxhYmxlOiBmdW5jdGlvbiggdHlwZSwgZGF0YSApIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25BZGRyZXNzRGV0YWlsc0F2YWlsYWJsZScsIHR5cGUsIGRhdGEgKTtcblxuICAgICAgICAgICAgJCggJyNjaGFuZ2Utc2hpcHBpbmctaW5mbycgKS5zaG93KCk7XG5cbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmJsb2NrKCk7XG4gICAgICAgICAgICByZXR1cm4gJC5hamF4KCB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIHVybDogV0NfR2F0ZXdheV9QYXlFeF9DaGVja291dC5hamF4X3VybCxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ3BheWV4X2NoZWNrb3V0X2dldF9hZGRyZXNzJyxcbiAgICAgICAgICAgICAgICAgICAgbm9uY2U6IFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQubm9uY2UsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgICAgICAgICAgICAgIHVybDogZGF0YS51cmxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbidcbiAgICAgICAgICAgIH0gKS5hbHdheXMoIGZ1bmN0aW9uICggcmVzcG9uc2UgKSB7XG4gICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQudW5ibG9jaygpO1xuICAgICAgICAgICAgfSApLmRvbmUoIGZ1bmN0aW9uICggcmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmxvZ0Vycm9yKCdwYXlleC1hZGRyZXNzLWRldGFpbHMnLCByZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KHJlc3BvbnNlLmRhdGEubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBQcm9jZXNzIGFkZHJlc3NcbiAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICAgICAgJC5lYWNoKGRhdGEsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIFt0eXBlXS5mb3JFYWNoKGZ1bmN0aW9uKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbCA9ICQoJ2lucHV0W25hbWU9XCInICsgc2VjdGlvbiArICdfJyArIGtleSArICdcIl0nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsLnByb3AoJ3JlYWRvbmx5JywgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWwuY2xvc2VzdCgnLmZvcm0tcm93JykucmVtb3ZlQ2xhc3MoJ3BheWV4LWxvY2tlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWwudmFsKHZhbHVlKS5jaGFuZ2UoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtleSA9PT0gJ2NvdW50cnknIHx8IGtleSA9PT0gJ3N0YXRlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbDEgPSAkKCcjJyArIHNlY3Rpb24gKyAnXycgKyBrZXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93LlNlbGVjdDIgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsMS5zZWxlY3QyKCd2YWwnLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgJC5mbi5jaG9zZW4gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENob3NlblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbDEudmFsKHZhbHVlKS50cmlnZ2VyKCdjaG9zZW46dXBkYXRlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2VsMS5jaG9zZW4oKS5jaGFuZ2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbDEuY2hhbmdlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICQoIGRvY3VtZW50LmJvZHkgKS50cmlnZ2VyKCAndXBkYXRlX2NoZWNrb3V0JyApO1xuICAgICAgICAgICAgfSApO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBPbiBQYXltZW50IE1lbnUgSW5zdHJ1bWVudCBTZWxlY3RlZFxuICAgICAgICAgKiBAcGFyYW0gbmFtZVxuICAgICAgICAgKiBAcGFyYW0gaW5zdHJ1bWVudFxuICAgICAgICAgKi9cbiAgICAgICAgb25QYXltZW50TWVudUluc3RydW1lbnRTZWxlY3RlZDogZnVuY3Rpb24gKCBuYW1lLCBpbnN0cnVtZW50ICkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coICdvblBheW1lbnRNZW51SW5zdHJ1bWVudFNlbGVjdGVkJywgbmFtZSwgaW5zdHJ1bWVudCApO1xuICAgICAgICAgICAgLy8gQHRvZG9cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogTG9nIEVycm9yXG4gICAgICAgICAqIEBwYXJhbSBpZFxuICAgICAgICAgKiBAcGFyYW0gZGF0YVxuICAgICAgICAgKiBAcmV0dXJucyB7Kn1cbiAgICAgICAgICovXG4gICAgICAgIGxvZ0Vycm9yOiBmdW5jdGlvbiAoIGlkLCBkYXRhICkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCBkYXRhICk7XG5cbiAgICAgICAgICAgIHJldHVybiAkLmFqYXgoIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgdXJsOiBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0LmFqYXhfdXJsLFxuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAncGF5ZXhfY2hlY2tvdXRfbG9nX2Vycm9yJyxcbiAgICAgICAgICAgICAgICAgICAgbm9uY2U6IFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQubm9uY2UsXG4gICAgICAgICAgICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoIGRhdGEgKVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJ1xuICAgICAgICAgICAgfSApO1xuICAgICAgICB9LFxuXG4gICAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uICggZGF0YSApIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25FcnJvcicsIGRhdGEgKTtcbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LnN1Ym1pdF9lcnJvciggJzxkaXYgY2xhc3M9XCJ3b29jb21tZXJjZS1lcnJvclwiPicgKyBkYXRhICsgJzwvZGl2PicgKTtcbiAgICAgICAgfSxcbiAgICAgICAgc3VibWl0X2Vycm9yOiBmdW5jdGlvbiggZXJyb3JfbWVzc2FnZSApIHtcbiAgICAgICAgICAgICQoICcud29vY29tbWVyY2UtTm90aWNlR3JvdXAtY2hlY2tvdXQsIC53b29jb21tZXJjZS1lcnJvciwgLndvb2NvbW1lcmNlLW1lc3NhZ2UnICkucmVtb3ZlKCk7XG4gICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5mb3JtLnByZXBlbmQoICc8ZGl2IGNsYXNzPVwid29vY29tbWVyY2UtTm90aWNlR3JvdXAgd29vY29tbWVyY2UtTm90aWNlR3JvdXAtY2hlY2tvdXRcIj4nICsgZXJyb3JfbWVzc2FnZSArICc8L2Rpdj4nICk7XG4gICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5mb3JtLnJlbW92ZUNsYXNzKCAncHJvY2Vzc2luZycgKS51bmJsb2NrKCk7XG4gICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5mb3JtLmZpbmQoICcuaW5wdXQtdGV4dCwgc2VsZWN0LCBpbnB1dDpjaGVja2JveCcgKS50cmlnZ2VyKCAndmFsaWRhdGUnICkuYmx1cigpO1xuICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuc2Nyb2xsX3RvX25vdGljZXMoKTtcbiAgICAgICAgICAgICQoIGRvY3VtZW50LmJvZHkgKS50cmlnZ2VyKCAnY2hlY2tvdXRfZXJyb3InICk7XG4gICAgICAgIH0sXG4gICAgICAgIHNjcm9sbF90b19ub3RpY2VzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGxldCBzY3JvbGxFbGVtZW50ID0gJCggJy53b29jb21tZXJjZS1Ob3RpY2VHcm91cC11cGRhdGVPcmRlclJldmlldywgLndvb2NvbW1lcmNlLU5vdGljZUdyb3VwLWNoZWNrb3V0JyApO1xuICAgICAgICAgICAgaWYgKCAhIHNjcm9sbEVsZW1lbnQubGVuZ3RoICkge1xuICAgICAgICAgICAgICAgIHNjcm9sbEVsZW1lbnQgPSAkKCAnLmZvcm0uY2hlY2tvdXQnICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICQuc2Nyb2xsX3RvX25vdGljZXMoIHNjcm9sbEVsZW1lbnQgKTtcbiAgICAgICAgfSxcbiAgICAgICAgaGlkZUFkZHJlc3NGaWVsZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICQoICcud29vY29tbWVyY2UtYmlsbGluZy1maWVsZHNfX2ZpZWxkLXdyYXBwZXIsIC53b29jb21tZXJjZS1zaGlwcGluZy1maWVsZHMnICkuaGlkZSgpO1xuICAgICAgICB9LFxuICAgICAgICBzaG93QWRkcmVzc0ZpZWxkczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJCggJy53b29jb21tZXJjZS1iaWxsaW5nLWZpZWxkc19fZmllbGQtd3JhcHBlciwgLndvb2NvbW1lcmNlLXNoaXBwaW5nLWZpZWxkcycgKS5zaG93KCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgJChkb2N1bWVudCkucmVhZHkoIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuaW5pdCggJCggXCJmb3JtLmNoZWNrb3V0LCBmb3JtI29yZGVyX3JldmlldywgZm9ybSNhZGRfcGF5bWVudF9tZXRob2RcIiApICk7XG4gICAgfSApO1xufSk7XG5cbiJdfQ==
