jQuery(function($){"use strict";window.wc_payex_checkout={js_url:null,paymentMenu:null,isPaymentMenuLoaded:!1,xhr:!1,init:function(e){this.form=e,this.form_submit=!1,$(this.form).on("click","#place_order",this.onSubmit).on("submit checkout_place_order_payex_checkout"),$(document.body).bind("update_checkout",this.onUpdateCheckout),$(document.body).on("checkout_error",this.resetCheckout),$(document.body).on("updated_checkout",this.onUpdatedCheckout),$(document.body).on("blur",this.onUpdatedCheckout),$(document.body).on("click","#change-shipping-info",function(){$("#change-shipping-info").hide(),wc_payex_checkout.showAddressFields()}),$(document.body).on("change","#checkin_country",function(){wc_payex_checkout.loadCheckIn($(this).val())}),wc_payex_checkout.isInstantCheckout()&&wc_payex_checkout.initInstantCheckout()},initInstantCheckout:function(){console.log("Initialization of Instant Checkout..."),wc_payex_checkout.isCheckinEnabled()&&wc_payex_checkout.hideAddressFields();let e=$("#payex-consumer-profile");if(e.length>0){let o=e.data("reference");console.log("Initiate consumerProfileRef",o),wc_payex_checkout.initCheckIn()}else wc_payex_checkout.initCheckIn()},loadCheckIn:function(e){return $.ajax({type:"POST",url:WC_Gateway_PayEx_Checkout.ajax_url,data:{action:"sb_checkin",nonce:WC_Gateway_PayEx_Checkout.nonce,country:e},dataType:"json"}).done(function(e){if(!e.success)return wc_payex_checkout.logError("payex-checkin-loader",e),void alert(e.details);window.hasOwnProperty("payex")&&window.payex.hasOwnProperty("hostedView")&&void 0!==window.payex.hostedView.consumer&&window.payex.hostedView.consumer().close(),$("script[src*='px.consumer.client']").remove(),$("#payex-checkin iframe").remove(),wc_payex_checkout.loadJs(e.data,function(){wc_payex_checkout.initCheckIn()})})},initCheckIn:function(){"undefined"!=typeof payex&&wc_payex_checkout.waitForLoading("payex.hostedView.consumer",function(e){e?console.warn(e):window.payex.hostedView.consumer({container:"payex-checkin",culture:WC_Gateway_PayEx_Checkout.culture,style:WC_Gateway_PayEx_Checkout.checkInStyle?JSON.parse(WC_Gateway_PayEx_Checkout.checkInStyle):null,onConsumerIdentified:function(e){console.log("hostedView: onConsumerIdentified"),wc_payex_checkout.onConsumerIdentified(e)},onNewConsumer:function(e){console.log("hostedView: onNewConsumer"),wc_payex_checkout.onConsumerIdentified(e)},onConsumerRemoved:function(e){console.log("hostedView: onConsumerRemoved")},onBillingDetailsAvailable:function(e){wc_payex_checkout.onAddressDetailsAvailable("billing",e)},onShippingDetailsAvailable:function(e){(WC_Gateway_PayEx_Checkout.needs_shipping_address||WC_Gateway_PayEx_Checkout.ship_to_billing_address_only)&&wc_payex_checkout.onAddressDetailsAvailable("billing",e),wc_payex_checkout.onAddressDetailsAvailable("shipping",e)},onError:function(e){wc_payex_checkout.logError("payex-checkin",e),alert(e.details),wc_payex_checkout.onError(e.details)}}).open()})},initCheckout:function(e){$("#change-shipping-info").show(),wc_payex_checkout.form.find(".payex_customer_reference").remove(),wc_payex_checkout.form.append("<input type='hidden' class='payex_customer_reference' name='payex_customer_reference' value='"+e+"'/>"),wc_payex_checkout.onSubmit()},isInstantCheckout:()=>WC_Gateway_PayEx_Checkout.instant_checkout,isCheckinEnabled:()=>WC_Gateway_PayEx_Checkout.checkin,isPaymentMethodChosen:function(){return $("#payment_method_payex_checkout").is(":checked")},block:function(){1!==wc_payex_checkout.form.data()["blockUI.isBlocked"]&&wc_payex_checkout.form.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblock:function(){wc_payex_checkout.form.unblock()},onClose:function(){wc_payex_checkout.unblock()},onReady:function(){console.log("Ready")},onUpdateCheckout:function(){if(console.log("onUpdateCheckout"),!wc_payex_checkout.isInstantCheckout())return!1},onUpdatedCheckout:function(){return console.log("onUpdatedCheckout"),!!wc_payex_checkout.isInstantCheckout()&&(!wc_payex_checkout.form.is(".processing")&&(wc_payex_checkout.validateForm()?($(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),void wc_payex_checkout.updateOrder()):(console.log("onUpdatedCheckout: Validation is failed"),!1)))},onSubmit:function(e){return!!wc_payex_checkout.form_submit||(!wc_payex_checkout.isPaymentMethodChosen()||(void 0!==e&&e.preventDefault(),!!wc_payex_checkout.validateForm()&&(console.log("onSubmit"),!wc_payex_checkout.form.is(".processing")&&($(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),wc_payex_checkout.form.addClass("processing"),wc_payex_checkout.block(),wc_payex_checkout.placeOrder().always(function(e){wc_payex_checkout.form.removeClass("processing"),wc_payex_checkout.unblock()}).fail(function(e,o){wc_payex_checkout.onError(o)}).done(function(e){if(console.log(e),"success"!==e.result)return e.hasOwnProperty("reload")&&!0===e.reload?void window.location.reload():(!0===e.result.refresh&&$(document.body).trigger("update_checkout"),void wc_payex_checkout.onError(e.messages));wc_payex_checkout.js_url=e.js_url,wc_payex_checkout.initPaymentJS(wc_payex_checkout.js_url)}),!1))))},resetCheckout:function(){wc_payex_checkout.form_submit=!1},validateForm:function(){var e,o=!0;return(e=$("#ship-to-different-address-checkbox").is(":checked")?$(".woocommerce-billing-fields .validate-required, .woocommerce-shipping-fields .validate-required").find("input, select").not($("#account_password, #account_username")):$(".woocommerce-billing-fields .validate-required").find("input, select").not($("#account_password, #account_username"))).length&&e.each(function(){var e=$(this),c=e.closest(".form-row"),t=c.is(".validate-required"),n=c.is(".validate-email");(t&&("checkbox"!==e.attr("type")||e.is(":checked")?""===e.val()&&(o=!1):o=!1),n)&&(e.val()&&(new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i).test(e.val())||(o=!1)))}),o},waitForLoading:function(var_string,callback){try{var obj=eval(var_string)}catch(e){return void callback(e)}let attempts=0,timer=window.setInterval(function(){void 0!==obj?(window.clearInterval(timer),callback(null,obj)):++attempts>=120&&(window.clearInterval(timer),callback("Timeout"))},500)},loadJs:function(e,o){let c=document.createElement("script");c.setAttribute("src",e),c.setAttribute("type","text/javascript"),c.setAttribute("async",""),c.addEventListener("load",function(){o()},!1);let t=document.getElementsByTagName("head")[0];return t&&t.appendChild(c),c},initPaymentJS:function(e,o){void 0===o&&(o=function(){}),window.hasOwnProperty("payex")&&window.payex.hasOwnProperty("hostedView")&&(void 0!==window.payex.hostedView.paymentMenu&&window.payex.hostedView.paymentMenu().close(),$("#payment-payex-checkout iframe").remove()),$("script[src*='px.paymentmenu.client']").remove(),wc_payex_checkout.loadJs(e,function(){$("#payment-payex-checkout iframe").remove(),wc_payex_checkout.isInstantCheckout()?($("#payment").hide(),wc_payex_checkout.initPaymentMenu("payment-payex-checkout")):$.featherlight('<div id="payex-paymentmenu">&nbsp;</div>',{variant:"featherlight-payex",persist:!0,closeOnClick:!1,closeOnEsc:!1,afterOpen:function(){wc_payex_checkout.initPaymentMenu("payex-paymentmenu")},afterClose:function(){wc_payex_checkout.form.removeClass("processing").unblock()}}),o()})},initPaymentMenu:function(e,o){console.log("initPaymentMenu"),void 0===o&&(o=function(){}),this.paymentMenu=window.payex.hostedView.paymentMenu({container:e,culture:WC_Gateway_PayEx_Checkout.culture,style:WC_Gateway_PayEx_Checkout.paymentMenuStyle?JSON.parse(WC_Gateway_PayEx_Checkout.paymentMenuStyle):null,onApplicationConfigured:function(e){console.log("onApplicationConfigured"),console.log(e),wc_payex_checkout.isPaymentMenuLoaded=!0,o(null)},onPaymentMenuInstrumentSelected:function(e){console.log("onPaymentMenuInstrumentSelected"),console.log(e),wc_payex_checkout.onPaymentMenuInstrumentSelected(e.name,e.instrument)},onPaymentCreated:function(){console.log("onPaymentCreated")},onPaymentCompleted:function(e){console.log("onPaymentCompleted"),console.log(e),self.location.href=e.redirectUrl},onPaymentCanceled:function(e){console.log("onPaymentCanceled"),console.log(e),wc_payex_checkout.logError("payment-menu-cancel",e)},onPaymentFailed:function(e){console.log("onPaymentFailed"),console.log(e),wc_payex_checkout.logError("payment-menu-failed",e)},onError:function(e){wc_payex_checkout.logError("payment-menu-error",e),o(e)}}),this.paymentMenu.open()},refreshPaymentMenu:function(){console.log("refreshPaymentMenu"),void 0!==this.paymentMenu&&this.paymentMenu&&this.paymentMenu.hasOwnProperty("refresh")&&"function"==typeof this.paymentMenu.refresh?this.paymentMenu.refresh():console.warn("refreshPaymentMenu: refresh workaround")},placeOrder:function(){console.log("placeOrder");let e=$(".woocommerce-checkout").serialize();return $.ajax({type:"POST",url:WC_Gateway_PayEx_Checkout.ajax_url,data:{action:"payex_place_order",nonce:WC_Gateway_PayEx_Checkout.nonce,data:e},dataType:"json"}).done(function(e){e.hasOwnProperty("reload")&&!0===e.reload?window.location.reload():e.hasOwnProperty("result")&&"failure"===e.result&&(wc_payex_checkout.logError("payex-place-order",e),wc_payex_checkout.onError(e.messages))})},updateOrder:function(e){console.log("updateOrder");let o=$(".woocommerce-checkout").serialize();return void 0===e&&(e=!1),o+="&compatibility="+e,wc_payex_checkout.form.addClass("processing"),wc_payex_checkout.block(),wc_payex_checkout.xhr&&wc_payex_checkout.xhr.abort(),wc_payex_checkout.xhr=$.ajax({type:"POST",url:WC_Gateway_PayEx_Checkout.ajax_url,data:{action:"payex_update_order",nonce:WC_Gateway_PayEx_Checkout.nonce,data:o},dataType:"json"}).always(function(e){wc_payex_checkout.xhr=!1,wc_payex_checkout.form.removeClass("processing"),wc_payex_checkout.unblock()}).fail(function(e,o){console.log("updateOrder error:"+o),wc_payex_checkout.onError(o)}).done(function(o){return console.log(o),o.hasOwnProperty("result")&&"success"===o.result?(wc_payex_checkout.js_url=o.js_url,void wc_payex_checkout.refreshPaymentMenu()):o.hasOwnProperty("result")&&"failure"===o.result&&o.messages.indexOf("Order update is not available.")>-1&&!e?(console.warn("refreshPaymentMenu: refresh workaround. Force reload."),void wc_payex_checkout.updateOrder(!0).done(function(e){e.hasOwnProperty("js_url")&&wc_payex_checkout.initPaymentJS(e.js_url)})):void(o.hasOwnProperty("reload")&&!0===o.reload?window.location.reload():(!0===o.result.refresh&&$(document.body).trigger("update_checkout"),wc_payex_checkout.logError("payex-update-order",o),wc_payex_checkout.onError(o.messages)))}),wc_payex_checkout.xhr},onConsumerIdentified:function(e){return console.log("onConsumerIdentified",e),$("#change-shipping-info").show(),$.ajax({type:"POST",url:WC_Gateway_PayEx_Checkout.ajax_url,data:{action:"payex_checkout_customer_profile",nonce:WC_Gateway_PayEx_Checkout.nonce,consumerProfileRef:e.consumerProfileRef},dataType:"json"}).always(function(e){}).done(function(o){console.log(o),o.success?wc_payex_checkout.initCheckout(e.consumerProfileRef):alert(o.data.message)})},onAddressDetailsAvailable:function(e,o){return console.log("onAddressDetailsAvailable",e,o),$("#change-shipping-info").show(),wc_payex_checkout.block(),$.ajax({type:"POST",url:WC_Gateway_PayEx_Checkout.ajax_url,data:{action:"payex_checkout_get_address",nonce:WC_Gateway_PayEx_Checkout.nonce,type:e,url:o.url},dataType:"json"}).always(function(e){wc_payex_checkout.unblock()}).done(function(o){if(console.log(o),!o.success)return wc_payex_checkout.logError("payex-address-details",o),void alert(o.data.message);let c=o.data;$.each(c,function(o,c){[e].forEach(function(e){let t=$('input[name="'+e+"_"+o+'"]');if(0!==t.length&&(t.prop("readonly",!1),t.closest(".form-row").removeClass("payex-locked"),t.val(c).change(),"country"===o||"state"===o)){let t=$("#"+e+"_"+o);void 0!==window.Select2?t.select2("val",c):void 0!==$.fn.chosen?t.val(c).trigger("chosen:updated"):t.change()}})}),$(document.body).trigger("update_checkout")})},onPaymentMenuInstrumentSelected:function(e,o){console.log("onPaymentMenuInstrumentSelected",e,o),$(document.body).trigger("sb_payment_menu_instrument_selected",[e,o])},logError:function(e,o){return console.warn(o),$.ajax({type:"POST",url:WC_Gateway_PayEx_Checkout.ajax_url,data:{action:"payex_checkout_log_error",nonce:WC_Gateway_PayEx_Checkout.nonce,id:e,data:JSON.stringify(o)},dataType:"json"})},onError:function(e){console.log("onError",e),wc_payex_checkout.submit_error('<div class="woocommerce-error">'+e+"</div>")},submit_error:function(e){$(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),wc_payex_checkout.form.prepend('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout">'+e+"</div>"),wc_payex_checkout.form.removeClass("processing").unblock(),wc_payex_checkout.form.find(".input-text, select, input:checkbox").trigger("validate").blur(),wc_payex_checkout.scroll_to_notices(),$(document.body).trigger("checkout_error")},scroll_to_notices:function(){let e=$(".woocommerce-NoticeGroup-updateOrderReview, .woocommerce-NoticeGroup-checkout");e.length||(e=$(".form.checkout")),$.scroll_to_notices(e)},hideAddressFields:function(){$(".woocommerce-billing-fields__field-wrapper, .woocommerce-shipping-fields").hide()},showAddressFields:function(){$(".woocommerce-billing-fields__field-wrapper, .woocommerce-shipping-fields").show()}},$(document).ready(function(){wc_payex_checkout.init($("form.checkout, form#order_review, form#add_payment_method"))})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNoZWNrb3V0LmpzIl0sIm5hbWVzIjpbImpRdWVyeSIsIiQiLCJ3aW5kb3ciLCJ3Y19wYXlleF9jaGVja291dCIsImpzX3VybCIsInBheW1lbnRNZW51IiwiaXNQYXltZW50TWVudUxvYWRlZCIsInhociIsImluaXQiLCJmb3JtIiwidGhpcyIsImZvcm1fc3VibWl0Iiwib24iLCJvblN1Ym1pdCIsImRvY3VtZW50IiwiYm9keSIsImJpbmQiLCJvblVwZGF0ZUNoZWNrb3V0IiwicmVzZXRDaGVja291dCIsIm9uVXBkYXRlZENoZWNrb3V0IiwiaGlkZSIsInNob3dBZGRyZXNzRmllbGRzIiwibG9hZENoZWNrSW4iLCJ2YWwiLCJpc0luc3RhbnRDaGVja291dCIsImluaXRJbnN0YW50Q2hlY2tvdXQiLCJjb25zb2xlIiwibG9nIiwiaXNDaGVja2luRW5hYmxlZCIsImhpZGVBZGRyZXNzRmllbGRzIiwiY29uc3VtZXJQcm9maWxlRWxtIiwibGVuZ3RoIiwicmVmZXJlbmNlIiwiZGF0YSIsImluaXRDaGVja0luIiwiY291bnRyeSIsImFqYXgiLCJ0eXBlIiwidXJsIiwiV0NfR2F0ZXdheV9QYXlFeF9DaGVja291dCIsImFqYXhfdXJsIiwiYWN0aW9uIiwibm9uY2UiLCJkYXRhVHlwZSIsImRvbmUiLCJzdWNjZXNzIiwibG9nRXJyb3IiLCJhbGVydCIsImRldGFpbHMiLCJoYXNPd25Qcm9wZXJ0eSIsInBheWV4IiwiaG9zdGVkVmlldyIsImNvbnN1bWVyIiwiY2xvc2UiLCJyZW1vdmUiLCJsb2FkSnMiLCJ3YWl0Rm9yTG9hZGluZyIsImVyciIsIndhcm4iLCJjb250YWluZXIiLCJjdWx0dXJlIiwic3R5bGUiLCJjaGVja0luU3R5bGUiLCJKU09OIiwicGFyc2UiLCJvbkNvbnN1bWVySWRlbnRpZmllZCIsIm9uTmV3Q29uc3VtZXIiLCJvbkNvbnN1bWVyUmVtb3ZlZCIsIm9uQmlsbGluZ0RldGFpbHNBdmFpbGFibGUiLCJvbkFkZHJlc3NEZXRhaWxzQXZhaWxhYmxlIiwib25TaGlwcGluZ0RldGFpbHNBdmFpbGFibGUiLCJuZWVkc19zaGlwcGluZ19hZGRyZXNzIiwic2hpcF90b19iaWxsaW5nX2FkZHJlc3Nfb25seSIsIm9uRXJyb3IiLCJvcGVuIiwiaW5pdENoZWNrb3V0Iiwic2hvdyIsImZpbmQiLCJhcHBlbmQiLCJpbnN0YW50X2NoZWNrb3V0IiwiY2hlY2tpbiIsImlzUGF5bWVudE1ldGhvZENob3NlbiIsImlzIiwiYmxvY2siLCJtZXNzYWdlIiwib3ZlcmxheUNTUyIsImJhY2tncm91bmQiLCJvcGFjaXR5IiwidW5ibG9jayIsIm9uQ2xvc2UiLCJvblJlYWR5IiwidmFsaWRhdGVGb3JtIiwidXBkYXRlT3JkZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJhZGRDbGFzcyIsInBsYWNlT3JkZXIiLCJhbHdheXMiLCJyZXNwb25zZSIsInJlbW92ZUNsYXNzIiwiZmFpbCIsImpxWEhSIiwidGV4dFN0YXR1cyIsInJlc3VsdCIsInJlbG9hZCIsImxvY2F0aW9uIiwicmVmcmVzaCIsInRyaWdnZXIiLCJtZXNzYWdlcyIsImluaXRQYXltZW50SlMiLCIkcmVxdWlyZWRfaW5wdXRzIiwidmFsaWRhdGVkIiwibm90IiwiZWFjaCIsIiR0aGlzIiwiJHBhcmVudCIsImNsb3Nlc3QiLCJ2YWxpZGF0ZV9yZXF1aXJlZCIsInZhbGlkYXRlX2VtYWlsIiwiYXR0ciIsIlJlZ0V4cCIsInRlc3QiLCJ2YXJfc3RyaW5nIiwiY2FsbGJhY2siLCJvYmoiLCJldmFsIiwiYXR0ZW1wdHMiLCJ0aW1lciIsInNldEludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsImpzIiwic2NyaXB0IiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJvSGVhZCIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiYXBwZW5kQ2hpbGQiLCJpbml0UGF5bWVudE1lbnUiLCJmZWF0aGVybGlnaHQiLCJ2YXJpYW50IiwicGVyc2lzdCIsImNsb3NlT25DbGljayIsImNsb3NlT25Fc2MiLCJhZnRlck9wZW4iLCJhZnRlckNsb3NlIiwiaWQiLCJwYXltZW50TWVudVN0eWxlIiwib25BcHBsaWNhdGlvbkNvbmZpZ3VyZWQiLCJvblBheW1lbnRNZW51SW5zdHJ1bWVudFNlbGVjdGVkIiwibmFtZSIsImluc3RydW1lbnQiLCJvblBheW1lbnRDcmVhdGVkIiwib25QYXltZW50Q29tcGxldGVkIiwic2VsZiIsImhyZWYiLCJyZWRpcmVjdFVybCIsIm9uUGF5bWVudENhbmNlbGVkIiwib25QYXltZW50RmFpbGVkIiwicmVmcmVzaFBheW1lbnRNZW51IiwiZmllbGRzIiwic2VyaWFsaXplIiwiY29tcGF0aWJpbGl0eSIsImFib3J0IiwiaW5kZXhPZiIsImNvbnN1bWVyUHJvZmlsZVJlZiIsImtleSIsInZhbHVlIiwiZm9yRWFjaCIsInNlY3Rpb24iLCJlbCIsInByb3AiLCJjaGFuZ2UiLCJlbDEiLCJTZWxlY3QyIiwic2VsZWN0MiIsImZuIiwiY2hvc2VuIiwic3RyaW5naWZ5Iiwic3VibWl0X2Vycm9yIiwiZXJyb3JfbWVzc2FnZSIsInByZXBlbmQiLCJibHVyIiwic2Nyb2xsX3RvX25vdGljZXMiLCJzY3JvbGxFbGVtZW50IiwicmVhZHkiXSwibWFwcGluZ3MiOiJBQUNBQSxPQUFRLFNBQVVDLEdBQ2QsYUFLQUMsT0FBT0Msa0JBQW9CLENBQ3ZCQyxPQUFRLEtBQ1JDLFlBQWEsS0FDYkMscUJBQXFCLEVBQ3JCQyxLQUFLLEVBS0xDLEtBQU0sU0FBVUMsR0FDWkMsS0FBS0QsS0FBZUEsRUFDcEJDLEtBQUtDLGFBQWUsRUFFcEJWLEVBQUdTLEtBQUtELE1BR0hHLEdBQUksUUFBUyxlQUFnQkYsS0FBS0csVUFHbENELEdBQUksOENBRVRYLEVBQUdhLFNBQVNDLE1BQU9DLEtBQU0sa0JBQW1CTixLQUFLTyxrQkFDakRoQixFQUFHYSxTQUFTQyxNQUFPSCxHQUFJLGlCQUFrQkYsS0FBS1EsZUFDOUNqQixFQUFHYSxTQUFTQyxNQUFPSCxHQUFJLG1CQUFvQkYsS0FBS1MsbUJBQ2hEbEIsRUFBR2Es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Q3dHLEdBQUlBLEVBQ0pqSCxLQUFNOEIsS0FBS21ILFVBQVdqSixJQUUxQlUsU0FBVSxVQUlsQjhCLFFBQVMsU0FBV3hDLEdBQ2hCUCxRQUFRQyxJQUFLLFVBQVdNLEdBQ3hCOUIsa0JBQWtCZ0wsYUFBYyxrQ0FBb0NsSixFQUFPLFdBRS9Fa0osYUFBYyxTQUFVQyxHQUNwQm5MLEVBQUcsK0VBQWdGcUQsU0FDbkZuRCxrQkFBa0JNLEtBQUs0SyxRQUFTLHlFQUEyRUQsRUFBZ0IsVUFDM0hqTCxrQkFBa0JNLEtBQUswRixZQUFhLGNBQWVYLFVBQ25EckYsa0JBQWtCTSxLQUFLb0UsS0FBTSx1Q0FBd0M4QixRQUFTLFlBQWEyRSxPQUMzRm5MLGtCQUFrQm9MLG9CQUNsQnRMLEVBQUdhLFNBQVNDLE1BQU80RixRQUFTLG1CQUVoQzRFLGtCQUFtQixXQUNmLElBQUlDLEVBQWdCdkwsRUFBRyxpRkFDaEJ1TCxFQUFjekosU0FDakJ5SixFQUFnQnZMLEVBQUcsbUJBR3ZCQSxFQUFFc0wsa0JBQW1CQyxJQUV6QjNKLGtCQUFtQixXQUNmNUIsRUFBRyw0RUFBNkVtQixRQUVwRkMsa0JBQW1CLFdBQ2ZwQixFQUFHLDRFQUE2RTJFLFNBSXhGM0UsRUFBRWEsVUFBVTJLLE1BQU8sV0FDZnRMLGtCQUFrQkssS0FBTVAsRUFBRyIsImZpbGUiOiJjaGVja291dC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBnbG9iYWwgd2NfY2hlY2tvdXRfcGFyYW1zICovXG5qUXVlcnkoIGZ1bmN0aW9uKCAkICkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIC8qKlxuICAgICAqIE9iamVjdCB0byBoYW5kbGUgUGF5RXggY2hlY2tvdXQgcGF5bWVudCBmb3Jtcy5cbiAgICAgKi9cbiAgICB3aW5kb3cud2NfcGF5ZXhfY2hlY2tvdXQgPSB7XG4gICAgICAgIGpzX3VybDogbnVsbCxcbiAgICAgICAgcGF5bWVudE1lbnU6IG51bGwsXG4gICAgICAgIGlzUGF5bWVudE1lbnVMb2FkZWQ6IGZhbHNlLFxuICAgICAgICB4aHI6IGZhbHNlLFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbml0aWFsaXplIGUgaGFuZGxlcnMgYW5kIFVJIHN0YXRlLlxuICAgICAgICAgKi9cbiAgICAgICAgaW5pdDogZnVuY3Rpb24oIGZvcm0gKSB7XG4gICAgICAgICAgICB0aGlzLmZvcm0gICAgICAgICA9IGZvcm07XG4gICAgICAgICAgICB0aGlzLmZvcm1fc3VibWl0ICA9IGZhbHNlO1xuXG4gICAgICAgICAgICAkKCB0aGlzLmZvcm0gKVxuICAgICAgICAgICAgLy8gV2UgbmVlZCB0byBiaW5kIGRpcmVjdGx5IHRvIHRoZSBjbGljayAoYW5kIG5vdCBjaGVja291dF9wbGFjZV9vcmRlcl9wYXlleF9jaGVja291dCkgdG8gYXZvaWQgcG9wdXAgYmxvY2tlcnNcbiAgICAgICAgICAgIC8vIGVzcGVjaWFsbHkgb24gbW9iaWxlIGRldmljZXMgKGxpa2Ugb24gQ2hyb21lIGZvciBpT1MpIGZyb20gYmxvY2tpbmcgcGF5ZXhfY2hlY2tvdXQocGF5bWVudF9pZCwge30sICdvcGVuJyk7IGZyb20gb3BlbmluZyBhIHRhYlxuICAgICAgICAgICAgICAgIC5vbiggJ2NsaWNrJywgJyNwbGFjZV9vcmRlcicsIHRoaXMub25TdWJtaXQgKVxuXG4gICAgICAgICAgICAgICAgLy8gV29vQ29tbWVyY2UgbGV0cyB1cyByZXR1cm4gYSBmYWxzZSBvbiBjaGVja291dF9wbGFjZV9vcmRlcl97Z2F0ZXdheX0gdG8ga2VlcCB0aGUgZm9ybSBmcm9tIHN1Ym1pdHRpbmdcbiAgICAgICAgICAgICAgICAub24oICdzdWJtaXQgY2hlY2tvdXRfcGxhY2Vfb3JkZXJfcGF5ZXhfY2hlY2tvdXQnICk7XG5cbiAgICAgICAgICAgICQoIGRvY3VtZW50LmJvZHkgKS5iaW5kKCAndXBkYXRlX2NoZWNrb3V0JywgdGhpcy5vblVwZGF0ZUNoZWNrb3V0ICk7XG4gICAgICAgICAgICAkKCBkb2N1bWVudC5ib2R5ICkub24oICdjaGVja291dF9lcnJvcicsIHRoaXMucmVzZXRDaGVja291dCApO1xuICAgICAgICAgICAgJCggZG9jdW1lbnQuYm9keSApLm9uKCAndXBkYXRlZF9jaGVja291dCcsIHRoaXMub25VcGRhdGVkQ2hlY2tvdXQgKTtcbiAgICAgICAgICAgICQoIGRvY3VtZW50LmJvZHkgKS5vbiggJ2JsdXInLCB0aGlzLm9uVXBkYXRlZENoZWNrb3V0ICk7XG5cbiAgICAgICAgICAgICQoIGRvY3VtZW50LmJvZHkgKS5vbiggJ2NsaWNrJywgJyNjaGFuZ2Utc2hpcHBpbmctaW5mbycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyBIaWRlIFwiQ2hhbmdlIHNoaXBwaW5nIGluZm9cIiBidXR0b25cbiAgICAgICAgICAgICAgICAkKCAnI2NoYW5nZS1zaGlwcGluZy1pbmZvJyApLmhpZGUoKTtcblxuICAgICAgICAgICAgICAgIC8vIFNob3cgQWRkcmVzcyBGaWVsZHNcbiAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5zaG93QWRkcmVzc0ZpZWxkcygpO1xuICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAkKCBkb2N1bWVudC5ib2R5ICkub24oICdjaGFuZ2UnLCAnI2NoZWNraW5fY291bnRyeScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5sb2FkQ2hlY2tJbiggJCh0aGlzKS52YWwoKSApO1xuICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAvLyBJbml0aWFsaXplIEluc3RhbnQgQ2hlY2tvdXRcbiAgICAgICAgICAgIGlmICggd2NfcGF5ZXhfY2hlY2tvdXQuaXNJbnN0YW50Q2hlY2tvdXQoKSApIHtcbiAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5pbml0SW5zdGFudENoZWNrb3V0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluaXRpYWxpemUgSW5zdGFudCBDaGVja291dFxuICAgICAgICAgKi9cbiAgICAgICAgaW5pdEluc3RhbnRDaGVja291dDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coICdJbml0aWFsaXphdGlvbiBvZiBJbnN0YW50IENoZWNrb3V0Li4uJyApO1xuXG4gICAgICAgICAgICBpZiAoIHdjX3BheWV4X2NoZWNrb3V0LmlzQ2hlY2tpbkVuYWJsZWQoKSApIHtcbiAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5oaWRlQWRkcmVzc0ZpZWxkcygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBVc2Ugc2F2ZWQgY29uc3VtZXJQcm9maWxlUmVmXG4gICAgICAgICAgICBsZXQgY29uc3VtZXJQcm9maWxlRWxtID0gJCggJyNwYXlleC1jb25zdW1lci1wcm9maWxlJyApO1xuICAgICAgICAgICAgaWYgKCBjb25zdW1lclByb2ZpbGVFbG0ubGVuZ3RoID4gMCApIHtcbiAgICAgICAgICAgICAgICBsZXQgcmVmZXJlbmNlID0gY29uc3VtZXJQcm9maWxlRWxtLmRhdGEoICdyZWZlcmVuY2UnICk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coICdJbml0aWF0ZSBjb25zdW1lclByb2ZpbGVSZWYnLCByZWZlcmVuY2UgKTtcbiAgICAgICAgICAgICAgICAvL3djX3BheWV4X2NoZWNrb3V0LmluaXRDaGVja291dCggcmVmZXJlbmNlICk7XG4gICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuaW5pdENoZWNrSW4oKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gSW5pdGlhdGUgY2hlY2tpblxuXG4gICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuaW5pdENoZWNrSW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogTG9hZCBDaGVja0luXG4gICAgICAgICAqIEBwYXJhbSBjb3VudHJ5XG4gICAgICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAgICAgKi9cbiAgICAgICAgbG9hZENoZWNrSW46IGZ1bmN0aW9uKCBjb3VudHJ5ICkge1xuICAgICAgICAgICAgcmV0dXJuICQuYWpheCgge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICB1cmw6IFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQuYWpheF91cmwsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdzYl9jaGVja2luJyxcbiAgICAgICAgICAgICAgICAgICAgbm9uY2U6IFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQubm9uY2UsXG4gICAgICAgICAgICAgICAgICAgIGNvdW50cnk6IGNvdW50cnlcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbidcbiAgICAgICAgICAgIH0gKS5kb25lKCBmdW5jdGlvbiAoIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgaWYgKCAhIGRhdGEuc3VjY2VzcyApIHtcbiAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQubG9nRXJyb3IoICdwYXlleC1jaGVja2luLWxvYWRlcicsIGRhdGEgKTtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoIGRhdGEuZGV0YWlscyApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gRGVzdHJveVxuICAgICAgICAgICAgICAgIGlmICggd2luZG93Lmhhc093blByb3BlcnR5KCAncGF5ZXgnICkgJiYgd2luZG93LnBheWV4Lmhhc093blByb3BlcnR5KCAnaG9zdGVkVmlldycgKSApIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCB0eXBlb2Ygd2luZG93LnBheWV4Lmhvc3RlZFZpZXcuY29uc3VtZXIgIT09ICd1bmRlZmluZWQnICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnBheWV4Lmhvc3RlZFZpZXcuY29uc3VtZXIoKS5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gRGVzdHJveSBKU1xuICAgICAgICAgICAgICAgICQoIFwic2NyaXB0W3NyYyo9J3B4LmNvbnN1bWVyLmNsaWVudCddXCIgKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAkKCAnI3BheWV4LWNoZWNraW4gaWZyYW1lJyApLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmxvYWRKcyggZGF0YS5kYXRhLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmluaXRDaGVja0luKCk7XG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgfSApO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbml0aWFsaXplIENoZWNrSW5cbiAgICAgICAgICovXG4gICAgICAgIGluaXRDaGVja0luOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICggdHlwZW9mIHBheWV4ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQud2FpdEZvckxvYWRpbmcoJ3BheWV4Lmhvc3RlZFZpZXcuY29uc3VtZXInLCBmdW5jdGlvbiAoIGVyciApIHtcbiAgICAgICAgICAgICAgICBpZiAoIGVyciApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCBlcnIgKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIEluaXQgUGF5RXggaG9zdGVkVmlld1xuICAgICAgICAgICAgICAgIHdpbmRvdy5wYXlleC5ob3N0ZWRWaWV3LmNvbnN1bWVyKCB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lcjogJ3BheWV4LWNoZWNraW4nLFxuICAgICAgICAgICAgICAgICAgICBjdWx0dXJlOiBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0LmN1bHR1cmUsXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlOiBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0LmNoZWNrSW5TdHlsZSA/IEpTT04ucGFyc2UoIFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQuY2hlY2tJblN0eWxlICkgOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBvbkNvbnN1bWVySWRlbnRpZmllZDogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ2hvc3RlZFZpZXc6IG9uQ29uc3VtZXJJZGVudGlmaWVkJyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQub25Db25zdW1lcklkZW50aWZpZWQoIGRhdGEgKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgb25OZXdDb25zdW1lcjogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ2hvc3RlZFZpZXc6IG9uTmV3Q29uc3VtZXInICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5vbkNvbnN1bWVySWRlbnRpZmllZCggZGF0YSApO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvbkNvbnN1bWVyUmVtb3ZlZDogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ2hvc3RlZFZpZXc6IG9uQ29uc3VtZXJSZW1vdmVkJyApO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvbkJpbGxpbmdEZXRhaWxzQXZhaWxhYmxlOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0Lm9uQWRkcmVzc0RldGFpbHNBdmFpbGFibGUoICdiaWxsaW5nJywgZGF0YSApO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvblNoaXBwaW5nRGV0YWlsc0F2YWlsYWJsZTogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQubmVlZHNfc2hpcHBpbmdfYWRkcmVzcyB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQuc2hpcF90b19iaWxsaW5nX2FkZHJlc3Nfb25seVxuICAgICAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQub25BZGRyZXNzRGV0YWlsc0F2YWlsYWJsZSggJ2JpbGxpbmcnLCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0Lm9uQWRkcmVzc0RldGFpbHNBdmFpbGFibGUoICdzaGlwcGluZycsIGRhdGEgKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcjogZnVuY3Rpb24gKCBkYXRhICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQubG9nRXJyb3IoICdwYXlleC1jaGVja2luJywgZGF0YSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIGRhdGEuZGV0YWlscyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQub25FcnJvciggZGF0YS5kZXRhaWxzICk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICkub3BlbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5pdENoZWNrb3V0OiBmdW5jdGlvbiggcmVmZXJlbmNlICkge1xuICAgICAgICAgICAgLy8gU2hvdyBcIkNoYW5nZSBzaGlwcGluZyBpbmZvXCIgYnV0dG9uXG4gICAgICAgICAgICAkKCAnI2NoYW5nZS1zaGlwcGluZy1pbmZvJyApLnNob3coKTtcblxuICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuZm9ybS5maW5kKCAnLnBheWV4X2N1c3RvbWVyX3JlZmVyZW5jZScgKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmZvcm0uYXBwZW5kKCBcIjxpbnB1dCB0eXBlPSdoaWRkZW4nIGNsYXNzPSdwYXlleF9jdXN0b21lcl9yZWZlcmVuY2UnIG5hbWU9J3BheWV4X2N1c3RvbWVyX3JlZmVyZW5jZScgdmFsdWU9J1wiICsgcmVmZXJlbmNlICsgXCInLz5cIiApO1xuXG4gICAgICAgICAgICAvL3djX3BheWV4X2NoZWNrb3V0LmZvcm0uc3VibWl0KCk7XG4gICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5vblN1Ym1pdCgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGlzSW5zdGFudENoZWNrb3V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQuaW5zdGFudF9jaGVja291dDtcbiAgICAgICAgfSxcblxuICAgICAgICBpc0NoZWNraW5FbmFibGVkKCkge1xuICAgICAgICAgICAgcmV0dXJuIFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQuY2hlY2tpbjtcbiAgICAgICAgfSxcblxuICAgICAgICBpc1BheW1lbnRNZXRob2RDaG9zZW46IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuICQoICcjcGF5bWVudF9tZXRob2RfcGF5ZXhfY2hlY2tvdXQnICkuaXMoICc6Y2hlY2tlZCcgKTtcbiAgICAgICAgfSxcblxuICAgICAgICBibG9jazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBsZXQgZm9ybV9kYXRhID0gd2NfcGF5ZXhfY2hlY2tvdXQuZm9ybS5kYXRhKCk7XG4gICAgICAgICAgICBpZiAoIDEgIT09IGZvcm1fZGF0YVsnYmxvY2tVSS5pc0Jsb2NrZWQnXSApIHtcbiAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5mb3JtLmJsb2NrKHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgb3ZlcmxheUNTUzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogJyNmZmYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMC42XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICB1bmJsb2NrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmZvcm0udW5ibG9jaygpO1xuICAgICAgICB9LFxuXG4gICAgICAgIG9uQ2xvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQudW5ibG9jaygpO1xuICAgICAgICB9LFxuXG4gICAgICAgIG9uUmVhZHk6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coICdSZWFkeScgKTtcbiAgICAgICAgfSxcblxuICAgICAgICBvblVwZGF0ZUNoZWNrb3V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25VcGRhdGVDaGVja291dCcgKTtcblxuICAgICAgICAgICAgaWYgKCAhIHdjX3BheWV4X2NoZWNrb3V0LmlzSW5zdGFudENoZWNrb3V0KCkgKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBAdG9kb1xuICAgICAgICB9LFxuXG4gICAgICAgIG9uVXBkYXRlZENoZWNrb3V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25VcGRhdGVkQ2hlY2tvdXQnICk7XG5cbiAgICAgICAgICAgIGlmICggISB3Y19wYXlleF9jaGVja291dC5pc0luc3RhbnRDaGVja291dCgpICkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCB3Y19wYXlleF9jaGVja291dC5mb3JtLmlzKCAnLnByb2Nlc3NpbmcnICkgKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoICEgd2NfcGF5ZXhfY2hlY2tvdXQudmFsaWRhdGVGb3JtKCkgKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coICdvblVwZGF0ZWRDaGVja291dDogVmFsaWRhdGlvbiBpcyBmYWlsZWQnICk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkKCAnLndvb2NvbW1lcmNlLU5vdGljZUdyb3VwLWNoZWNrb3V0LCAud29vY29tbWVyY2UtZXJyb3IsIC53b29jb21tZXJjZS1tZXNzYWdlJyApLnJlbW92ZSgpO1xuICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQudXBkYXRlT3JkZXIoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBvblN1Ym1pdDogZnVuY3Rpb24oIGUgKSB7XG4gICAgICAgICAgICBpZiAoIHdjX3BheWV4X2NoZWNrb3V0LmZvcm1fc3VibWl0ICkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIHdjX3BheWV4X2NoZWNrb3V0LmlzUGF5bWVudE1ldGhvZENob3NlbigpICkge1xuICAgICAgICAgICAgICAgIGlmICggdHlwZW9mIGUgIT09ICd1bmRlZmluZWQnICkge1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCAhIHdjX3BheWV4X2NoZWNrb3V0LnZhbGlkYXRlRm9ybSgpICkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coICdvblN1Ym1pdCcgKTtcblxuICAgICAgICAgICAgICAgIGlmICggd2NfcGF5ZXhfY2hlY2tvdXQuZm9ybS5pcyggJy5wcm9jZXNzaW5nJyApICkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJCggJy53b29jb21tZXJjZS1Ob3RpY2VHcm91cC1jaGVja291dCwgLndvb2NvbW1lcmNlLWVycm9yLCAud29vY29tbWVyY2UtbWVzc2FnZScgKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5mb3JtLmFkZENsYXNzKCAncHJvY2Vzc2luZycgKTtcbiAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5ibG9jaygpO1xuICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LnBsYWNlT3JkZXIoKVxuICAgICAgICAgICAgICAgICAgICAuYWx3YXlzKCBmdW5jdGlvbiAoIHJlc3BvbnNlICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuZm9ybS5yZW1vdmVDbGFzcyggJ3Byb2Nlc3NpbmcnICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC51bmJsb2NrKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gKVxuICAgICAgICAgICAgICAgICAgICAuZmFpbCggZnVuY3Rpb24oIGpxWEhSLCB0ZXh0U3RhdHVzICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQub25FcnJvciggdGV4dFN0YXR1cyApO1xuICAgICAgICAgICAgICAgICAgICB9IClcbiAgICAgICAgICAgICAgICAgICAgLmRvbmUoIGZ1bmN0aW9uICggcmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCByZXNwb25zZSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCByZXNwb25zZS5yZXN1bHQgIT09ICdzdWNjZXNzJyApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWxvYWQgcGFnZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggcmVzcG9uc2UuaGFzT3duUHJvcGVydHkoJ3JlbG9hZCcpICYmIHRydWUgPT09IHJlc3BvbnNlLnJlbG9hZCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVHJpZ2dlciB1cGRhdGUgaW4gY2FzZSB3ZSBuZWVkIGEgZnJlc2ggbm9uY2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIHRydWUgPT09IHJlc3BvbnNlLnJlc3VsdC5yZWZyZXNoICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCBkb2N1bWVudC5ib2R5ICkudHJpZ2dlciggJ3VwZGF0ZV9jaGVja291dCcgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5vbkVycm9yKCByZXNwb25zZS5tZXNzYWdlcyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTG9hZCBQYXlFeCBDaGVja291dCBmcmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuanNfdXJsID0gcmVzcG9uc2VbJ2pzX3VybCddO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuaW5pdFBheW1lbnRKUyggd2NfcGF5ZXhfY2hlY2tvdXQuanNfdXJsICk7XG4gICAgICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVzZXRDaGVja291dDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5mb3JtX3N1Ym1pdCA9IGZhbHNlO1xuICAgICAgICB9LFxuXG4gICAgICAgIHZhbGlkYXRlRm9ybTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyICRyZXF1aXJlZF9pbnB1dHMsXG4gICAgICAgICAgICAgICAgdmFsaWRhdGVkID0gdHJ1ZTtcblxuICAgICAgICAgICAgLy8gY2hlY2sgdG8gc2VlIGlmIHdlIG5lZWQgdG8gdmFsaWRhdGUgc2hpcHBpbmcgYWRkcmVzc1xuICAgICAgICAgICAgaWYgKCAkKCAnI3NoaXAtdG8tZGlmZmVyZW50LWFkZHJlc3MtY2hlY2tib3gnICkuaXMoICc6Y2hlY2tlZCcgKSApIHtcbiAgICAgICAgICAgICAgICAkcmVxdWlyZWRfaW5wdXRzID0gJCggJy53b29jb21tZXJjZS1iaWxsaW5nLWZpZWxkcyAudmFsaWRhdGUtcmVxdWlyZWQsIC53b29jb21tZXJjZS1zaGlwcGluZy1maWVsZHMgLnZhbGlkYXRlLXJlcXVpcmVkJyApLmZpbmQoJ2lucHV0LCBzZWxlY3QnKS5ub3QoICQoICcjYWNjb3VudF9wYXNzd29yZCwgI2FjY291bnRfdXNlcm5hbWUnICkgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJHJlcXVpcmVkX2lucHV0cyA9ICQoICcud29vY29tbWVyY2UtYmlsbGluZy1maWVsZHMgLnZhbGlkYXRlLXJlcXVpcmVkJyApLmZpbmQoJ2lucHV0LCBzZWxlY3QnKS5ub3QoICQoICcjYWNjb3VudF9wYXNzd29yZCwgI2FjY291bnRfdXNlcm5hbWUnICkgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCAkcmVxdWlyZWRfaW5wdXRzLmxlbmd0aCApIHtcbiAgICAgICAgICAgICAgICAkcmVxdWlyZWRfaW5wdXRzLmVhY2goIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgJHRoaXMgPSAkKCB0aGlzICksXG4gICAgICAgICAgICAgICAgICAgICAgICAkcGFyZW50ICAgICAgICAgICA9ICR0aGlzLmNsb3Nlc3QoICcuZm9ybS1yb3cnICksXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZV9yZXF1aXJlZCA9ICRwYXJlbnQuaXMoICcudmFsaWRhdGUtcmVxdWlyZWQnICksXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZV9lbWFpbCAgICA9ICRwYXJlbnQuaXMoICcudmFsaWRhdGUtZW1haWwnICk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCB2YWxpZGF0ZV9yZXF1aXJlZCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggJ2NoZWNrYm94JyA9PT0gJHRoaXMuYXR0ciggJ3R5cGUnICkgJiYgISAkdGhpcy5pcyggJzpjaGVja2VkJyApICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkYXRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggJHRoaXMudmFsKCkgPT09ICcnICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkYXRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCB2YWxpZGF0ZV9lbWFpbCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggJHRoaXMudmFsKCkgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjg1NTg2NS9qcXVlcnktdmFsaWRhdGUtZS1tYWlsLWFkZHJlc3MtcmVnZXggKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0dGVybiA9IG5ldyBSZWdFeHAoL14oKChbYS16XXxcXGR8WyEjXFwkJSYnXFwqXFwrXFwtXFwvPVxcP1xcXl9ge1xcfH1+XXxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSkrKFxcLihbYS16XXxcXGR8WyEjXFwkJSYnXFwqXFwrXFwtXFwvPVxcP1xcXl9ge1xcfH1+XXxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSkrKSopfCgoXFx4MjIpKCgoKFxceDIwfFxceDA5KSooXFx4MGRcXHgwYSkpPyhcXHgyMHxcXHgwOSkrKT8oKFtcXHgwMS1cXHgwOFxceDBiXFx4MGNcXHgwZS1cXHgxZlxceDdmXXxcXHgyMXxbXFx4MjMtXFx4NWJdfFtcXHg1ZC1cXHg3ZV18W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pfChcXFxcKFtcXHgwMS1cXHgwOVxceDBiXFx4MGNcXHgwZC1cXHg3Zl18W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKSkpKigoKFxceDIwfFxceDA5KSooXFx4MGRcXHgwYSkpPyhcXHgyMHxcXHgwOSkrKT8oXFx4MjIpKSlAKCgoW2Etel18XFxkfFtcXHUwMEEwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdKXwoKFthLXpdfFxcZHxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSkoW2Etel18XFxkfC18XFwufF98fnxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSkqKFthLXpdfFxcZHxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSkpKVxcLikrKChbYS16XXxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSl8KChbYS16XXxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSkoW2Etel18XFxkfC18XFwufF98fnxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSkqKFthLXpdfFtcXHUwMEEwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdKSkpXFwuPyQvaSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAhIHBhdHRlcm4udGVzdCggJHRoaXMudmFsKCkgICkgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkYXRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdmFsaWRhdGVkO1xuICAgICAgICB9LFxuXG4gICAgICAgIHdhaXRGb3JMb2FkaW5nOiBmdW5jdGlvbiAoIHZhcl9zdHJpbmcsIGNhbGxiYWNrICkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0gZXZhbCggdmFyX3N0cmluZyApO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCBlICk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgYXR0ZW1wdHMgPSAwO1xuICAgICAgICAgICAgbGV0IHRpbWVyID0gd2luZG93LnNldEludGVydmFsKCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAoIHR5cGVvZiBvYmogIT09ICd1bmRlZmluZWQnICkge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCggdGltZXIgKTtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soIG51bGwsIG9iaiApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGF0dGVtcHRzKys7XG4gICAgICAgICAgICAgICAgICAgIGlmICggYXR0ZW1wdHMgPj0gMTIwICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwoIHRpbWVyICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayggJ1RpbWVvdXQnICk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCA1MDAgKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogTG9hZCBKU1xuICAgICAgICAgKiBAcGFyYW0ganNcbiAgICAgICAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAgICAgICAqL1xuICAgICAgICBsb2FkSnM6IGZ1bmN0aW9uICgganMsIGNhbGxiYWNrICkge1xuICAgICAgICAgICAgLy8gQ3JlYXRlcyBhIG5ldyBzY3JpcHQgdGFnXG4gICAgICAgICAgICBsZXQgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ3NjcmlwdCcgKTtcblxuICAgICAgICAgICAgLy8gU2V0IHNjcmlwdCB0YWcgcGFyYW1zXG4gICAgICAgICAgICBzY3JpcHQuc2V0QXR0cmlidXRlKCAnc3JjJywganMgKTtcbiAgICAgICAgICAgIHNjcmlwdC5zZXRBdHRyaWJ1dGUoICd0eXBlJywgJ3RleHQvamF2YXNjcmlwdCcgKTtcbiAgICAgICAgICAgIHNjcmlwdC5zZXRBdHRyaWJ1dGUoICdhc3luYycsICcnICk7XG4gICAgICAgICAgICBzY3JpcHQuYWRkRXZlbnRMaXN0ZW5lciggJ2xvYWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIH0sIGZhbHNlICk7XG5cbiAgICAgICAgICAgIC8vIEdldHMgZG9jdW1lbnQgaGVhZCBlbGVtZW50XG4gICAgICAgICAgICBsZXQgb0hlYWQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSggJ2hlYWQnIClbMF07XG4gICAgICAgICAgICBpZiAoIG9IZWFkICkge1xuICAgICAgICAgICAgICAgIC8vIEFkZCBzY3JpcHQgdGFnIHRvIGhlYWRcbiAgICAgICAgICAgICAgICBvSGVhZC5hcHBlbmRDaGlsZCggc2NyaXB0ICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBzY3JpcHQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluaXRpYXRlIFBheW1lbnQgSmF2YXNjcmlwdFxuICAgICAgICAgKiBAcGFyYW0gdXJsXG4gICAgICAgICAqIEBwYXJhbSBjYWxsYmFja1xuICAgICAgICAgKi9cbiAgICAgICAgaW5pdFBheW1lbnRKUzogZnVuY3Rpb24gKCB1cmwsIGNhbGxiYWNrICkge1xuICAgICAgICAgICAgaWYgKCB0eXBlb2YgY2FsbGJhY2sgPT09ICd1bmRlZmluZWQnICkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrID0gZnVuY3Rpb24gKCkge307XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIERlc3Ryb3lcbiAgICAgICAgICAgIGlmICggd2luZG93Lmhhc093blByb3BlcnR5KCAncGF5ZXgnICkgJiYgd2luZG93LnBheWV4Lmhhc093blByb3BlcnR5KCAnaG9zdGVkVmlldycgKSApIHtcbiAgICAgICAgICAgICAgICBpZiAoIHR5cGVvZiB3aW5kb3cucGF5ZXguaG9zdGVkVmlldy5wYXltZW50TWVudSAhPT0gJ3VuZGVmaW5lZCcgKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5wYXlleC5ob3N0ZWRWaWV3LnBheW1lbnRNZW51KCkuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAkKCAnI3BheW1lbnQtcGF5ZXgtY2hlY2tvdXQgaWZyYW1lJyApLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIC8vZGVsZXRlIHdpbmRvdy5wYXlleC5ob3N0ZWRWaWV3O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBEZXN0cm95IEpTXG4gICAgICAgICAgICAkKCBcInNjcmlwdFtzcmMqPSdweC5wYXltZW50bWVudS5jbGllbnQnXVwiICkucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgIC8vIExvYWQgSlNcbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmxvYWRKcyggdXJsLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJCggJyNwYXltZW50LXBheWV4LWNoZWNrb3V0IGlmcmFtZScgKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgICAgIC8vIExvYWQgUGF5RXggQ2hlY2tvdXQgZnJhbWVcbiAgICAgICAgICAgICAgICBpZiAoIHdjX3BheWV4X2NoZWNrb3V0LmlzSW5zdGFudENoZWNrb3V0KCkgKSB7XG4gICAgICAgICAgICAgICAgICAgICQoICcjcGF5bWVudCcgKS5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmluaXRQYXltZW50TWVudSggJ3BheW1lbnQtcGF5ZXgtY2hlY2tvdXQnICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJC5mZWF0aGVybGlnaHQoICc8ZGl2IGlkPVwicGF5ZXgtcGF5bWVudG1lbnVcIj4mbmJzcDs8L2Rpdj4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50OiAnZmVhdGhlcmxpZ2h0LXBheWV4JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNpc3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBjbG9zZU9uQ2xpY2s6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VPbkVzYzogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBhZnRlck9wZW46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5pbml0UGF5bWVudE1lbnUoICdwYXlleC1wYXltZW50bWVudScgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBhZnRlckNsb3NlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuZm9ybS5yZW1vdmVDbGFzcyggJ3Byb2Nlc3NpbmcnICkudW5ibG9jaygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKVxuICAgICAgICAgICAgfSApO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbml0aWF0ZSBQYXltZW50IE1lbnUuXG4gICAgICAgICAqIFBheW1lbnQgSmF2YXNjcmlwdCBtdXN0IGJlIGxvYWRlZC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIGlkXG4gICAgICAgICAqIEBwYXJhbSBjYWxsYmFja1xuICAgICAgICAgKi9cbiAgICAgICAgaW5pdFBheW1lbnRNZW51OiBmdW5jdGlvbiAoIGlkLCBjYWxsYmFjayApIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnaW5pdFBheW1lbnRNZW51JyApO1xuXG4gICAgICAgICAgICBpZiAoIHR5cGVvZiBjYWxsYmFjayA9PT0gJ3VuZGVmaW5lZCcgKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7fTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTG9hZCBQYXlFeCBDaGVja291dCBmcmFtZVxuICAgICAgICAgICAgdGhpcy5wYXltZW50TWVudSA9IHdpbmRvdy5wYXlleC5ob3N0ZWRWaWV3LnBheW1lbnRNZW51KCB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyOiBpZCxcbiAgICAgICAgICAgICAgICBjdWx0dXJlOiBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0LmN1bHR1cmUsXG4gICAgICAgICAgICAgICAgc3R5bGU6IFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQucGF5bWVudE1lbnVTdHlsZSA/IEpTT04ucGFyc2UoIFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQucGF5bWVudE1lbnVTdHlsZSApIDogbnVsbCxcbiAgICAgICAgICAgICAgICBvbkFwcGxpY2F0aW9uQ29uZmlndXJlZDogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25BcHBsaWNhdGlvbkNvbmZpZ3VyZWQnICk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmlzUGF5bWVudE1lbnVMb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayggbnVsbCApO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgb25QYXltZW50TWVudUluc3RydW1lbnRTZWxlY3RlZDogZnVuY3Rpb24gKCBkYXRhICkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uUGF5bWVudE1lbnVJbnN0cnVtZW50U2VsZWN0ZWQnICk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0Lm9uUGF5bWVudE1lbnVJbnN0cnVtZW50U2VsZWN0ZWQoIGRhdGEubmFtZSwgZGF0YS5pbnN0cnVtZW50ICk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvblBheW1lbnRDcmVhdGVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25QYXltZW50Q3JlYXRlZCcgKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9uUGF5bWVudENvbXBsZXRlZDogZnVuY3Rpb24gKCBkYXRhICkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uUGF5bWVudENvbXBsZXRlZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIGRhdGEgKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5sb2NhdGlvbi5ocmVmID0gZGF0YS5yZWRpcmVjdFVybDtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9uUGF5bWVudENhbmNlbGVkOiBmdW5jdGlvbiAoIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25QYXltZW50Q2FuY2VsZWQnICk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmxvZ0Vycm9yKCAncGF5bWVudC1tZW51LWNhbmNlbCcsIGRhdGEgKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9uUGF5bWVudEZhaWxlZDogZnVuY3Rpb24gKCBkYXRhICkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uUGF5bWVudEZhaWxlZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIGRhdGEgKTtcbiAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQubG9nRXJyb3IoICdwYXltZW50LW1lbnUtZmFpbGVkJywgZGF0YSApO1xuICAgICAgICAgICAgICAgICAgICAvL3NlbGYubG9jYXRpb24uaHJlZiA9IGRhdGEucmVkaXJlY3RVcmw7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvbkVycm9yOiBmdW5jdGlvbiAoIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmxvZ0Vycm9yKCAncGF5bWVudC1tZW51LWVycm9yJywgZGF0YSApO1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayggZGF0YSApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgdGhpcy5wYXltZW50TWVudS5vcGVuKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlZnJlc2hcbiAgICAgICAgICovXG4gICAgICAgIHJlZnJlc2hQYXltZW50TWVudTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ3JlZnJlc2hQYXltZW50TWVudScgKTtcbiAgICAgICAgICAgIGlmICggdHlwZW9mIHRoaXMucGF5bWVudE1lbnUgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgICAgICAgICAgdGhpcy5wYXltZW50TWVudSAmJlxuICAgICAgICAgICAgICAgIHRoaXMucGF5bWVudE1lbnUuaGFzT3duUHJvcGVydHkoICdyZWZyZXNoJyApICYmXG4gICAgICAgICAgICAgICAgdHlwZW9mIHRoaXMucGF5bWVudE1lbnUucmVmcmVzaCA9PT0gJ2Z1bmN0aW9uJyApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXltZW50TWVudS5yZWZyZXNoKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybiggJ3JlZnJlc2hQYXltZW50TWVudTogcmVmcmVzaCB3b3JrYXJvdW5kJyApO1xuICAgICAgICAgICAgICAgIC8vd2NfcGF5ZXhfY2hlY2tvdXQuaW5pdFBheW1lbnRKUyggd2NfcGF5ZXhfY2hlY2tvdXQuanNfdXJsIClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogUGxhY2UgT3JkZXJcbiAgICAgICAgICogQHJldHVybiB7SlF1ZXJ5UHJvbWlzZTxhbnk+fVxuICAgICAgICAgKi9cbiAgICAgICAgcGxhY2VPcmRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coICdwbGFjZU9yZGVyJyApO1xuICAgICAgICAgICAgbGV0IGZpZWxkcyA9ICQoJy53b29jb21tZXJjZS1jaGVja291dCcpLnNlcmlhbGl6ZSgpO1xuXG4gICAgICAgICAgICByZXR1cm4gJC5hamF4KCB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIHVybDogV0NfR2F0ZXdheV9QYXlFeF9DaGVja291dC5hamF4X3VybCxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ3BheWV4X3BsYWNlX29yZGVyJyxcbiAgICAgICAgICAgICAgICAgICAgbm9uY2U6IFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQubm9uY2UsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGZpZWxkc1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJ1xuICAgICAgICAgICAgfSApLmRvbmUoIGZ1bmN0aW9uICggcmVzcG9uc2UgKSB7XG4gICAgICAgICAgICAgICAgLy8gUmVsb2FkIHBhZ2VcbiAgICAgICAgICAgICAgICBpZiAoIHJlc3BvbnNlLmhhc093blByb3BlcnR5KCdyZWxvYWQnKSAmJiB0cnVlID09PSByZXNwb25zZS5yZWxvYWQgKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgXHRcdH1cblxuICAgICAgICAgICAgICAgIGlmICggcmVzcG9uc2UuaGFzT3duUHJvcGVydHkoJ3Jlc3VsdCcpICYmIHJlc3BvbnNlLnJlc3VsdCA9PT0gJ2ZhaWx1cmUnICkge1xuICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5sb2dFcnJvciggJ3BheWV4LXBsYWNlLW9yZGVyJywgcmVzcG9uc2UgKTtcbiAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQub25FcnJvciggcmVzcG9uc2UubWVzc2FnZXMgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9ICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFVwZGF0ZSBPcmRlclxuICAgICAgICAgKiBAcGFyYW0gY29tcGF0aWJpbGl0eVxuICAgICAgICAgKiBAcmV0dXJuIHtKUXVlcnlQcm9taXNlPGFueT59XG4gICAgICAgICAqL1xuICAgICAgICB1cGRhdGVPcmRlcjogZnVuY3Rpb24gKCBjb21wYXRpYmlsaXR5ICkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coICd1cGRhdGVPcmRlcicgKTtcbiAgICAgICAgICAgIGxldCBmaWVsZHMgPSAkKCcud29vY29tbWVyY2UtY2hlY2tvdXQnKS5zZXJpYWxpemUoKTtcblxuICAgICAgICAgICAgaWYgKCB0eXBlb2YgY29tcGF0aWJpbGl0eSA9PT0gJ3VuZGVmaW5lZCcgKSB7XG4gICAgICAgICAgICAgICAgY29tcGF0aWJpbGl0eSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmaWVsZHMgKz0gJyZjb21wYXRpYmlsaXR5PScgKyBjb21wYXRpYmlsaXR5O1xuXG4gICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5mb3JtLmFkZENsYXNzKCAncHJvY2Vzc2luZycgKTtcbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmJsb2NrKCk7XG5cbiAgICAgICAgICAgIGlmICggd2NfcGF5ZXhfY2hlY2tvdXQueGhyICkge1xuICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0Lnhoci5hYm9ydCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC54aHIgPSAkLmFqYXgoIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgdXJsOiBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0LmFqYXhfdXJsLFxuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAncGF5ZXhfdXBkYXRlX29yZGVyJyxcbiAgICAgICAgICAgICAgICAgICAgbm9uY2U6IFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQubm9uY2UsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGZpZWxkc1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJ1xuICAgICAgICAgICAgfSApXG4gICAgICAgICAgICAgICAgLmFsd2F5cyggZnVuY3Rpb24gKCByZXNwb25zZSApIHtcbiAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQueGhyID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmZvcm0ucmVtb3ZlQ2xhc3MoICdwcm9jZXNzaW5nJyApO1xuICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC51bmJsb2NrKCk7XG4gICAgICAgICAgICAgICAgfSApXG4gICAgICAgICAgICAgICAgLmZhaWwoIGZ1bmN0aW9uKCBqcVhIUiwgdGV4dFN0YXR1cyApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coICd1cGRhdGVPcmRlciBlcnJvcjonICsgdGV4dFN0YXR1cyApO1xuICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5vbkVycm9yKCB0ZXh0U3RhdHVzICk7XG4gICAgICAgICAgICAgICAgfSApXG4gICAgICAgICAgICAgICAgLmRvbmUoIGZ1bmN0aW9uICggcmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIHJlc3BvbnNlICk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCByZXNwb25zZS5oYXNPd25Qcm9wZXJ0eSgncmVzdWx0JykgJiYgcmVzcG9uc2UucmVzdWx0ID09PSAnc3VjY2VzcycgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWZyZXNoIFBheW1lbnQgTWVudVxuICAgICAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuanNfdXJsID0gcmVzcG9uc2VbJ2pzX3VybCddO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQucmVmcmVzaFBheW1lbnRNZW51KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICggcmVzcG9uc2UuaGFzT3duUHJvcGVydHkoJ3Jlc3VsdCcpICYmIHJlc3BvbnNlLnJlc3VsdCA9PT0gJ2ZhaWx1cmUnICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3dlZGVuQmFuayBQYXltZW50IHJldHVybnMgZXJyb3IgdGhhdCBPcmRlciB1cGRhdGUgaXMgbm90IGF2YWlsYWJsZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCByZXNwb25zZS5tZXNzYWdlcy5pbmRleE9mKCAnT3JkZXIgdXBkYXRlIGlzIG5vdCBhdmFpbGFibGUuJyApID4gLTEgJiYgISBjb21wYXRpYmlsaXR5ICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvcmNlIHJlbG9hZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybiggJ3JlZnJlc2hQYXltZW50TWVudTogcmVmcmVzaCB3b3JrYXJvdW5kLiBGb3JjZSByZWxvYWQuJyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LnVwZGF0ZU9yZGVyKCB0cnVlICkuZG9uZSggZnVuY3Rpb24gKCByZXNwb25zZSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCByZXNwb25zZS5oYXNPd25Qcm9wZXJ0eSgnanNfdXJsJykgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5pbml0UGF5bWVudEpTKCByZXNwb25zZS5qc191cmwgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbG9hZCBwYWdlXG4gICAgICAgICAgICAgICAgICAgIGlmICggcmVzcG9uc2UuaGFzT3duUHJvcGVydHkoJ3JlbG9hZCcpICYmIHRydWUgPT09IHJlc3BvbnNlLnJlbG9hZCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gVHJpZ2dlciB1cGRhdGUgaW4gY2FzZSB3ZSBuZWVkIGEgZnJlc2ggbm9uY2VcbiAgICAgICAgICAgICAgICAgICAgaWYgKCB0cnVlID09PSByZXNwb25zZS5yZXN1bHQucmVmcmVzaCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoIGRvY3VtZW50LmJvZHkgKS50cmlnZ2VyKCAndXBkYXRlX2NoZWNrb3V0JyApO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQubG9nRXJyb3IoICdwYXlleC11cGRhdGUtb3JkZXInLCByZXNwb25zZSApO1xuICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5vbkVycm9yKCByZXNwb25zZS5tZXNzYWdlcyApO1xuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiAgd2NfcGF5ZXhfY2hlY2tvdXQueGhyO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBPbiBDb25zdW1lciBJZGVudGlmaWVkXG4gICAgICAgICAqIEBwYXJhbSBkYXRhXG4gICAgICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAgICAgKi9cbiAgICAgICAgb25Db25zdW1lcklkZW50aWZpZWQ6IGZ1bmN0aW9uICggZGF0YSApIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25Db25zdW1lcklkZW50aWZpZWQnLCBkYXRhICk7XG4gICAgICAgICAgICAkKCAnI2NoYW5nZS1zaGlwcGluZy1pbmZvJyApLnNob3coKTtcblxuICAgICAgICAgICAgcmV0dXJuICQuYWpheCgge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICB1cmw6IFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQuYWpheF91cmwsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdwYXlleF9jaGVja291dF9jdXN0b21lcl9wcm9maWxlJyxcbiAgICAgICAgICAgICAgICAgICAgbm9uY2U6IFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQubm9uY2UsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN1bWVyUHJvZmlsZVJlZjogZGF0YS5jb25zdW1lclByb2ZpbGVSZWZcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbidcbiAgICAgICAgICAgIH0gKS5hbHdheXMoIGZ1bmN0aW9uICggcmVzcG9uc2UgKSB7XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIH0gKS5kb25lKCBmdW5jdGlvbiAoIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2Uuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICBhbGVydChyZXNwb25zZS5kYXRhLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gSW5pdGlhdGUgQ2hlY2tvdXRcbiAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5pbml0Q2hlY2tvdXQoIGRhdGEuY29uc3VtZXJQcm9maWxlUmVmICk7XG4gICAgICAgICAgICB9ICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE9uIEFkZHJlc3MgRGV0YWlscyBBdmFpbGFibGVcbiAgICAgICAgICogQHBhcmFtIHR5cGVcbiAgICAgICAgICogQHBhcmFtIGRhdGFcbiAgICAgICAgICogQHJldHVybnMgeyp9XG4gICAgICAgICAqL1xuICAgICAgICBvbkFkZHJlc3NEZXRhaWxzQXZhaWxhYmxlOiBmdW5jdGlvbiggdHlwZSwgZGF0YSApIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25BZGRyZXNzRGV0YWlsc0F2YWlsYWJsZScsIHR5cGUsIGRhdGEgKTtcblxuICAgICAgICAgICAgJCggJyNjaGFuZ2Utc2hpcHBpbmctaW5mbycgKS5zaG93KCk7XG5cbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmJsb2NrKCk7XG4gICAgICAgICAgICByZXR1cm4gJC5hamF4KCB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIHVybDogV0NfR2F0ZXdheV9QYXlFeF9DaGVja291dC5hamF4X3VybCxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ3BheWV4X2NoZWNrb3V0X2dldF9hZGRyZXNzJyxcbiAgICAgICAgICAgICAgICAgICAgbm9uY2U6IFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQubm9uY2UsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgICAgICAgICAgICAgIHVybDogZGF0YS51cmxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbidcbiAgICAgICAgICAgIH0gKS5hbHdheXMoIGZ1bmN0aW9uICggcmVzcG9uc2UgKSB7XG4gICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQudW5ibG9jaygpO1xuICAgICAgICAgICAgfSApLmRvbmUoIGZ1bmN0aW9uICggcmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmxvZ0Vycm9yKCdwYXlleC1hZGRyZXNzLWRldGFpbHMnLCByZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KHJlc3BvbnNlLmRhdGEubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBQcm9jZXNzIGFkZHJlc3NcbiAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICAgICAgJC5lYWNoKGRhdGEsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIFt0eXBlXS5mb3JFYWNoKGZ1bmN0aW9uKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbCA9ICQoJ2lucHV0W25hbWU9XCInICsgc2VjdGlvbiArICdfJyArIGtleSArICdcIl0nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsLnByb3AoJ3JlYWRvbmx5JywgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWwuY2xvc2VzdCgnLmZvcm0tcm93JykucmVtb3ZlQ2xhc3MoJ3BheWV4LWxvY2tlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWwudmFsKHZhbHVlKS5jaGFuZ2UoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtleSA9PT0gJ2NvdW50cnknIHx8IGtleSA9PT0gJ3N0YXRlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbDEgPSAkKCcjJyArIHNlY3Rpb24gKyAnXycgKyBrZXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93LlNlbGVjdDIgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsMS5zZWxlY3QyKCd2YWwnLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgJC5mbi5jaG9zZW4gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENob3NlblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbDEudmFsKHZhbHVlKS50cmlnZ2VyKCdjaG9zZW46dXBkYXRlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2VsMS5jaG9zZW4oKS5jaGFuZ2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbDEuY2hhbmdlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICQoIGRvY3VtZW50LmJvZHkgKS50cmlnZ2VyKCAndXBkYXRlX2NoZWNrb3V0JyApO1xuICAgICAgICAgICAgfSApO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBPbiBQYXltZW50IE1lbnUgSW5zdHJ1bWVudCBTZWxlY3RlZFxuICAgICAgICAgKiBAcGFyYW0gbmFtZVxuICAgICAgICAgKiBAcGFyYW0gaW5zdHJ1bWVudFxuICAgICAgICAgKi9cbiAgICAgICAgb25QYXltZW50TWVudUluc3RydW1lbnRTZWxlY3RlZDogZnVuY3Rpb24gKCBuYW1lLCBpbnN0cnVtZW50ICkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coICdvblBheW1lbnRNZW51SW5zdHJ1bWVudFNlbGVjdGVkJywgbmFtZSwgaW5zdHJ1bWVudCApO1xuICAgICAgICAgICAgJCggZG9jdW1lbnQuYm9keSApLnRyaWdnZXIoICdzYl9wYXltZW50X21lbnVfaW5zdHJ1bWVudF9zZWxlY3RlZCcsIFtuYW1lLCBpbnN0cnVtZW50XSApO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBMb2cgRXJyb3JcbiAgICAgICAgICogQHBhcmFtIGlkXG4gICAgICAgICAqIEBwYXJhbSBkYXRhXG4gICAgICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAgICAgKi9cbiAgICAgICAgbG9nRXJyb3I6IGZ1bmN0aW9uICggaWQsIGRhdGEgKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oIGRhdGEgKTtcblxuICAgICAgICAgICAgcmV0dXJuICQuYWpheCgge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICB1cmw6IFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQuYWpheF91cmwsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdwYXlleF9jaGVja291dF9sb2dfZXJyb3InLFxuICAgICAgICAgICAgICAgICAgICBub25jZTogV0NfR2F0ZXdheV9QYXlFeF9DaGVja291dC5ub25jZSxcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeSggZGF0YSApXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXG4gICAgICAgICAgICB9ICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgb25FcnJvcjogZnVuY3Rpb24gKCBkYXRhICkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coICdvbkVycm9yJywgZGF0YSApO1xuICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuc3VibWl0X2Vycm9yKCAnPGRpdiBjbGFzcz1cIndvb2NvbW1lcmNlLWVycm9yXCI+JyArIGRhdGEgKyAnPC9kaXY+JyApO1xuICAgICAgICB9LFxuICAgICAgICBzdWJtaXRfZXJyb3I6IGZ1bmN0aW9uKCBlcnJvcl9tZXNzYWdlICkge1xuICAgICAgICAgICAgJCggJy53b29jb21tZXJjZS1Ob3RpY2VHcm91cC1jaGVja291dCwgLndvb2NvbW1lcmNlLWVycm9yLCAud29vY29tbWVyY2UtbWVzc2FnZScgKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmZvcm0ucHJlcGVuZCggJzxkaXYgY2xhc3M9XCJ3b29jb21tZXJjZS1Ob3RpY2VHcm91cCB3b29jb21tZXJjZS1Ob3RpY2VHcm91cC1jaGVja291dFwiPicgKyBlcnJvcl9tZXNzYWdlICsgJzwvZGl2PicgKTtcbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmZvcm0ucmVtb3ZlQ2xhc3MoICdwcm9jZXNzaW5nJyApLnVuYmxvY2soKTtcbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmZvcm0uZmluZCggJy5pbnB1dC10ZXh0LCBzZWxlY3QsIGlucHV0OmNoZWNrYm94JyApLnRyaWdnZXIoICd2YWxpZGF0ZScgKS5ibHVyKCk7XG4gICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5zY3JvbGxfdG9fbm90aWNlcygpO1xuICAgICAgICAgICAgJCggZG9jdW1lbnQuYm9keSApLnRyaWdnZXIoICdjaGVja291dF9lcnJvcicgKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2Nyb2xsX3RvX25vdGljZXM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgbGV0IHNjcm9sbEVsZW1lbnQgPSAkKCAnLndvb2NvbW1lcmNlLU5vdGljZUdyb3VwLXVwZGF0ZU9yZGVyUmV2aWV3LCAud29vY29tbWVyY2UtTm90aWNlR3JvdXAtY2hlY2tvdXQnICk7XG4gICAgICAgICAgICBpZiAoICEgc2Nyb2xsRWxlbWVudC5sZW5ndGggKSB7XG4gICAgICAgICAgICAgICAgc2Nyb2xsRWxlbWVudCA9ICQoICcuZm9ybS5jaGVja291dCcgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJC5zY3JvbGxfdG9fbm90aWNlcyggc2Nyb2xsRWxlbWVudCApO1xuICAgICAgICB9LFxuICAgICAgICBoaWRlQWRkcmVzc0ZpZWxkczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJCggJy53b29jb21tZXJjZS1iaWxsaW5nLWZpZWxkc19fZmllbGQtd3JhcHBlciwgLndvb2NvbW1lcmNlLXNoaXBwaW5nLWZpZWxkcycgKS5oaWRlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIHNob3dBZGRyZXNzRmllbGRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkKCAnLndvb2NvbW1lcmNlLWJpbGxpbmctZmllbGRzX19maWVsZC13cmFwcGVyLCAud29vY29tbWVyY2Utc2hpcHBpbmctZmllbGRzJyApLnNob3coKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAkKGRvY3VtZW50KS5yZWFkeSggZnVuY3Rpb24gKCkge1xuICAgICAgICB3Y19wYXlleF9jaGVja291dC5pbml0KCAkKCBcImZvcm0uY2hlY2tvdXQsIGZvcm0jb3JkZXJfcmV2aWV3LCBmb3JtI2FkZF9wYXltZW50X21ldGhvZFwiICkgKTtcbiAgICB9ICk7XG59KTtcblxuIl19
