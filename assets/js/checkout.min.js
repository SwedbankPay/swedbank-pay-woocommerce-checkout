jQuery(function($){"use strict";window.wc_payex_checkout={js_url:null,xhr:!1,init:function(e){this.form=e,this.form_submit=!1,$(this.form).on("click","#place_order",this.onSubmit).on("submit checkout_place_order_payex_checkout"),$(document.body).bind("update_checkout",this.onUpdateCheckout),$(document.body).on("checkout_error",this.resetCheckout),$(document.body).on("updated_checkout",this.onUpdatedCheckout),$(document.body).on("blur",this.onUpdatedCheckout),$(document.body).on("click","#change-shipping-info",function(){$("#change-shipping-info").hide(),wc_payex_checkout.showAddressFields()}),wc_payex_checkout.isInstantCheckout()&&wc_payex_checkout.initInstantCheckout()},initInstantCheckout:function(){console.log("Initialization of Instant Checkout..."),wc_payex_checkout.isCheckinEnabled();let e=$("#payex-consumer-profile");if(e.length>0){let o=e.data("reference");console.log("Initiate consumerProfileRef",o),wc_payex_checkout.initCheckout(o)}else wc_payex_checkout.initCheckIn()},initCheckIn:function(){"undefined"!=typeof payex&&wc_payex_checkout.waitForLoading("payex.hostedView.consumer",function(e){e?console.warn(e):window.payex.hostedView.consumer({container:"payex-checkin",culture:WC_Gateway_PayEx_Checkout.culture,style:WC_Gateway_PayEx_Checkout.checkInStyle?JSON.parse(WC_Gateway_PayEx_Checkout.checkInStyle):null,onConsumerIdentified:function(e){console.log("hostedView: onConsumerIdentified"),wc_payex_checkout.onConsumerIdentified(e)},onBillingDetailsAvailable:function(e){wc_payex_checkout.onAddressDetailsAvailable("billing",e)},onShippingDetailsAvailable:function(e){wc_payex_checkout.onAddressDetailsAvailable("shipping",e)},onError:function(e){wc_payex_checkout.logError("payex-checkin",e),alert(e.details)}}).open()})},initCheckout:function(e){$("#change-shipping-info").show(),wc_payex_checkout.form.find(".payex_customer_reference").remove(),wc_payex_checkout.form.append("<input type='hidden' class='payex_customer_reference' name='payex_customer_reference' value='"+e+"'/>"),wc_payex_checkout.onSubmit()},isInstantCheckout:()=>WC_Gateway_PayEx_Checkout.instant_checkout,isCheckinEnabled:()=>WC_Gateway_PayEx_Checkout.checkin,isPaymentMethodChosen:function(){return $("#payment_method_payex_checkout").is(":checked")},block:function(){1!==wc_payex_checkout.form.data()["blockUI.isBlocked"]&&wc_payex_checkout.form.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblock:function(){wc_payex_checkout.form.unblock()},onClose:function(){wc_payex_checkout.unblock()},onReady:function(){console.log("Ready")},onUpdateCheckout:function(){if(console.log("onUpdateCheckout"),!wc_payex_checkout.isInstantCheckout())return!1},onUpdatedCheckout:function(){return console.log("onUpdatedCheckout"),!!wc_payex_checkout.isInstantCheckout()&&(!wc_payex_checkout.form.is(".processing")&&(wc_payex_checkout.validateForm()?(wc_payex_checkout.xhr&&wc_payex_checkout.xhr.abort(),$(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),wc_payex_checkout.form.addClass("processing"),wc_payex_checkout.block(),void(wc_payex_checkout.xhr=wc_payex_checkout.updateOrder().always(function(e){wc_payex_checkout.form.removeClass("processing"),wc_payex_checkout.unblock()}).fail(function(e,o){console.log("updateOrder error:"+o),wc_payex_checkout.onError(o)}).done(function(e){if(console.log(e),this.xhr=!1,"success"!==e.result)return!0===e.result.reload?void window.location.reload():(!0===e.result.refresh&&$(document.body).trigger("update_checkout"),void wc_payex_checkout.onError(e.messages));wc_payex_checkout.js_url=e.js_url,wc_payex_checkout.refreshPaymentMenu()}))):(console.log("onUpdatedCheckout: Validation is failed"),!1)))},onSubmit:function(e){return!!wc_payex_checkout.form_submit||(!wc_payex_checkout.isPaymentMethodChosen()||(void 0!==e&&e.preventDefault(),!!wc_payex_checkout.validateForm()&&(console.log("onSubmit"),!wc_payex_checkout.form.is(".processing")&&($(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),wc_payex_checkout.form.addClass("processing"),wc_payex_checkout.block(),wc_payex_checkout.placeOrder().always(function(e){wc_payex_checkout.form.removeClass("processing"),wc_payex_checkout.unblock()}).fail(function(e,o){wc_payex_checkout.onError(o)}).done(function(e){if(console.log(e),"success"!==e.result)return!0===e.result.reload?void window.location.reload():(!0===e.result.refresh&&$(document.body).trigger("update_checkout"),void wc_payex_checkout.onError(e.messages));wc_payex_checkout.js_url=e.js_url,wc_payex_checkout.initPaymentJS(wc_payex_checkout.js_url)}),!1))))},resetCheckout:function(){wc_payex_checkout.form_submit=!1},validateForm:function(){var e,o=!0;return(e=$("#ship-to-different-address-checkbox").is(":checked")?$(".woocommerce-billing-fields .validate-required, .woocommerce-shipping-fields .validate-required").find("input, select").not($("#account_password, #account_username")):$(".woocommerce-billing-fields .validate-required").find("input, select").not($("#account_password, #account_username"))).length&&e.each(function(){var e=$(this),c=e.closest(".form-row"),t=c.is(".validate-required"),n=c.is(".validate-email");(t&&("checkbox"!==e.attr("type")||e.is(":checked")?""===e.val()&&(o=!1):o=!1),n)&&(e.val()&&(new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i).test(e.val())||(o=!1)))}),o},waitForLoading:function(var_string,callback){try{var obj=eval(var_string)}catch(e){return void callback(e)}let attempts=0,timer=window.setInterval(function(){void 0!==obj?(window.clearInterval(timer),callback(null,obj)):++attempts>=120&&(window.clearInterval(timer),callback("Timeout"))},500)},loadJs:function(e,o){console.log("Loading of "+e);let c=document.createElement("script");c.setAttribute("src",e),c.setAttribute("type","text/javascript"),c.setAttribute("async",""),c.addEventListener("load",function(){console.log("Loaded: "+e),o()},!1);let t=document.getElementsByTagName("head")[0];return t&&t.appendChild(c),c},initPaymentJS:function(e,o){void 0===o&&(o=function(){}),wc_payex_checkout.loadJs(e,function(){$("#payment-payex-checkout iframe").remove(),wc_payex_checkout.isInstantCheckout()?($("#payment").hide(),wc_payex_checkout.initPaymentMenu("payment-payex-checkout")):$.featherlight('<div id="payex-paymentmenu">&nbsp;</div>',{variant:"featherlight-payex",persist:!0,closeOnClick:!1,closeOnEsc:!1,afterOpen:function(){wc_payex_checkout.initPaymentMenu("payex-paymentmenu")},afterClose:function(){wc_payex_checkout.form.removeClass("processing").unblock()}}),o()})},initPaymentMenu:function(e){console.log("initPaymentMenu"),this.paymentMenu=window.payex.hostedView.paymentMenu({container:e,culture:WC_Gateway_PayEx_Checkout.culture,style:WC_Gateway_PayEx_Checkout.paymentMenuStyle?JSON.parse(WC_Gateway_PayEx_Checkout.paymentMenuStyle):null,onPaymentMenuInstrumentSelected:function(e){console.log("onPaymentMenuInstrumentSelected"),console.log(e),wc_payex_checkout.onPaymentMenuInstrumentSelected(e.name,e.instrument)},onPaymentCreated:function(){console.log("onPaymentCreated")},onPaymentCompleted:function(e){console.log("onPaymentCompleted"),console.log(e),self.location.href=e.redirectUrl},onPaymentCanceled:function(e){console.log("onPaymentCanceled"),console.log(e),wc_payex_checkout.logError("payment-menu-cancel",e)},onPaymentFailed:function(e){console.log("onPaymentFailed"),console.log(e),wc_payex_checkout.logError("payment-menu-failed",e)},onError:function(e){wc_payex_checkout.logError("payment-menu-error",e)}}),this.paymentMenu.open()},refreshPaymentMenu:function(){console.log("refreshPaymentMenu"),void 0!==this.paymentMenu?this.paymentMenu.refresh():(console.warn("refreshPaymentMenu: refresh workaround"),wc_payex_checkout.initPaymentJS(wc_payex_checkout.js_url))},placeOrder:function(){console.log("placeOrder");let e=$(".woocommerce-checkout").serialize();return $.ajax({type:"POST",url:WC_Gateway_PayEx_Checkout.ajax_url,data:{action:"payex_place_order",nonce:WC_Gateway_PayEx_Checkout.nonce,data:e},dataType:"json"}).done(function(e){e.hasOwnProperty("result")&&"failure"===e.result&&wc_payex_checkout.logError("payex-place-order",e)})},updateOrder:function(){console.log("updateOrder");let e=$(".woocommerce-checkout").serialize();return $.ajax({type:"POST",url:WC_Gateway_PayEx_Checkout.ajax_url,data:{action:"payex_update_order",nonce:WC_Gateway_PayEx_Checkout.nonce,data:e},dataType:"json"}).done(function(e){e.hasOwnProperty("result")&&"failure"===e.result&&(e.messages.indexOf("Order update is not available.")>-1&&(console.warn("refreshPaymentMenu: refresh workaround. Force reload."),wc_payex_checkout.initPaymentJS(wc_payex_checkout.js_url)),wc_payex_checkout.logError("payex-update-order",e))})},onConsumerIdentified:function(e){return console.log("onConsumerIdentified",e),$("#change-shipping-info").show(),$.ajax({type:"POST",url:WC_Gateway_PayEx_Checkout.ajax_url,data:{action:"payex_checkout_customer_profile",nonce:WC_Gateway_PayEx_Checkout.nonce,consumerProfileRef:e.consumerProfileRef},dataType:"json"}).always(function(e){}).done(function(o){console.log(o),o.success?wc_payex_checkout.initCheckout(e.consumerProfileRef):alert(o.data.message)})},onAddressDetailsAvailable:function(e,o){return console.log("onAddressDetailsAvailable",e,o),$("#change-shipping-info").show(),$.ajax({type:"POST",url:WC_Gateway_PayEx_Checkout.ajax_url,data:{action:"payex_checkout_get_address",nonce:WC_Gateway_PayEx_Checkout.nonce,type:e,url:o.url},dataType:"json"}).always(function(e){}).done(function(o){if(console.log(o),!o.success)return wc_payex_checkout.logError("payex-address-details",o),void alert(o.data.message);let c=o.data;$.each(c,function(o,c){[e].forEach(function(e){let t=$('input[name="'+e+"_"+o+'"]');if(0!==t.length&&(t.prop("readonly",!1),t.closest(".form-row").removeClass("payex-locked"),t.val(c).change(),"country"===o||"state"===o)){let t=$("#"+e+"_"+o);void 0!==window.Select2?t.select2("val",c):void 0!==$.fn.chosen?t.val(c).trigger("chosen:updated"):t.change()}})}),$(document.body).trigger("update_checkout")})},onPaymentMenuInstrumentSelected:function(e,o){console.log("onPaymentMenuInstrumentSelected",e,o)},logError:function(e,o){return console.warn(o),$.ajax({type:"POST",url:WC_Gateway_PayEx_Checkout.ajax_url,data:{action:"payex_checkout_log_error",nonce:WC_Gateway_PayEx_Checkout.nonce,id:e,data:JSON.stringify(o)},dataType:"json"})},onError:function(e){console.log("onError",e)},submit_error:function(e){$(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),wc_payex_checkout.form.prepend('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout">'+e+"</div>"),wc_payex_checkout.form.removeClass("processing").unblock(),wc_payex_checkout.form.find(".input-text, select, input:checkbox").trigger("validate").blur(),wc_payex_checkout.scroll_to_notices(),$(document.body).trigger("checkout_error")},scroll_to_notices:function(){let e=$(".woocommerce-NoticeGroup-updateOrderReview, .woocommerce-NoticeGroup-checkout");e.length||(e=$(".form.checkout")),$.scroll_to_notices(e)},hideAddressFields:function(){$(".woocommerce-billing-fields__field-wrapper, .woocommerce-shipping-fields").hide()},showAddressFields:function(){$(".woocommerce-billing-fields__field-wrapper, .woocommerce-shipping-fields").show()}},$(document).ready(function(){wc_payex_checkout.init($("form.checkout, form#order_review, form#add_payment_method"))})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNoZWNrb3V0LmpzIl0sIm5hbWVzIjpbImpRdWVyeSIsIiQiLCJ3aW5kb3ciLCJ3Y19wYXlleF9jaGVja291dCIsImpzX3VybCIsInhociIsImluaXQiLCJmb3JtIiwidGhpcyIsImZvcm1fc3VibWl0Iiwib24iLCJvblN1Ym1pdCIsImRvY3VtZW50IiwiYm9keSIsImJpbmQiLCJvblVwZGF0ZUNoZWNrb3V0IiwicmVzZXRDaGVja291dCIsIm9uVXBkYXRlZENoZWNrb3V0IiwiaGlkZSIsInNob3dBZGRyZXNzRmllbGRzIiwiaXNJbnN0YW50Q2hlY2tvdXQiLCJpbml0SW5zdGFudENoZWNrb3V0IiwiY29uc29sZSIsImxvZyIsImlzQ2hlY2tpbkVuYWJsZWQiLCJjb25zdW1lclByb2ZpbGVFbG0iLCJsZW5ndGgiLCJyZWZlcmVuY2UiLCJkYXRhIiwiaW5pdENoZWNrb3V0IiwiaW5pdENoZWNrSW4iLCJwYXlleCIsIndhaXRGb3JMb2FkaW5nIiwiZXJyIiwid2FybiIsImhvc3RlZFZpZXciLCJjb25zdW1lciIsImNvbnRhaW5lciIsImN1bHR1cmUiLCJXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0Iiwic3R5bGUiLCJjaGVja0luU3R5bGUiLCJKU09OIiwicGFyc2UiLCJvbkNvbnN1bWVySWRlbnRpZmllZCIsIm9uQmlsbGluZ0RldGFpbHNBdmFpbGFibGUiLCJvbkFkZHJlc3NEZXRhaWxzQXZhaWxhYmxlIiwib25TaGlwcGluZ0RldGFpbHNBdmFpbGFibGUiLCJvbkVycm9yIiwibG9nRXJyb3IiLCJhbGVydCIsImRldGFpbHMiLCJvcGVuIiwic2hvdyIsImZpbmQiLCJyZW1vdmUiLCJhcHBlbmQiLCJpbnN0YW50X2NoZWNrb3V0IiwiY2hlY2tpbiIsImlzUGF5bWVudE1ldGhvZENob3NlbiIsImlzIiwiYmxvY2siLCJtZXNzYWdlIiwib3ZlcmxheUNTUyIsImJhY2tncm91bmQiLCJvcGFjaXR5IiwidW5ibG9jayIsIm9uQ2xvc2UiLCJvblJlYWR5IiwidmFsaWRhdGVGb3JtIiwiYWJvcnQiLCJhZGRDbGFzcyIsInVwZGF0ZU9yZGVyIiwiYWx3YXlzIiwicmVzcG9uc2UiLCJyZW1vdmVDbGFzcyIsImZhaWwiLCJqcVhIUiIsInRleHRTdGF0dXMiLCJkb25lIiwicmVzdWx0IiwicmVsb2FkIiwibG9jYXRpb24iLCJyZWZyZXNoIiwidHJpZ2dlciIsIm1lc3NhZ2VzIiwicmVmcmVzaFBheW1lbnRNZW51IiwiZSIsInByZXZlbnREZWZhdWx0IiwicGxhY2VPcmRlciIsImluaXRQYXltZW50SlMiLCIkcmVxdWlyZWRfaW5wdXRzIiwidmFsaWRhdGVkIiwibm90IiwiZWFjaCIsIiR0aGlzIiwiJHBhcmVudCIsImNsb3Nlc3QiLCJ2YWxpZGF0ZV9yZXF1aXJlZCIsInZhbGlkYXRlX2VtYWlsIiwiYXR0ciIsInZhbCIsIlJlZ0V4cCIsInRlc3QiLCJ2YXJfc3RyaW5nIiwiY2FsbGJhY2siLCJvYmoiLCJldmFsIiwiYXR0ZW1wdHMiLCJ0aW1lciIsInNldEludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsImxvYWRKcyIsImpzIiwic2NyaXB0IiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJvSGVhZCIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiYXBwZW5kQ2hpbGQiLCJ1cmwiLCJpbml0UGF5bWVudE1lbnUiLCJmZWF0aGVybGlnaHQiLCJ2YXJpYW50IiwicGVyc2lzdCIsImNsb3NlT25DbGljayIsImNsb3NlT25Fc2MiLCJhZnRlck9wZW4iLCJhZnRlckNsb3NlIiwiaWQiLCJwYXltZW50TWVudSIsInBheW1lbnRNZW51U3R5bGUiLCJvblBheW1lbnRNZW51SW5zdHJ1bWVudFNlbGVjdGVkIiwibmFtZSIsImluc3RydW1lbnQiLCJvblBheW1lbnRDcmVhdGVkIiwib25QYXltZW50Q29tcGxldGVkIiwic2VsZiIsImhyZWYiLCJyZWRpcmVjdFVybCIsIm9uUGF5bWVudENhbmNlbGVkIiwib25QYXltZW50RmFpbGVkIiwiZmllbGRzIiwic2VyaWFsaXplIiwiYWpheCIsInR5cGUiLCJhamF4X3VybCIsImFjdGlvbiIsIm5vbmNlIiwiZGF0YVR5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImluZGV4T2YiLCJjb25zdW1lclByb2ZpbGVSZWYiLCJzdWNjZXNzIiwia2V5IiwidmFsdWUiLCJmb3JFYWNoIiwic2VjdGlvbiIsImVsIiwicHJvcCIsImNoYW5nZSIsImVsMSIsIlNlbGVjdDIiLCJzZWxlY3QyIiwiZm4iLCJjaG9zZW4iLCJzdHJpbmdpZnkiLCJzdWJtaXRfZXJyb3IiLCJlcnJvcl9tZXNzYWdlIiwicHJlcGVuZCIsImJsdXIiLCJzY3JvbGxfdG9fbm90aWNlcyIsInNjcm9sbEVsZW1lbnQiLCJoaWRlQWRkcmVzc0ZpZWxkcyIsInJlYWR5Il0sIm1hcHBpbmdzIjoiQUFDQUEsT0FBUSxTQUFVQyxHQUNkLGFBS0FDLE9BQU9DLGtCQUFvQixDQUN2QkMsT0FBUSxLQUNSQyxLQUFLLEVBS0xDLEtBQU0sU0FBVUMsR0FDWkMsS0FBS0QsS0FBZUEsRUFDcEJDLEtBQUtDLGFBQWUsRUFFcEJSLEVBQUdPLEtBQUtELE1BR0hHLEdBQUksUUFBUyxlQUFnQkYsS0FBS0csVUFHbENELEdBQUksOENBRVRULEVBQUdXLFNBQVNDLE1BQU9DLEtBQU0sa0JBQW1CTixLQUFLTyxrQkFDakRkLEVBQUdXLFNBQVNDLE1BQU9ILEdBQUksaUJBQWtCRixLQUFLUSxlQUM5Q2YsRUFBR1csU0FBU0MsTUFBT0gsR0FBSSxtQkFBb0JGLEtBQUtTLG1CQUNoRGhCLEVBQUdXLFNBQVNDLE1BQU9ILEdBQUksT0FBUUYsS0FBS1MsbUJBRXBDaEIsRUFBR1csU0FBU0MsTUFBT0gsR0FBSSxRQUFTLHdCQUF5QixXQUVyRFQsRUFBRyx5QkFBMEJpQixPQUc3QmYsa0JBQWtCZ0Isc0JBSWpCaEIsa0JBQWtCaUIscUJBQ25CakIsa0JBQWtCa0IsdUJBTzFCQSxvQkFBcUIsV0FDakJDLFFBQVFDLElBQUsseUNBSVJwQixrQkFBa0JxQixtQkFLdkIsSUFBSUMsRUFBcUJ4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SUQsY0FNcEJoSyxFQUFHVyxTQUFTQyxNQUFPdUUsUUFBUyxzQkFTcENpRCxnQ0FBaUMsU0FBV0MsRUFBTUMsR0FDOUNqSCxRQUFRQyxJQUFLLGtDQUFtQytHLEVBQU1DLElBVTFEdEYsU0FBVSxTQUFXaUYsRUFBSXRHLEdBR3JCLE9BRkFOLFFBQVFZLEtBQU1OLEdBRVAzQixFQUFFZ0osS0FBTSxDQUNYQyxLQUFNLE9BQ056QixJQUFLbEYsMEJBQTBCNEcsU0FDL0J2SCxLQUFNLENBQ0Z3SCxPQUFRLDJCQUNSQyxNQUFPOUcsMEJBQTBCOEcsTUFDakNuQixHQUFJQSxFQUNKdEcsS0FBTWMsS0FBSzZILFVBQVczSSxJQUUxQjBILFNBQVUsVUFJbEJ0RyxRQUFTLFNBQVdwQixHQUNoQk4sUUFBUUMsSUFBSyxVQUFXSyxJQUc1QjRJLGFBQWMsU0FBVUMsR0FDcEJ4SyxFQUFHLCtFQUFnRnNELFNBQ25GcEQsa0JBQWtCSSxLQUFLbUssUUFBUyx5RUFBMkVELEVBQWdCLFVBQzNIdEssa0JBQWtCSSxLQUFLb0UsWUFBYSxjQUFlVCxVQUNuRC9ELGtCQUFrQkksS0FBSytDLEtBQU0sdUNBQXdDOEIsUUFBUyxZQUFhdUYsT0FDM0Z4SyxrQkFBa0J5SyxvQkFDbEIzSyxFQUFHVyxTQUFTQyxNQUFPdUUsUUFBUyxtQkFFaEN3RixrQkFBbUIsV0FDZixJQUFJQyxFQUFnQjVLLEVBQUcsaUZBQ2hCNEssRUFBY25KLFNBQ2pCbUosRUFBZ0I1SyxFQUFHLG1CQUd2QkEsRUFBRTJLLGtCQUFtQkMsSUFFekJDLGtCQUFtQixXQUNmN0ssRUFBRyw0RUFBNkVpQixRQUVwRkMsa0JBQW1CLFdBQ2ZsQixFQUFHLDRFQUE2RW9ELFNBSXhGcEQsRUFBRVcsVUFBVW1LLE1BQU8sV0FDZjVLLGtCQUFrQkcsS0FBTUwsRUFBRyIsImZpbGUiOiJjaGVja291dC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBnbG9iYWwgd2NfY2hlY2tvdXRfcGFyYW1zICovXG5qUXVlcnkoIGZ1bmN0aW9uKCAkICkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIC8qKlxuICAgICAqIE9iamVjdCB0byBoYW5kbGUgUGF5RXggY2hlY2tvdXQgcGF5bWVudCBmb3Jtcy5cbiAgICAgKi9cbiAgICB3aW5kb3cud2NfcGF5ZXhfY2hlY2tvdXQgPSB7XG4gICAgICAgIGpzX3VybDogbnVsbCxcbiAgICAgICAgeGhyOiBmYWxzZSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogSW5pdGlhbGl6ZSBlIGhhbmRsZXJzIGFuZCBVSSBzdGF0ZS5cbiAgICAgICAgICovXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCBmb3JtICkge1xuICAgICAgICAgICAgdGhpcy5mb3JtICAgICAgICAgPSBmb3JtO1xuICAgICAgICAgICAgdGhpcy5mb3JtX3N1Ym1pdCAgPSBmYWxzZTtcblxuICAgICAgICAgICAgJCggdGhpcy5mb3JtIClcbiAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gYmluZCBkaXJlY3RseSB0byB0aGUgY2xpY2sgKGFuZCBub3QgY2hlY2tvdXRfcGxhY2Vfb3JkZXJfcGF5ZXhfY2hlY2tvdXQpIHRvIGF2b2lkIHBvcHVwIGJsb2NrZXJzXG4gICAgICAgICAgICAvLyBlc3BlY2lhbGx5IG9uIG1vYmlsZSBkZXZpY2VzIChsaWtlIG9uIENocm9tZSBmb3IgaU9TKSBmcm9tIGJsb2NraW5nIHBheWV4X2NoZWNrb3V0KHBheW1lbnRfaWQsIHt9LCAnb3BlbicpOyBmcm9tIG9wZW5pbmcgYSB0YWJcbiAgICAgICAgICAgICAgICAub24oICdjbGljaycsICcjcGxhY2Vfb3JkZXInLCB0aGlzLm9uU3VibWl0IClcblxuICAgICAgICAgICAgICAgIC8vIFdvb0NvbW1lcmNlIGxldHMgdXMgcmV0dXJuIGEgZmFsc2Ugb24gY2hlY2tvdXRfcGxhY2Vfb3JkZXJfe2dhdGV3YXl9IHRvIGtlZXAgdGhlIGZvcm0gZnJvbSBzdWJtaXR0aW5nXG4gICAgICAgICAgICAgICAgLm9uKCAnc3VibWl0IGNoZWNrb3V0X3BsYWNlX29yZGVyX3BheWV4X2NoZWNrb3V0JyApO1xuXG4gICAgICAgICAgICAkKCBkb2N1bWVudC5ib2R5ICkuYmluZCggJ3VwZGF0ZV9jaGVja291dCcsIHRoaXMub25VcGRhdGVDaGVja291dCApO1xuICAgICAgICAgICAgJCggZG9jdW1lbnQuYm9keSApLm9uKCAnY2hlY2tvdXRfZXJyb3InLCB0aGlzLnJlc2V0Q2hlY2tvdXQgKTtcbiAgICAgICAgICAgICQoIGRvY3VtZW50LmJvZHkgKS5vbiggJ3VwZGF0ZWRfY2hlY2tvdXQnLCB0aGlzLm9uVXBkYXRlZENoZWNrb3V0ICk7XG4gICAgICAgICAgICAkKCBkb2N1bWVudC5ib2R5ICkub24oICdibHVyJywgdGhpcy5vblVwZGF0ZWRDaGVja291dCApO1xuXG4gICAgICAgICAgICAkKCBkb2N1bWVudC5ib2R5ICkub24oICdjbGljaycsICcjY2hhbmdlLXNoaXBwaW5nLWluZm8nLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gSGlkZSBcIkNoYW5nZSBzaGlwcGluZyBpbmZvXCIgYnV0dG9uXG4gICAgICAgICAgICAgICAgJCggJyNjaGFuZ2Utc2hpcHBpbmctaW5mbycgKS5oaWRlKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBTaG93IEFkZHJlc3MgRmllbGRzXG4gICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuc2hvd0FkZHJlc3NGaWVsZHMoKTtcbiAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSBJbnN0YW50IENoZWNrb3V0XG4gICAgICAgICAgICBpZiAoIHdjX3BheWV4X2NoZWNrb3V0LmlzSW5zdGFudENoZWNrb3V0KCkgKSB7XG4gICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuaW5pdEluc3RhbnRDaGVja291dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbml0aWFsaXplIEluc3RhbnQgQ2hlY2tvdXRcbiAgICAgICAgICovXG4gICAgICAgIGluaXRJbnN0YW50Q2hlY2tvdXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnSW5pdGlhbGl6YXRpb24gb2YgSW5zdGFudCBDaGVja291dC4uLicgKTtcblxuICAgICAgICAgXHQvLyQoIGRvY3VtZW50LmJvZHkgKS5iaW5kKCAnaW5pdF9jaGVja291dCcsIHRoaXMuaW5pdF9jaGVja291dCApO1xuXG4gICAgICAgICAgICBpZiAoIHdjX3BheWV4X2NoZWNrb3V0LmlzQ2hlY2tpbkVuYWJsZWQoKSApIHtcbiAgICAgICAgICAgICAgICAvL3djX3BheWV4X2NoZWNrb3V0LmhpZGVBZGRyZXNzRmllbGRzKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFVzZSBzYXZlZCBjb25zdW1lclByb2ZpbGVSZWZcbiAgICAgICAgICAgIGxldCBjb25zdW1lclByb2ZpbGVFbG0gPSAkKCAnI3BheWV4LWNvbnN1bWVyLXByb2ZpbGUnICk7XG4gICAgICAgICAgICBpZiAoIGNvbnN1bWVyUHJvZmlsZUVsbS5sZW5ndGggPiAwICkge1xuICAgICAgICAgICAgICAgIGxldCByZWZlcmVuY2UgPSBjb25zdW1lclByb2ZpbGVFbG0uZGF0YSggJ3JlZmVyZW5jZScgKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ0luaXRpYXRlIGNvbnN1bWVyUHJvZmlsZVJlZicsIHJlZmVyZW5jZSApO1xuICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmluaXRDaGVja291dCggcmVmZXJlbmNlICk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEluaXRpYXRlIGNoZWNraW5cblxuICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmluaXRDaGVja0luKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluaXRpYWxpemUgQ2hlY2tJblxuICAgICAgICAgKi9cbiAgICAgICAgaW5pdENoZWNrSW46IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKCB0eXBlb2YgcGF5ZXggPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC53YWl0Rm9yTG9hZGluZygncGF5ZXguaG9zdGVkVmlldy5jb25zdW1lcicsIGZ1bmN0aW9uICggZXJyICkge1xuICAgICAgICAgICAgICAgIGlmICggZXJyICkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oIGVyciApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gSW5pdCBQYXlFeCBob3N0ZWRWaWV3XG4gICAgICAgICAgICAgICAgd2luZG93LnBheWV4Lmhvc3RlZFZpZXcuY29uc3VtZXIoIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyOiAncGF5ZXgtY2hlY2tpbicsXG4gICAgICAgICAgICAgICAgICAgIGN1bHR1cmU6IFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQuY3VsdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU6IFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQuY2hlY2tJblN0eWxlID8gSlNPTi5wYXJzZSggV0NfR2F0ZXdheV9QYXlFeF9DaGVja291dC5jaGVja0luU3R5bGUgKSA6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIG9uQ29uc3VtZXJJZGVudGlmaWVkOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnaG9zdGVkVmlldzogb25Db25zdW1lcklkZW50aWZpZWQnICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5vbkNvbnN1bWVySWRlbnRpZmllZCggZGF0YSApO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvbkJpbGxpbmdEZXRhaWxzQXZhaWxhYmxlOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0Lm9uQWRkcmVzc0RldGFpbHNBdmFpbGFibGUoICdiaWxsaW5nJywgZGF0YSApO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvblNoaXBwaW5nRGV0YWlsc0F2YWlsYWJsZTogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5vbkFkZHJlc3NEZXRhaWxzQXZhaWxhYmxlKCAnc2hpcHBpbmcnLCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uICggZGF0YSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmxvZ0Vycm9yKCAncGF5ZXgtY2hlY2tpbicsIGRhdGEgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCBkYXRhLmRldGFpbHMgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vd2NfcGF5ZXhfY2hlY2tvdXQub25FcnJvciggZGF0YS5kZXRhaWxzICk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICkub3BlbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5pdENoZWNrb3V0OiBmdW5jdGlvbiggcmVmZXJlbmNlICkge1xuICAgICAgICAgICAgLy8gU2hvdyBcIkNoYW5nZSBzaGlwcGluZyBpbmZvXCIgYnV0dG9uXG4gICAgICAgICAgICAkKCAnI2NoYW5nZS1zaGlwcGluZy1pbmZvJyApLnNob3coKTtcblxuICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuZm9ybS5maW5kKCAnLnBheWV4X2N1c3RvbWVyX3JlZmVyZW5jZScgKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmZvcm0uYXBwZW5kKCBcIjxpbnB1dCB0eXBlPSdoaWRkZW4nIGNsYXNzPSdwYXlleF9jdXN0b21lcl9yZWZlcmVuY2UnIG5hbWU9J3BheWV4X2N1c3RvbWVyX3JlZmVyZW5jZScgdmFsdWU9J1wiICsgcmVmZXJlbmNlICsgXCInLz5cIiApO1xuXG4gICAgICAgICAgICAvL3djX3BheWV4X2NoZWNrb3V0LmZvcm0uc3VibWl0KCk7XG4gICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5vblN1Ym1pdCgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGlzSW5zdGFudENoZWNrb3V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQuaW5zdGFudF9jaGVja291dDtcbiAgICAgICAgfSxcblxuICAgICAgICBpc0NoZWNraW5FbmFibGVkKCkge1xuICAgICAgICAgICAgcmV0dXJuIFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQuY2hlY2tpbjtcbiAgICAgICAgfSxcblxuICAgICAgICBpc1BheW1lbnRNZXRob2RDaG9zZW46IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuICQoICcjcGF5bWVudF9tZXRob2RfcGF5ZXhfY2hlY2tvdXQnICkuaXMoICc6Y2hlY2tlZCcgKTtcbiAgICAgICAgfSxcblxuICAgICAgICBibG9jazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBsZXQgZm9ybV9kYXRhID0gd2NfcGF5ZXhfY2hlY2tvdXQuZm9ybS5kYXRhKCk7XG4gICAgICAgICAgICBpZiAoIDEgIT09IGZvcm1fZGF0YVsnYmxvY2tVSS5pc0Jsb2NrZWQnXSApIHtcbiAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5mb3JtLmJsb2NrKHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgb3ZlcmxheUNTUzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogJyNmZmYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMC42XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICB1bmJsb2NrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmZvcm0udW5ibG9jaygpO1xuICAgICAgICB9LFxuXG4gICAgICAgIG9uQ2xvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQudW5ibG9jaygpO1xuICAgICAgICB9LFxuXG4gICAgICAgIG9uUmVhZHk6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coICdSZWFkeScgKTtcbiAgICAgICAgfSxcblxuICAgICAgICBvblVwZGF0ZUNoZWNrb3V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25VcGRhdGVDaGVja291dCcgKTtcblxuICAgICAgICAgICAgaWYgKCAhIHdjX3BheWV4X2NoZWNrb3V0LmlzSW5zdGFudENoZWNrb3V0KCkgKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBAdG9kb1xuICAgICAgICB9LFxuXG4gICAgICAgIG9uVXBkYXRlZENoZWNrb3V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25VcGRhdGVkQ2hlY2tvdXQnICk7XG5cbiAgICAgICAgICAgIGlmICggISB3Y19wYXlleF9jaGVja291dC5pc0luc3RhbnRDaGVja291dCgpICkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCB3Y19wYXlleF9jaGVja291dC5mb3JtLmlzKCAnLnByb2Nlc3NpbmcnICkgKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoICEgd2NfcGF5ZXhfY2hlY2tvdXQudmFsaWRhdGVGb3JtKCkgKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coICdvblVwZGF0ZWRDaGVja291dDogVmFsaWRhdGlvbiBpcyBmYWlsZWQnICk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIHdjX3BheWV4X2NoZWNrb3V0LnhociApIHtcbiAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC54aHIuYWJvcnQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJCggJy53b29jb21tZXJjZS1Ob3RpY2VHcm91cC1jaGVja291dCwgLndvb2NvbW1lcmNlLWVycm9yLCAud29vY29tbWVyY2UtbWVzc2FnZScgKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmZvcm0uYWRkQ2xhc3MoICdwcm9jZXNzaW5nJyApO1xuICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuYmxvY2soKTtcblxuICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQueGhyID0gd2NfcGF5ZXhfY2hlY2tvdXQudXBkYXRlT3JkZXIoKVxuICAgICAgICAgICAgICAgIC5hbHdheXMoIGZ1bmN0aW9uICggcmVzcG9uc2UgKSB7XG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmZvcm0ucmVtb3ZlQ2xhc3MoICdwcm9jZXNzaW5nJyApO1xuICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC51bmJsb2NrKCk7XG4gICAgICAgICAgICAgICAgfSApXG4gICAgICAgICAgICAgICAgLmZhaWwoIGZ1bmN0aW9uKCBqcVhIUiwgdGV4dFN0YXR1cyApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coICd1cGRhdGVPcmRlciBlcnJvcjonICsgdGV4dFN0YXR1cyApO1xuICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5vbkVycm9yKCB0ZXh0U3RhdHVzICk7XG4gICAgICAgICAgICAgICAgfSApXG4gICAgICAgICAgICAgICAgLmRvbmUoIGZ1bmN0aW9uICggcmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIHJlc3BvbnNlICk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMueGhyID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnJlc3VsdCAhPT0gJ3N1Y2Nlc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWxvYWQgcGFnZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0cnVlID09PSByZXNwb25zZS5yZXN1bHQucmVsb2FkICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgdXBkYXRlIGluIGNhc2Ugd2UgbmVlZCBhIGZyZXNoIG5vbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIHRydWUgPT09IHJlc3BvbnNlLnJlc3VsdC5yZWZyZXNoICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIGRvY3VtZW50LmJvZHkgKS50cmlnZ2VyKCAndXBkYXRlX2NoZWNrb3V0JyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5vbkVycm9yKCByZXNwb25zZS5tZXNzYWdlcyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy93Y19wYXlleF9jaGVja291dC5mb3JtLnN1Ym1pdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVmcmVzaCBQYXltZW50IE1lbnVcbiAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuanNfdXJsID0gcmVzcG9uc2VbJ2pzX3VybCddO1xuICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5yZWZyZXNoUGF5bWVudE1lbnUoKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBMb2FkIFBheUV4IENoZWNrb3V0IGZyYW1lXG4gICAgICAgICAgICAgICAgICAgIC8vd2NfcGF5ZXhfY2hlY2tvdXQuaW5pdFBheW1lbnRKUyggcmVzcG9uc2VbJ2pzX3VybCddIClcbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgb25TdWJtaXQ6IGZ1bmN0aW9uKCBlICkge1xuICAgICAgICAgICAgaWYgKCB3Y19wYXlleF9jaGVja291dC5mb3JtX3N1Ym1pdCApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCB3Y19wYXlleF9jaGVja291dC5pc1BheW1lbnRNZXRob2RDaG9zZW4oKSApIHtcbiAgICAgICAgICAgICAgICBpZiAoIHR5cGVvZiBlICE9PSAndW5kZWZpbmVkJyApIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICggISB3Y19wYXlleF9jaGVja291dC52YWxpZGF0ZUZvcm0oKSApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25TdWJtaXQnICk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIHdjX3BheWV4X2NoZWNrb3V0LmZvcm0uaXMoICcucHJvY2Vzc2luZycgKSApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICQoICcud29vY29tbWVyY2UtTm90aWNlR3JvdXAtY2hlY2tvdXQsIC53b29jb21tZXJjZS1lcnJvciwgLndvb2NvbW1lcmNlLW1lc3NhZ2UnICkucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuZm9ybS5hZGRDbGFzcyggJ3Byb2Nlc3NpbmcnICk7XG4gICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuYmxvY2soKTtcbiAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5wbGFjZU9yZGVyKClcbiAgICAgICAgICAgICAgICAgICAgLmFsd2F5cyggZnVuY3Rpb24gKCByZXNwb25zZSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmZvcm0ucmVtb3ZlQ2xhc3MoICdwcm9jZXNzaW5nJyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQudW5ibG9jaygpO1xuICAgICAgICAgICAgICAgICAgICB9IClcbiAgICAgICAgICAgICAgICAgICAgLmZhaWwoIGZ1bmN0aW9uKCBqcVhIUiwgdGV4dFN0YXR1cyApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0Lm9uRXJyb3IoIHRleHRTdGF0dXMgKTtcbiAgICAgICAgICAgICAgICAgICAgfSApXG4gICAgICAgICAgICAgICAgICAgIC5kb25lKCBmdW5jdGlvbiAoIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggcmVzcG9uc2UgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggcmVzcG9uc2UucmVzdWx0ICE9PSAnc3VjY2VzcycgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVsb2FkIHBhZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIHRydWUgPT09IHJlc3BvbnNlLnJlc3VsdC5yZWxvYWQgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgdXBkYXRlIGluIGNhc2Ugd2UgbmVlZCBhIGZyZXNoIG5vbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0cnVlID09PSByZXNwb25zZS5yZXN1bHQucmVmcmVzaCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCggZG9jdW1lbnQuYm9keSApLnRyaWdnZXIoICd1cGRhdGVfY2hlY2tvdXQnICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQub25FcnJvciggcmVzcG9uc2UubWVzc2FnZXMgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIExvYWQgUGF5RXggQ2hlY2tvdXQgZnJhbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmpzX3VybCA9IHJlc3BvbnNlWydqc191cmwnXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmluaXRQYXltZW50SlMoIHdjX3BheWV4X2NoZWNrb3V0LmpzX3VybCApO1xuICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlc2V0Q2hlY2tvdXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuZm9ybV9zdWJtaXQgPSBmYWxzZTtcbiAgICAgICAgfSxcblxuICAgICAgICB2YWxpZGF0ZUZvcm06IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciAkcmVxdWlyZWRfaW5wdXRzLFxuICAgICAgICAgICAgICAgIHZhbGlkYXRlZCA9IHRydWU7XG5cbiAgICAgICAgICAgIC8vIGNoZWNrIHRvIHNlZSBpZiB3ZSBuZWVkIHRvIHZhbGlkYXRlIHNoaXBwaW5nIGFkZHJlc3NcbiAgICAgICAgICAgIGlmICggJCggJyNzaGlwLXRvLWRpZmZlcmVudC1hZGRyZXNzLWNoZWNrYm94JyApLmlzKCAnOmNoZWNrZWQnICkgKSB7XG4gICAgICAgICAgICAgICAgJHJlcXVpcmVkX2lucHV0cyA9ICQoICcud29vY29tbWVyY2UtYmlsbGluZy1maWVsZHMgLnZhbGlkYXRlLXJlcXVpcmVkLCAud29vY29tbWVyY2Utc2hpcHBpbmctZmllbGRzIC52YWxpZGF0ZS1yZXF1aXJlZCcgKS5maW5kKCdpbnB1dCwgc2VsZWN0Jykubm90KCAkKCAnI2FjY291bnRfcGFzc3dvcmQsICNhY2NvdW50X3VzZXJuYW1lJyApICk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRyZXF1aXJlZF9pbnB1dHMgPSAkKCAnLndvb2NvbW1lcmNlLWJpbGxpbmctZmllbGRzIC52YWxpZGF0ZS1yZXF1aXJlZCcgKS5maW5kKCdpbnB1dCwgc2VsZWN0Jykubm90KCAkKCAnI2FjY291bnRfcGFzc3dvcmQsICNhY2NvdW50X3VzZXJuYW1lJyApICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICggJHJlcXVpcmVkX2lucHV0cy5sZW5ndGggKSB7XG4gICAgICAgICAgICAgICAgJHJlcXVpcmVkX2lucHV0cy5lYWNoKCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyICR0aGlzID0gJCggdGhpcyApLFxuICAgICAgICAgICAgICAgICAgICAgICAgJHBhcmVudCAgICAgICAgICAgPSAkdGhpcy5jbG9zZXN0KCAnLmZvcm0tcm93JyApLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVfcmVxdWlyZWQgPSAkcGFyZW50LmlzKCAnLnZhbGlkYXRlLXJlcXVpcmVkJyApLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVfZW1haWwgICAgPSAkcGFyZW50LmlzKCAnLnZhbGlkYXRlLWVtYWlsJyApO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICggdmFsaWRhdGVfcmVxdWlyZWQgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoICdjaGVja2JveCcgPT09ICR0aGlzLmF0dHIoICd0eXBlJyApICYmICEgJHRoaXMuaXMoICc6Y2hlY2tlZCcgKSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoICR0aGlzLnZhbCgpID09PSAnJyApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICggdmFsaWRhdGVfZW1haWwgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoICR0aGlzLnZhbCgpICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzI4NTU4NjUvanF1ZXJ5LXZhbGlkYXRlLWUtbWFpbC1hZGRyZXNzLXJlZ2V4ICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBuZXcgUmVnRXhwKC9eKCgoW2Etel18XFxkfFshI1xcJCUmJ1xcKlxcK1xcLVxcLz1cXD9cXF5fYHtcXHx9fl18W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKyhcXC4oW2Etel18XFxkfFshI1xcJCUmJ1xcKlxcK1xcLVxcLz1cXD9cXF5fYHtcXHx9fl18W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKykqKXwoKFxceDIyKSgoKChcXHgyMHxcXHgwOSkqKFxceDBkXFx4MGEpKT8oXFx4MjB8XFx4MDkpKyk/KChbXFx4MDEtXFx4MDhcXHgwYlxceDBjXFx4MGUtXFx4MWZcXHg3Zl18XFx4MjF8W1xceDIzLVxceDViXXxbXFx4NWQtXFx4N2VdfFtcXHUwMEEwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdKXwoXFxcXChbXFx4MDEtXFx4MDlcXHgwYlxceDBjXFx4MGQtXFx4N2ZdfFtcXHUwMEEwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdKSkpKSooKChcXHgyMHxcXHgwOSkqKFxceDBkXFx4MGEpKT8oXFx4MjB8XFx4MDkpKyk/KFxceDIyKSkpQCgoKFthLXpdfFxcZHxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSl8KChbYS16XXxcXGR8W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKFthLXpdfFxcZHwtfFxcLnxffH58W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKihbYS16XXxcXGR8W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKSlcXC4pKygoW2Etel18W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pfCgoW2Etel18W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKFthLXpdfFxcZHwtfFxcLnxffH58W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKihbYS16XXxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSkpKVxcLj8kL2kpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggISBwYXR0ZXJuLnRlc3QoICR0aGlzLnZhbCgpICApICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHZhbGlkYXRlZDtcbiAgICAgICAgfSxcblxuICAgICAgICB3YWl0Rm9yTG9hZGluZzogZnVuY3Rpb24gKCB2YXJfc3RyaW5nLCBjYWxsYmFjayApIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIG9iaiA9IGV2YWwoIHZhcl9zdHJpbmcgKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayggZSApO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IGF0dGVtcHRzID0gMDtcbiAgICAgICAgICAgIGxldCB0aW1lciA9IHdpbmRvdy5zZXRJbnRlcnZhbCggZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKCB0eXBlb2Ygb2JqICE9PSAndW5kZWZpbmVkJyApIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwoIHRpbWVyICk7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCBudWxsLCBvYmogKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhdHRlbXB0cysrO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIGF0dGVtcHRzID49IDEyMCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKCB0aW1lciApO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soICdUaW1lb3V0JyApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgNTAwICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIExvYWQgSlNcbiAgICAgICAgICogQHBhcmFtIGpzXG4gICAgICAgICAqIEBwYXJhbSBjYWxsYmFja1xuICAgICAgICAgKi9cbiAgICAgICAgbG9hZEpzOiBmdW5jdGlvbiAoIGpzLCBjYWxsYmFjayApIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnTG9hZGluZyBvZiAnICsganMgKTtcbiAgICAgICAgICAgIC8vIENyZWF0ZXMgYSBuZXcgc2NyaXB0IHRhZ1xuICAgICAgICAgICAgbGV0IHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdzY3JpcHQnICk7XG5cbiAgICAgICAgICAgIC8vIFNldCBzY3JpcHQgdGFnIHBhcmFtc1xuICAgICAgICAgICAgc2NyaXB0LnNldEF0dHJpYnV0ZSggJ3NyYycsIGpzICk7XG4gICAgICAgICAgICBzY3JpcHQuc2V0QXR0cmlidXRlKCAndHlwZScsICd0ZXh0L2phdmFzY3JpcHQnICk7XG4gICAgICAgICAgICBzY3JpcHQuc2V0QXR0cmlidXRlKCAnYXN5bmMnLCAnJyApO1xuICAgICAgICAgICAgc2NyaXB0LmFkZEV2ZW50TGlzdGVuZXIoICdsb2FkJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnTG9hZGVkOiAnICsganMgKTtcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgfSwgZmFsc2UgKTtcblxuICAgICAgICAgICAgLy8gR2V0cyBkb2N1bWVudCBoZWFkIGVsZW1lbnRcbiAgICAgICAgICAgIGxldCBvSGVhZCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCAnaGVhZCcgKVswXTtcbiAgICAgICAgICAgIGlmICggb0hlYWQgKSB7XG4gICAgICAgICAgICAgICAgLy8gQWRkIHNjcmlwdCB0YWcgdG8gaGVhZFxuICAgICAgICAgICAgICAgIG9IZWFkLmFwcGVuZENoaWxkKCBzY3JpcHQgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHNjcmlwdDtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogSW5pdGlhdGUgUGF5bWVudCBKYXZhc2NyaXB0XG4gICAgICAgICAqIEBwYXJhbSB1cmxcbiAgICAgICAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAgICAgICAqL1xuICAgICAgICBpbml0UGF5bWVudEpTOiBmdW5jdGlvbiAoIHVybCwgY2FsbGJhY2sgKSB7XG4gICAgICAgICAgICBpZiAoIHR5cGVvZiBjYWxsYmFjayA9PT0gJ3VuZGVmaW5lZCcgKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7fTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQubG9hZEpzKCB1cmwsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkKCAnI3BheW1lbnQtcGF5ZXgtY2hlY2tvdXQgaWZyYW1lJyApLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgLy8gTG9hZCBQYXlFeCBDaGVja291dCBmcmFtZVxuICAgICAgICAgICAgICAgIGlmICggd2NfcGF5ZXhfY2hlY2tvdXQuaXNJbnN0YW50Q2hlY2tvdXQoKSApIHtcbiAgICAgICAgICAgICAgICAgICAgJCgnI3BheW1lbnQnKS5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmluaXRQYXltZW50TWVudSgncGF5bWVudC1wYXlleC1jaGVja291dCcgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkLmZlYXRoZXJsaWdodCggJzxkaXYgaWQ9XCJwYXlleC1wYXltZW50bWVudVwiPiZuYnNwOzwvZGl2PicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ6ICdmZWF0aGVybGlnaHQtcGF5ZXgnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc2lzdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlT25DbGljazogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBjbG9zZU9uRXNjOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyT3BlbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmluaXRQYXltZW50TWVudSgncGF5ZXgtcGF5bWVudG1lbnUnICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXJDbG9zZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmZvcm0ucmVtb3ZlQ2xhc3MoICdwcm9jZXNzaW5nJyApLnVuYmxvY2soKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKClcbiAgICAgICAgICAgIH0gKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogSW5pdGlhdGUgUGF5bWVudCBNZW51LlxuICAgICAgICAgKiBQYXltZW50IEphdmFzY3JpcHQgbXVzdCBiZSBsb2FkZWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSBpZFxuICAgICAgICAgKi9cbiAgICAgICAgaW5pdFBheW1lbnRNZW51OiBmdW5jdGlvbiAoIGlkICkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coICdpbml0UGF5bWVudE1lbnUnICk7XG5cbiAgICAgICAgICAgIC8vIExvYWQgUGF5RXggQ2hlY2tvdXQgZnJhbWVcbiAgICAgICAgICAgIHRoaXMucGF5bWVudE1lbnUgPSB3aW5kb3cucGF5ZXguaG9zdGVkVmlldy5wYXltZW50TWVudSgge1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lcjogaWQsXG4gICAgICAgICAgICAgICAgY3VsdHVyZTogV0NfR2F0ZXdheV9QYXlFeF9DaGVja291dC5jdWx0dXJlLFxuICAgICAgICAgICAgICAgIHN0eWxlOiBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0LnBheW1lbnRNZW51U3R5bGUgPyBKU09OLnBhcnNlKCBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0LnBheW1lbnRNZW51U3R5bGUgKSA6IG51bGwsXG4gICAgICAgICAgICAgICAgb25QYXltZW50TWVudUluc3RydW1lbnRTZWxlY3RlZDogZnVuY3Rpb24gKCBkYXRhICkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uUGF5bWVudE1lbnVJbnN0cnVtZW50U2VsZWN0ZWQnICk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0Lm9uUGF5bWVudE1lbnVJbnN0cnVtZW50U2VsZWN0ZWQoIGRhdGEubmFtZSwgZGF0YS5pbnN0cnVtZW50ICk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvblBheW1lbnRDcmVhdGVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25QYXltZW50Q3JlYXRlZCcgKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9uUGF5bWVudENvbXBsZXRlZDogZnVuY3Rpb24gKCBkYXRhICkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uUGF5bWVudENvbXBsZXRlZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIGRhdGEgKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5sb2NhdGlvbi5ocmVmID0gZGF0YS5yZWRpcmVjdFVybDtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9uUGF5bWVudENhbmNlbGVkOiBmdW5jdGlvbiAoIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25QYXltZW50Q2FuY2VsZWQnICk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmxvZ0Vycm9yKCAncGF5bWVudC1tZW51LWNhbmNlbCcsIGRhdGEgKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9uUGF5bWVudEZhaWxlZDogZnVuY3Rpb24gKCBkYXRhICkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uUGF5bWVudEZhaWxlZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIGRhdGEgKTtcbiAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQubG9nRXJyb3IoICdwYXltZW50LW1lbnUtZmFpbGVkJywgZGF0YSApO1xuICAgICAgICAgICAgICAgICAgICAvL3NlbGYubG9jYXRpb24uaHJlZiA9IGRhdGEucmVkaXJlY3RVcmw7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvbkVycm9yOiBmdW5jdGlvbiAoIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmxvZ0Vycm9yKCAncGF5bWVudC1tZW51LWVycm9yJywgZGF0YSApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgdGhpcy5wYXltZW50TWVudS5vcGVuKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlZnJlc2hcbiAgICAgICAgICovXG4gICAgICAgIHJlZnJlc2hQYXltZW50TWVudTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ3JlZnJlc2hQYXltZW50TWVudScgKTtcbiAgICAgICAgICAgIGlmICggdHlwZW9mIHRoaXMucGF5bWVudE1lbnUgIT09ICd1bmRlZmluZWQnICkge1xuICAgICAgICAgICAgICAgIHRoaXMucGF5bWVudE1lbnUucmVmcmVzaCgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oICdyZWZyZXNoUGF5bWVudE1lbnU6IHJlZnJlc2ggd29ya2Fyb3VuZCcgKTtcbiAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5pbml0UGF5bWVudEpTKCB3Y19wYXlleF9jaGVja291dC5qc191cmwgKVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBQbGFjZSBPcmRlclxuICAgICAgICAgKiBAcmV0dXJuIHtKUXVlcnlQcm9taXNlPGFueT59XG4gICAgICAgICAqL1xuICAgICAgICBwbGFjZU9yZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ3BsYWNlT3JkZXInICk7XG4gICAgICAgICAgICBsZXQgZmllbGRzID0gJCgnLndvb2NvbW1lcmNlLWNoZWNrb3V0Jykuc2VyaWFsaXplKCk7XG5cbiAgICAgICAgICAgIHJldHVybiAkLmFqYXgoIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgdXJsOiBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0LmFqYXhfdXJsLFxuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAncGF5ZXhfcGxhY2Vfb3JkZXInLFxuICAgICAgICAgICAgICAgICAgICBub25jZTogV0NfR2F0ZXdheV9QYXlFeF9DaGVja291dC5ub25jZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogZmllbGRzXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXG4gICAgICAgICAgICB9ICkuZG9uZSggZnVuY3Rpb24gKCByZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5oYXNPd25Qcm9wZXJ0eSgncmVzdWx0JykgJiYgcmVzcG9uc2UucmVzdWx0ID09PSAnZmFpbHVyZScpIHtcbiAgICAgICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQubG9nRXJyb3IoJ3BheWV4LXBsYWNlLW9yZGVyJywgcmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogVXBkYXRlIE9yZGVyXG4gICAgICAgICAqIEByZXR1cm4ge0pRdWVyeVByb21pc2U8YW55Pn1cbiAgICAgICAgICovXG4gICAgICAgIHVwZGF0ZU9yZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ3VwZGF0ZU9yZGVyJyApO1xuICAgICAgICAgICAgbGV0IGZpZWxkcyA9ICQoJy53b29jb21tZXJjZS1jaGVja291dCcpLnNlcmlhbGl6ZSgpO1xuXG4gICAgICAgICAgICByZXR1cm4gJC5hamF4KCB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIHVybDogV0NfR2F0ZXdheV9QYXlFeF9DaGVja291dC5hamF4X3VybCxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ3BheWV4X3VwZGF0ZV9vcmRlcicsXG4gICAgICAgICAgICAgICAgICAgIG5vbmNlOiBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0Lm5vbmNlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBmaWVsZHNcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbidcbiAgICAgICAgICAgIH0gKS5kb25lKCBmdW5jdGlvbiAoIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmhhc093blByb3BlcnR5KCdyZXN1bHQnKSAmJiByZXNwb25zZS5yZXN1bHQgPT09ICdmYWlsdXJlJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UubWVzc2FnZXMuaW5kZXhPZignT3JkZXIgdXBkYXRlIGlzIG5vdCBhdmFpbGFibGUuJykgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRm9yY2UgcmVsb2FkXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oICdyZWZyZXNoUGF5bWVudE1lbnU6IHJlZnJlc2ggd29ya2Fyb3VuZC4gRm9yY2UgcmVsb2FkLicgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdjX3BheWV4X2NoZWNrb3V0LmluaXRQYXltZW50SlMoIHdjX3BheWV4X2NoZWNrb3V0LmpzX3VybCApXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5sb2dFcnJvcigncGF5ZXgtdXBkYXRlLW9yZGVyJywgcmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogT24gQ29uc3VtZXIgSWRlbnRpZmllZFxuICAgICAgICAgKiBAcGFyYW0gZGF0YVxuICAgICAgICAgKiBAcmV0dXJucyB7Kn1cbiAgICAgICAgICovXG4gICAgICAgIG9uQ29uc3VtZXJJZGVudGlmaWVkOiBmdW5jdGlvbiAoIGRhdGEgKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uQ29uc3VtZXJJZGVudGlmaWVkJywgZGF0YSApO1xuICAgICAgICAgICAgJCggJyNjaGFuZ2Utc2hpcHBpbmctaW5mbycgKS5zaG93KCk7XG5cbiAgICAgICAgICAgIHJldHVybiAkLmFqYXgoIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgdXJsOiBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0LmFqYXhfdXJsLFxuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAncGF5ZXhfY2hlY2tvdXRfY3VzdG9tZXJfcHJvZmlsZScsXG4gICAgICAgICAgICAgICAgICAgIG5vbmNlOiBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0Lm5vbmNlLFxuICAgICAgICAgICAgICAgICAgICBjb25zdW1lclByb2ZpbGVSZWY6IGRhdGEuY29uc3VtZXJQcm9maWxlUmVmXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXG4gICAgICAgICAgICB9ICkuYWx3YXlzKCBmdW5jdGlvbiAoIHJlc3BvbnNlICkge1xuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICB9ICkuZG9uZSggZnVuY3Rpb24gKCByZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQocmVzcG9uc2UuZGF0YS5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIEluaXRpYXRlIENoZWNrb3V0XG4gICAgICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuaW5pdENoZWNrb3V0KCBkYXRhLmNvbnN1bWVyUHJvZmlsZVJlZiApO1xuICAgICAgICAgICAgfSApO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBPbiBBZGRyZXNzIERldGFpbHMgQXZhaWxhYmxlXG4gICAgICAgICAqIEBwYXJhbSB0eXBlXG4gICAgICAgICAqIEBwYXJhbSBkYXRhXG4gICAgICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAgICAgKi9cbiAgICAgICAgb25BZGRyZXNzRGV0YWlsc0F2YWlsYWJsZTogZnVuY3Rpb24oIHR5cGUsIGRhdGEgKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uQWRkcmVzc0RldGFpbHNBdmFpbGFibGUnLCB0eXBlLCBkYXRhICk7XG5cbiAgICAgICAgICAgICQoICcjY2hhbmdlLXNoaXBwaW5nLWluZm8nICkuc2hvdygpO1xuXG4gICAgICAgICAgICByZXR1cm4gJC5hamF4KCB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIHVybDogV0NfR2F0ZXdheV9QYXlFeF9DaGVja291dC5hamF4X3VybCxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ3BheWV4X2NoZWNrb3V0X2dldF9hZGRyZXNzJyxcbiAgICAgICAgICAgICAgICAgICAgbm9uY2U6IFdDX0dhdGV3YXlfUGF5RXhfQ2hlY2tvdXQubm9uY2UsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgICAgICAgICAgICAgIHVybDogZGF0YS51cmxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbidcbiAgICAgICAgICAgIH0gKS5hbHdheXMoIGZ1bmN0aW9uICggcmVzcG9uc2UgKSB7XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIH0gKS5kb25lKCBmdW5jdGlvbiAoIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2Uuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5sb2dFcnJvcigncGF5ZXgtYWRkcmVzcy1kZXRhaWxzJywgcmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICBhbGVydChyZXNwb25zZS5kYXRhLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gUHJvY2VzcyBhZGRyZXNzXG4gICAgICAgICAgICAgICAgbGV0IGRhdGEgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgICAgICQuZWFjaChkYXRhLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBbdHlwZV0uZm9yRWFjaChmdW5jdGlvbihzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZWwgPSAkKCdpbnB1dFtuYW1lPVwiJyArIHNlY3Rpb24gKyAnXycgKyBrZXkgKyAnXCJdJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWwubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBlbC5wcm9wKCdyZWFkb25seScsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsLmNsb3Nlc3QoJy5mb3JtLXJvdycpLnJlbW92ZUNsYXNzKCdwYXlleC1sb2NrZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsLnZhbCh2YWx1ZSkuY2hhbmdlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXkgPT09ICdjb3VudHJ5JyB8fCBrZXkgPT09ICdzdGF0ZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZWwxID0gJCgnIycgKyBzZWN0aW9uICsgJ18nICsga2V5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdy5TZWxlY3QyICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbDEuc2VsZWN0MigndmFsJywgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mICQuZm4uY2hvc2VuICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaG9zZW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwxLnZhbCh2YWx1ZSkudHJpZ2dlcignY2hvc2VuOnVwZGF0ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9lbDEuY2hvc2VuKCkuY2hhbmdlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwxLmNoYW5nZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAkKCBkb2N1bWVudC5ib2R5ICkudHJpZ2dlciggJ3VwZGF0ZV9jaGVja291dCcgKTtcbiAgICAgICAgICAgIH0gKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogT24gUGF5bWVudCBNZW51IEluc3RydW1lbnQgU2VsZWN0ZWRcbiAgICAgICAgICogQHBhcmFtIG5hbWVcbiAgICAgICAgICogQHBhcmFtIGluc3RydW1lbnRcbiAgICAgICAgICovXG4gICAgICAgIG9uUGF5bWVudE1lbnVJbnN0cnVtZW50U2VsZWN0ZWQ6IGZ1bmN0aW9uICggbmFtZSwgaW5zdHJ1bWVudCApIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25QYXltZW50TWVudUluc3RydW1lbnRTZWxlY3RlZCcsIG5hbWUsIGluc3RydW1lbnQgKTtcbiAgICAgICAgICAgIC8vIEB0b2RvXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIExvZyBFcnJvclxuICAgICAgICAgKiBAcGFyYW0gaWRcbiAgICAgICAgICogQHBhcmFtIGRhdGFcbiAgICAgICAgICogQHJldHVybnMgeyp9XG4gICAgICAgICAqL1xuICAgICAgICBsb2dFcnJvcjogZnVuY3Rpb24gKCBpZCwgZGF0YSApIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybiggZGF0YSApO1xuXG4gICAgICAgICAgICByZXR1cm4gJC5hamF4KCB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIHVybDogV0NfR2F0ZXdheV9QYXlFeF9DaGVja291dC5hamF4X3VybCxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ3BheWV4X2NoZWNrb3V0X2xvZ19lcnJvcicsXG4gICAgICAgICAgICAgICAgICAgIG5vbmNlOiBXQ19HYXRld2F5X1BheUV4X0NoZWNrb3V0Lm5vbmNlLFxuICAgICAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KCBkYXRhIClcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbidcbiAgICAgICAgICAgIH0gKTtcbiAgICAgICAgfSxcblxuICAgICAgICBvbkVycm9yOiBmdW5jdGlvbiAoIGRhdGEgKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uRXJyb3InLCBkYXRhICk7XG4gICAgICAgICAgICAvL3djX3BheWV4X2NoZWNrb3V0LnN1Ym1pdF9lcnJvciggJzxkaXYgY2xhc3M9XCJ3b29jb21tZXJjZS1lcnJvclwiPicgKyBkYXRhICsgJzwvZGl2PicgKTtcbiAgICAgICAgfSxcbiAgICAgICAgc3VibWl0X2Vycm9yOiBmdW5jdGlvbiggZXJyb3JfbWVzc2FnZSApIHtcbiAgICAgICAgICAgICQoICcud29vY29tbWVyY2UtTm90aWNlR3JvdXAtY2hlY2tvdXQsIC53b29jb21tZXJjZS1lcnJvciwgLndvb2NvbW1lcmNlLW1lc3NhZ2UnICkucmVtb3ZlKCk7XG4gICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5mb3JtLnByZXBlbmQoICc8ZGl2IGNsYXNzPVwid29vY29tbWVyY2UtTm90aWNlR3JvdXAgd29vY29tbWVyY2UtTm90aWNlR3JvdXAtY2hlY2tvdXRcIj4nICsgZXJyb3JfbWVzc2FnZSArICc8L2Rpdj4nICk7XG4gICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5mb3JtLnJlbW92ZUNsYXNzKCAncHJvY2Vzc2luZycgKS51bmJsb2NrKCk7XG4gICAgICAgICAgICB3Y19wYXlleF9jaGVja291dC5mb3JtLmZpbmQoICcuaW5wdXQtdGV4dCwgc2VsZWN0LCBpbnB1dDpjaGVja2JveCcgKS50cmlnZ2VyKCAndmFsaWRhdGUnICkuYmx1cigpO1xuICAgICAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuc2Nyb2xsX3RvX25vdGljZXMoKTtcbiAgICAgICAgICAgICQoIGRvY3VtZW50LmJvZHkgKS50cmlnZ2VyKCAnY2hlY2tvdXRfZXJyb3InICk7XG4gICAgICAgIH0sXG4gICAgICAgIHNjcm9sbF90b19ub3RpY2VzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGxldCBzY3JvbGxFbGVtZW50ID0gJCggJy53b29jb21tZXJjZS1Ob3RpY2VHcm91cC11cGRhdGVPcmRlclJldmlldywgLndvb2NvbW1lcmNlLU5vdGljZUdyb3VwLWNoZWNrb3V0JyApO1xuICAgICAgICAgICAgaWYgKCAhIHNjcm9sbEVsZW1lbnQubGVuZ3RoICkge1xuICAgICAgICAgICAgICAgIHNjcm9sbEVsZW1lbnQgPSAkKCAnLmZvcm0uY2hlY2tvdXQnICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICQuc2Nyb2xsX3RvX25vdGljZXMoIHNjcm9sbEVsZW1lbnQgKTtcbiAgICAgICAgfSxcbiAgICAgICAgaGlkZUFkZHJlc3NGaWVsZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICQoICcud29vY29tbWVyY2UtYmlsbGluZy1maWVsZHNfX2ZpZWxkLXdyYXBwZXIsIC53b29jb21tZXJjZS1zaGlwcGluZy1maWVsZHMnICkuaGlkZSgpO1xuICAgICAgICB9LFxuICAgICAgICBzaG93QWRkcmVzc0ZpZWxkczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJCggJy53b29jb21tZXJjZS1iaWxsaW5nLWZpZWxkc19fZmllbGQtd3JhcHBlciwgLndvb2NvbW1lcmNlLXNoaXBwaW5nLWZpZWxkcycgKS5zaG93KCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgJChkb2N1bWVudCkucmVhZHkoIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgd2NfcGF5ZXhfY2hlY2tvdXQuaW5pdCggJCggXCJmb3JtLmNoZWNrb3V0LCBmb3JtI29yZGVyX3JldmlldywgZm9ybSNhZGRfcGF5bWVudF9tZXRob2RcIiApICk7XG4gICAgfSApO1xufSk7XG5cbiJdfQ==
