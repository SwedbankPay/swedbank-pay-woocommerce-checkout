jQuery(function($){"use strict";window.wc_sb_checkout={js_url:null,paymentMenu:null,isPaymentMenuLoaded:!1,xhr:!1,init:function(e){this.form=e,this.form_submit=!1,$(this.form).on("click","#place_order",this.onSubmit).on("submit checkout_place_order_payex_checkout"),$(document.body).bind("update_checkout",this.onUpdateCheckout),$(document.body).on("checkout_error",this.resetCheckout),$(document.body).on("updated_checkout",this.onUpdatedCheckout),$(document.body).on("blur",this.onUpdatedCheckout),$(document.body).on("click","#change-shipping-info",function(){$("#change-shipping-info").hide(),wc_sb_checkout.showAddressFields()}),$(document.body).on("change","#checkin_country",function(){wc_sb_checkout.loadCheckIn($(this).val())}),wc_sb_checkout.isInstantCheckout()&&wc_sb_checkout.initInstantCheckout()},initInstantCheckout:function(){console.log("Initialization of Instant Checkout..."),wc_sb_checkout.isCheckinEnabled()&&wc_sb_checkout.hideAddressFields();let e=$("#swedbank-pay-consumer-profile");if(e.length>0){let o=e.data("reference");console.log("Initiate consumerProfileRef",o),wc_sb_checkout.initCheckIn()}else wc_sb_checkout.initCheckIn()},loadCheckIn:function(e){return $.ajax({type:"POST",url:WC_Gateway_Swedbank_Pay_Checkout.ajax_url,data:{action:"swedbank_pay_checkin",nonce:WC_Gateway_Swedbank_Pay_Checkout.nonce,country:e},dataType:"json"}).done(function(e){if(!e.success)return wc_sb_checkout.logError("sb-checkin-loader",e),void alert(e.details);window.hasOwnProperty("payex")&&window.payex.hasOwnProperty("hostedView")&&void 0!==window.payex.hostedView.consumer&&window.payex.hostedView.consumer().close(),$("script[src*='px.consumer.client']").remove(),$("#swedbank-pay-checkin iframe").remove(),wc_sb_checkout.loadJs(e.data,function(){wc_sb_checkout.initCheckIn()})})},initCheckIn:function(){"undefined"!=typeof payex&&wc_sb_checkout.waitForLoading("payex.hostedView.consumer",function(e){e?console.warn(e):window.payex.hostedView.consumer({container:"swedbank-pay-checkin",culture:WC_Gateway_Swedbank_Pay_Checkout.culture,style:WC_Gateway_Swedbank_Pay_Checkout.checkInStyle?JSON.parse(WC_Gateway_Swedbank_Pay_Checkout.checkInStyle):null,onConsumerIdentified:function(e){console.log("hostedView: onConsumerIdentified"),wc_sb_checkout.onConsumerIdentified(e)},onNewConsumer:function(e){console.log("hostedView: onNewConsumer"),wc_sb_checkout.onConsumerIdentified(e)},onConsumerRemoved:function(e){console.log("hostedView: onConsumerRemoved")},onBillingDetailsAvailable:function(e){wc_sb_checkout.onAddressDetailsAvailable("billing",e)},onShippingDetailsAvailable:function(e){(WC_Gateway_Swedbank_Pay_Checkout.needs_shipping_address||WC_Gateway_Swedbank_Pay_Checkout.ship_to_billing_address_only)&&wc_sb_checkout.onAddressDetailsAvailable("billing",e),wc_sb_checkout.onAddressDetailsAvailable("shipping",e)},onError:function(e){wc_sb_checkout.logError("sb-checkin",e),alert(e.details),wc_sb_checkout.onError(e.details)}}).open()})},initCheckout:function(e){$("#change-shipping-info").show(),wc_sb_checkout.form.find(".swedbank_pay_customer_reference").remove(),wc_sb_checkout.form.append("<input type='hidden' class='swedbank_pay_customer_reference' name='swedbank_pay_customer_reference' value='"+e+"'/>"),wc_sb_checkout.onSubmit()},isInstantCheckout:()=>WC_Gateway_Swedbank_Pay_Checkout.instant_checkout,isCheckinEnabled:()=>WC_Gateway_Swedbank_Pay_Checkout.checkin,isPaymentMethodChosen:function(){return $("#payment_method_payex_checkout").is(":checked")},block:function(){1!==wc_sb_checkout.form.data()["blockUI.isBlocked"]&&wc_sb_checkout.form.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblock:function(){wc_sb_checkout.form.unblock()},onClose:function(){wc_sb_checkout.unblock()},onReady:function(){console.log("Ready")},onUpdateCheckout:function(){if(console.log("onUpdateCheckout"),!wc_sb_checkout.isInstantCheckout())return!1},onUpdatedCheckout:function(){return console.log("onUpdatedCheckout"),!!wc_sb_checkout.isInstantCheckout()&&(!wc_sb_checkout.form.is(".processing")&&(wc_sb_checkout.validateForm()?($(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),void wc_sb_checkout.updateOrder()):(console.log("onUpdatedCheckout: Validation is failed"),!1)))},onSubmit:function(e){return!!wc_sb_checkout.form_submit||(!wc_sb_checkout.isPaymentMethodChosen()||(void 0!==e&&e.preventDefault(),!!wc_sb_checkout.validateForm()&&(console.log("onSubmit"),!wc_sb_checkout.form.is(".processing")&&($(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),wc_sb_checkout.form.addClass("processing"),wc_sb_checkout.block(),wc_sb_checkout.placeOrder().always(function(e){wc_sb_checkout.form.removeClass("processing"),wc_sb_checkout.unblock()}).fail(function(e,o){wc_sb_checkout.onError(o)}).done(function(e){if(console.log(e),"success"!==e.result)return e.hasOwnProperty("reload")&&!0===e.reload?void window.location.reload():(!0===e.result.refresh&&$(document.body).trigger("update_checkout"),void wc_sb_checkout.onError(e.messages));wc_sb_checkout.js_url=e.js_url,wc_sb_checkout.initPaymentJS(wc_sb_checkout.js_url)}),!1))))},resetCheckout:function(){wc_sb_checkout.form_submit=!1},validateForm:function(){var e,o=!0;return(e=$("#ship-to-different-address-checkbox").is(":checked")?$(".woocommerce-billing-fields .validate-required, .woocommerce-shipping-fields .validate-required").find("input, select").not($("#account_password, #account_username")):$(".woocommerce-billing-fields .validate-required").find("input, select").not($("#account_password, #account_username"))).length&&e.each(function(){var e=$(this),c=e.closest(".form-row"),n=c.is(".validate-required"),t=c.is(".validate-email");(n&&("checkbox"!==e.attr("type")||e.is(":checked")?""===e.val()&&(o=!1):o=!1),t)&&(e.val()&&(new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i).test(e.val())||(o=!1)))}),o},waitForLoading:function(var_string,callback){try{var obj=eval(var_string)}catch(e){return void callback(e)}let attempts=0,timer=window.setInterval(function(){void 0!==obj?(window.clearInterval(timer),callback(null,obj)):++attempts>=120&&(window.clearInterval(timer),callback("Timeout"))},500)},loadJs:function(e,o){let c=document.createElement("script");c.setAttribute("src",e),c.setAttribute("type","text/javascript"),c.setAttribute("async",""),c.addEventListener("load",function(){o()},!1);let n=document.getElementsByTagName("head")[0];return n&&n.appendChild(c),c},initPaymentJS:function(e,o){void 0===o&&(o=function(){}),window.hasOwnProperty("payex")&&window.payex.hasOwnProperty("hostedView")&&(void 0!==window.payex.hostedView.paymentMenu&&window.payex.hostedView.paymentMenu().close(),$("#payment-swedbank-pay-checkout iframe").remove()),$("script[src*='px.paymentmenu.client']").remove(),wc_sb_checkout.loadJs(e,function(){$("#payment-swedbank-pay-checkout iframe").remove(),wc_sb_checkout.isInstantCheckout()?($("#payment").hide(),wc_sb_checkout.initPaymentMenu("payment-swedbank-pay-checkout")):$.featherlight('<div id="swedbank-pay-paymentmenu">&nbsp;</div>',{variant:"featherlight-swedbank-pay",persist:!0,closeOnClick:!1,closeOnEsc:!1,afterOpen:function(){wc_sb_checkout.initPaymentMenu("swedbank-pay-paymentmenu")},afterClose:function(){wc_sb_checkout.form.removeClass("processing").unblock()}}),o()})},initPaymentMenu:function(e,o){console.log("initPaymentMenu"),void 0===o&&(o=function(){}),this.paymentMenu=window.payex.hostedView.paymentMenu({container:e,culture:WC_Gateway_Swedbank_Pay_Checkout.culture,style:WC_Gateway_Swedbank_Pay_Checkout.paymentMenuStyle?JSON.parse(WC_Gateway_Swedbank_Pay_Checkout.paymentMenuStyle):null,onApplicationConfigured:function(e){console.log("onApplicationConfigured"),console.log(e),wc_sb_checkout.isPaymentMenuLoaded=!0,o(null)},onPaymentMenuInstrumentSelected:function(e){console.log("onPaymentMenuInstrumentSelected"),console.log(e),wc_sb_checkout.onPaymentMenuInstrumentSelected(e.name,e.instrument)},onPaymentCreated:function(){console.log("onPaymentCreated")},onPaymentCompleted:function(e){console.log("onPaymentCompleted"),console.log(e),self.location.href=e.redirectUrl},onPaymentCanceled:function(e){console.log("onPaymentCanceled"),console.log(e),wc_sb_checkout.logError("payment-menu-cancel",e)},onPaymentFailed:function(e){console.log("onPaymentFailed"),console.log(e),wc_sb_checkout.logError("payment-menu-failed",e)},onError:function(e){wc_sb_checkout.logError("payment-menu-error",e),o(e)}}),this.paymentMenu.open()},refreshPaymentMenu:function(){console.log("refreshPaymentMenu"),void 0!==this.paymentMenu&&this.paymentMenu&&this.paymentMenu.hasOwnProperty("refresh")&&"function"==typeof this.paymentMenu.refresh?this.paymentMenu.refresh():console.warn("refreshPaymentMenu: refresh workaround")},placeOrder:function(){console.log("placeOrder");let e=$(".woocommerce-checkout").serialize();return $.ajax({type:"POST",url:WC_Gateway_Swedbank_Pay_Checkout.ajax_url,data:{action:"swedbank_pay_place_order",nonce:WC_Gateway_Swedbank_Pay_Checkout.nonce,data:e},dataType:"json"}).done(function(e){e.hasOwnProperty("reload")&&!0===e.reload?window.location.reload():e.hasOwnProperty("result")&&"failure"===e.result&&(wc_sb_checkout.logError("sb-place-order",e),wc_sb_checkout.onError(e.messages))})},updateOrder:function(e){console.log("updateOrder");let o=$(".woocommerce-checkout").serialize();return void 0===e&&(e=!1),o+="&compatibility="+e,wc_sb_checkout.form.addClass("processing"),wc_sb_checkout.block(),wc_sb_checkout.xhr&&wc_sb_checkout.xhr.abort(),wc_sb_checkout.xhr=$.ajax({type:"POST",url:WC_Gateway_Swedbank_Pay_Checkout.ajax_url,data:{action:"swedbank_pay_update_order",nonce:WC_Gateway_Swedbank_Pay_Checkout.nonce,data:o},dataType:"json"}).always(function(e){wc_sb_checkout.xhr=!1,wc_sb_checkout.form.removeClass("processing"),wc_sb_checkout.unblock()}).fail(function(e,o){console.log("updateOrder error:"+o),wc_sb_checkout.onError(o)}).done(function(o){return console.log(o),o.hasOwnProperty("result")&&"success"===o.result?(wc_sb_checkout.js_url=o.js_url,void wc_sb_checkout.refreshPaymentMenu()):o.hasOwnProperty("result")&&"failure"===o.result&&o.messages.indexOf("Order update is not available.")>-1&&!e?(console.warn("refreshPaymentMenu: refresh workaround. Force reload."),void wc_sb_checkout.updateOrder(!0).done(function(e){e.hasOwnProperty("js_url")&&wc_sb_checkout.initPaymentJS(e.js_url)})):void(o.hasOwnProperty("reload")&&!0===o.reload?window.location.reload():(!0===o.result.refresh&&$(document.body).trigger("update_checkout"),wc_sb_checkout.logError("sb-update-order",o),wc_sb_checkout.onError(o.messages)))}),wc_sb_checkout.xhr},onConsumerIdentified:function(e){return console.log("onConsumerIdentified",e),$("#change-shipping-info").show(),$.ajax({type:"POST",url:WC_Gateway_Swedbank_Pay_Checkout.ajax_url,data:{action:"swedbank_pay_checkout_customer_profile",nonce:WC_Gateway_Swedbank_Pay_Checkout.nonce,consumerProfileRef:e.consumerProfileRef},dataType:"json"}).always(function(e){}).done(function(o){console.log(o),o.success?wc_sb_checkout.initCheckout(e.consumerProfileRef):alert(o.data.message)})},onAddressDetailsAvailable:function(e,o){return console.log("onAddressDetailsAvailable",e,o),$("#change-shipping-info").show(),wc_sb_checkout.block(),$.ajax({type:"POST",url:WC_Gateway_Swedbank_Pay_Checkout.ajax_url,data:{action:"swedbank_pay_checkout_get_address",nonce:WC_Gateway_Swedbank_Pay_Checkout.nonce,type:e,url:o.url},dataType:"json"}).always(function(e){wc_sb_checkout.unblock()}).done(function(o){if(console.log(o),!o.success)return wc_sb_checkout.logError("sb-address-details",o),void alert(o.data.message);let c=o.data;$.each(c,function(o,c){[e].forEach(function(e){let n=$('input[name="'+e+"_"+o+'"]');if(0!==n.length&&(n.prop("readonly",!1),n.closest(".form-row").removeClass("swedbank-pay-locked"),n.val(c).change(),"country"===o||"state"===o)){let n=$("#"+e+"_"+o);void 0!==window.Select2?n.select2("val",c):void 0!==$.fn.chosen?n.val(c).trigger("chosen:updated"):n.change()}})}),$(document.body).trigger("update_checkout")})},onPaymentMenuInstrumentSelected:function(e,o){console.log("onPaymentMenuInstrumentSelected",e,o),$(document.body).trigger("sb_payment_menu_instrument_selected",[e,o])},logError:function(e,o){return console.warn(o),$.ajax({type:"POST",url:WC_Gateway_Swedbank_Pay_Checkout.ajax_url,data:{action:"swedbank_pay_checkout_log_error",nonce:WC_Gateway_Swedbank_Pay_Checkout.nonce,id:e,data:JSON.stringify(o)},dataType:"json"})},onError:function(e){console.log("onError",e),wc_sb_checkout.submit_error('<div class="woocommerce-error">'+e+"</div>")},submit_error:function(e){$(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),wc_sb_checkout.form.prepend('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout">'+e+"</div>"),wc_sb_checkout.form.removeClass("processing").unblock(),wc_sb_checkout.form.find(".input-text, select, input:checkbox").trigger("validate").blur(),wc_sb_checkout.scroll_to_notices(),$(document.body).trigger("checkout_error")},scroll_to_notices:function(){let e=$(".woocommerce-NoticeGroup-updateOrderReview, .woocommerce-NoticeGroup-checkout");e.length||(e=$(".form.checkout")),$.scroll_to_notices(e)},hideAddressFields:function(){$(".woocommerce-billing-fields__field-wrapper, .woocommerce-shipping-fields").hide()},showAddressFields:function(){$(".woocommerce-billing-fields__field-wrapper, .woocommerce-shipping-fields").show()}},$(document).ready(function(){wc_sb_checkout.init($("form.checkout, form#order_review, form#add_payment_method"))})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNoZWNrb3V0LmpzIl0sIm5hbWVzIjpbImpRdWVyeSIsIiQiLCJ3aW5kb3ciLCJ3Y19zYl9jaGVja291dCIsImpzX3VybCIsInBheW1lbnRNZW51IiwiaXNQYXltZW50TWVudUxvYWRlZCIsInhociIsImluaXQiLCJmb3JtIiwidGhpcyIsImZvcm1fc3VibWl0Iiwib24iLCJvblN1Ym1pdCIsImRvY3VtZW50IiwiYm9keSIsImJpbmQiLCJvblVwZGF0ZUNoZWNrb3V0IiwicmVzZXRDaGVja291dCIsIm9uVXBkYXRlZENoZWNrb3V0IiwiaGlkZSIsInNob3dBZGRyZXNzRmllbGRzIiwibG9hZENoZWNrSW4iLCJ2YWwiLCJpc0luc3RhbnRDaGVja291dCIsImluaXRJbnN0YW50Q2hlY2tvdXQiLCJjb25zb2xlIiwibG9nIiwiaXNDaGVja2luRW5hYmxlZCIsImhpZGVBZGRyZXNzRmllbGRzIiwiY29uc3VtZXJQcm9maWxlRWxtIiwibGVuZ3RoIiwicmVmZXJlbmNlIiwiZGF0YSIsImluaXRDaGVja0luIiwiY291bnRyeSIsImFqYXgiLCJ0eXBlIiwidXJsIiwiV0NfR2F0ZXdheV9Td2VkYmFua19QYXlfQ2hlY2tvdXQiLCJhamF4X3VybCIsImFjdGlvbiIsIm5vbmNlIiwiZGF0YVR5cGUiLCJkb25lIiwic3VjY2VzcyIsImxvZ0Vycm9yIiwiYWxlcnQiLCJkZXRhaWxzIiwiaGFzT3duUHJvcGVydHkiLCJwYXlleCIsImhvc3RlZFZpZXciLCJjb25zdW1lciIsImNsb3NlIiwicmVtb3ZlIiwibG9hZEpzIiwid2FpdEZvckxvYWRpbmciLCJlcnIiLCJ3YXJuIiwiY29udGFpbmVyIiwiY3VsdHVyZSIsInN0eWxlIiwiY2hlY2tJblN0eWxlIiwiSlNPTiIsInBhcnNlIiwib25Db25zdW1lcklkZW50aWZpZWQiLCJvbk5ld0NvbnN1bWVyIiwib25Db25zdW1lclJlbW92ZWQiLCJvbkJpbGxpbmdEZXRhaWxzQXZhaWxhYmxlIiwib25BZGRyZXNzRGV0YWlsc0F2YWlsYWJsZSIsIm9uU2hpcHBpbmdEZXRhaWxzQXZhaWxhYmxlIiwibmVlZHNfc2hpcHBpbmdfYWRkcmVzcyIsInNoaXBfdG9fYmlsbGluZ19hZGRyZXNzX29ubHkiLCJvbkVycm9yIiwib3BlbiIsImluaXRDaGVja291dCIsInNob3ciLCJmaW5kIiwiYXBwZW5kIiwiaW5zdGFudF9jaGVja291dCIsImNoZWNraW4iLCJpc1BheW1lbnRNZXRob2RDaG9zZW4iLCJpcyIsImJsb2NrIiwibWVzc2FnZSIsIm92ZXJsYXlDU1MiLCJiYWNrZ3JvdW5kIiwib3BhY2l0eSIsInVuYmxvY2siLCJvbkNsb3NlIiwib25SZWFkeSIsInZhbGlkYXRlRm9ybSIsInVwZGF0ZU9yZGVyIiwiZSIsInByZXZlbnREZWZhdWx0IiwiYWRkQ2xhc3MiLCJwbGFjZU9yZGVyIiwiYWx3YXlzIiwicmVzcG9uc2UiLCJyZW1vdmVDbGFzcyIsImZhaWwiLCJqcVhIUiIsInRleHRTdGF0dXMiLCJyZXN1bHQiLCJyZWxvYWQiLCJsb2NhdGlvbiIsInJlZnJlc2giLCJ0cmlnZ2VyIiwibWVzc2FnZXMiLCJpbml0UGF5bWVudEpTIiwiJHJlcXVpcmVkX2lucHV0cyIsInZhbGlkYXRlZCIsIm5vdCIsImVhY2giLCIkdGhpcyIsIiRwYXJlbnQiLCJjbG9zZXN0IiwidmFsaWRhdGVfcmVxdWlyZWQiLCJ2YWxpZGF0ZV9lbWFpbCIsImF0dHIiLCJSZWdFeHAiLCJ0ZXN0IiwidmFyX3N0cmluZyIsImNhbGxiYWNrIiwib2JqIiwiZXZhbCIsImF0dGVtcHRzIiwidGltZXIiLCJzZXRJbnRlcnZhbCIsImNsZWFySW50ZXJ2YWwiLCJqcyIsInNjcmlwdCIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJhZGRFdmVudExpc3RlbmVyIiwib0hlYWQiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsImFwcGVuZENoaWxkIiwiaW5pdFBheW1lbnRNZW51IiwiZmVhdGhlcmxpZ2h0IiwidmFyaWFudCIsInBlcnNpc3QiLCJjbG9zZU9uQ2xpY2siLCJjbG9zZU9uRXNjIiwiYWZ0ZXJPcGVuIiwiYWZ0ZXJDbG9zZSIsImlkIiwicGF5bWVudE1lbnVTdHlsZSIsIm9uQXBwbGljYXRpb25Db25maWd1cmVkIiwib25QYXltZW50TWVudUluc3RydW1lbnRTZWxlY3RlZCIsIm5hbWUiLCJpbnN0cnVtZW50Iiwib25QYXltZW50Q3JlYXRlZCIsIm9uUGF5bWVudENvbXBsZXRlZCIsInNlbGYiLCJocmVmIiwicmVkaXJlY3RVcmwiLCJvblBheW1lbnRDYW5jZWxlZCIsIm9uUGF5bWVudEZhaWxlZCIsInJlZnJlc2hQYXltZW50TWVudSIsImZpZWxkcyIsInNlcmlhbGl6ZSIsImNvbXBhdGliaWxpdHkiLCJhYm9ydCIsImluZGV4T2YiLCJjb25zdW1lclByb2ZpbGVSZWYiLCJrZXkiLCJ2YWx1ZSIsImZvckVhY2giLCJzZWN0aW9uIiwiZWwiLCJwcm9wIiwiY2hhbmdlIiwiZWwxIiwiU2VsZWN0MiIsInNlbGVjdDIiLCJmbiIsImNob3NlbiIsInN0cmluZ2lmeSIsInN1Ym1pdF9lcnJvciIsImVycm9yX21lc3NhZ2UiLCJwcmVwZW5kIiwiYmx1ciIsInNjcm9sbF90b19ub3RpY2VzIiwic2Nyb2xsRWxlbWVudCIsInJlYWR5Il0sIm1hcHBpbmdzIjoiQUFDQUEsT0FBUSxTQUFVQyxHQUNkLGFBS0FDLE9BQU9DLGVBQWlCLENBQ3BCQyxPQUFRLEtBQ1JDLFlBQWEsS0FDYkMscUJBQXFCLEVBQ3JCQyxLQUFLLEVBS0xDLEtBQU0sU0FBVUMsR0FDWkMsS0FBS0QsS0FBZUEsRUFDcEJDLEtBQUtDLGFBQWUsRUFFcEJWLEVBQUdTLEtBQUtELE1BR0hHLEdBQUksUUFBUyxlQUFnQkYsS0FBS0csVUFHbENELEdBQUksOENBRVRYLEVBQUdhLFNBQVNDLE1BQU9DLEtBQU0sa0JBQW1CTixLQUFLTyxrQkFDakRoQixFQUFHYSxTQUFTQyxNQUFPSCxHQUFJLGlCQUFrQkYsS0FBS1EsZUFDOUNqQixFQUFHYSxTQUFTQyxNQUFPSCxHQUFJLG1CQUFvQkYsS0FBS1MsbUJBQ2hEbEIsRUFB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K0VBQWdGcUQsU0FDbkZuRCxlQUFlTSxLQUFLNEssUUFBUyx5RUFBMkVELEVBQWdCLFVBQ3hIakwsZUFBZU0sS0FBSzBGLFlBQWEsY0FBZVgsVUFDaERyRixlQUFlTSxLQUFLb0UsS0FBTSx1Q0FBd0M4QixRQUFTLFlBQWEyRSxPQUN4Rm5MLGVBQWVvTCxvQkFDZnRMLEVBQUdhLFNBQVNDLE1BQU80RixRQUFTLG1CQUVoQzRFLGtCQUFtQixXQUNmLElBQUlDLEVBQWdCdkwsRUFBRyxpRkFDaEJ1TCxFQUFjekosU0FDakJ5SixFQUFnQnZMLEVBQUcsbUJBR3ZCQSxFQUFFc0wsa0JBQW1CQyxJQUV6QjNKLGtCQUFtQixXQUNmNUIsRUFBRyw0RUFBNkVtQixRQUVwRkMsa0JBQW1CLFdBQ2ZwQixFQUFHLDRFQUE2RTJFLFNBSXhGM0UsRUFBRWEsVUFBVTJLLE1BQU8sV0FDZnRMLGVBQWVLLEtBQU1QLEVBQUciLCJmaWxlIjoiY2hlY2tvdXQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZ2xvYmFsIHdjX2NoZWNrb3V0X3BhcmFtcyAqL1xualF1ZXJ5KCBmdW5jdGlvbiggJCApIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICAvKipcbiAgICAgKiBPYmplY3QgdG8gaGFuZGxlIFN3ZWRiYW5rIFBheSBjaGVja291dCBwYXltZW50IGZvcm1zLlxuICAgICAqL1xuICAgIHdpbmRvdy53Y19zYl9jaGVja291dCA9IHtcbiAgICAgICAganNfdXJsOiBudWxsLFxuICAgICAgICBwYXltZW50TWVudTogbnVsbCxcbiAgICAgICAgaXNQYXltZW50TWVudUxvYWRlZDogZmFsc2UsXG4gICAgICAgIHhocjogZmFsc2UsXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluaXRpYWxpemUgZSBoYW5kbGVycyBhbmQgVUkgc3RhdGUuXG4gICAgICAgICAqL1xuICAgICAgICBpbml0OiBmdW5jdGlvbiggZm9ybSApIHtcbiAgICAgICAgICAgIHRoaXMuZm9ybSAgICAgICAgID0gZm9ybTtcbiAgICAgICAgICAgIHRoaXMuZm9ybV9zdWJtaXQgID0gZmFsc2U7XG5cbiAgICAgICAgICAgICQoIHRoaXMuZm9ybSApXG4gICAgICAgICAgICAvLyBXZSBuZWVkIHRvIGJpbmQgZGlyZWN0bHkgdG8gdGhlIGNsaWNrIChhbmQgbm90IGNoZWNrb3V0X3BsYWNlX29yZGVyX3BheWV4X2NoZWNrb3V0KSB0byBhdm9pZCBwb3B1cCBibG9ja2Vyc1xuICAgICAgICAgICAgLy8gZXNwZWNpYWxseSBvbiBtb2JpbGUgZGV2aWNlcyAobGlrZSBvbiBDaHJvbWUgZm9yIGlPUykgZnJvbSBibG9ja2luZyBwYXlleF9jaGVja291dChwYXltZW50X2lkLCB7fSwgJ29wZW4nKTsgZnJvbSBvcGVuaW5nIGEgdGFiXG4gICAgICAgICAgICAgICAgLm9uKCAnY2xpY2snLCAnI3BsYWNlX29yZGVyJywgdGhpcy5vblN1Ym1pdCApXG5cbiAgICAgICAgICAgICAgICAvLyBXb29Db21tZXJjZSBsZXRzIHVzIHJldHVybiBhIGZhbHNlIG9uIGNoZWNrb3V0X3BsYWNlX29yZGVyX3tnYXRld2F5fSB0byBrZWVwIHRoZSBmb3JtIGZyb20gc3VibWl0dGluZ1xuICAgICAgICAgICAgICAgIC5vbiggJ3N1Ym1pdCBjaGVja291dF9wbGFjZV9vcmRlcl9wYXlleF9jaGVja291dCcgKTtcblxuICAgICAgICAgICAgJCggZG9jdW1lbnQuYm9keSApLmJpbmQoICd1cGRhdGVfY2hlY2tvdXQnLCB0aGlzLm9uVXBkYXRlQ2hlY2tvdXQgKTtcbiAgICAgICAgICAgICQoIGRvY3VtZW50LmJvZHkgKS5vbiggJ2NoZWNrb3V0X2Vycm9yJywgdGhpcy5yZXNldENoZWNrb3V0ICk7XG4gICAgICAgICAgICAkKCBkb2N1bWVudC5ib2R5ICkub24oICd1cGRhdGVkX2NoZWNrb3V0JywgdGhpcy5vblVwZGF0ZWRDaGVja291dCApO1xuICAgICAgICAgICAgJCggZG9jdW1lbnQuYm9keSApLm9uKCAnYmx1cicsIHRoaXMub25VcGRhdGVkQ2hlY2tvdXQgKTtcblxuICAgICAgICAgICAgJCggZG9jdW1lbnQuYm9keSApLm9uKCAnY2xpY2snLCAnI2NoYW5nZS1zaGlwcGluZy1pbmZvJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8vIEhpZGUgXCJDaGFuZ2Ugc2hpcHBpbmcgaW5mb1wiIGJ1dHRvblxuICAgICAgICAgICAgICAgICQoICcjY2hhbmdlLXNoaXBwaW5nLWluZm8nICkuaGlkZSgpO1xuXG4gICAgICAgICAgICAgICAgLy8gU2hvdyBBZGRyZXNzIEZpZWxkc1xuICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LnNob3dBZGRyZXNzRmllbGRzKCk7XG4gICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICQoIGRvY3VtZW50LmJvZHkgKS5vbiggJ2NoYW5nZScsICcjY2hlY2tpbl9jb3VudHJ5JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LmxvYWRDaGVja0luKCAkKHRoaXMpLnZhbCgpICk7XG4gICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIC8vIEluaXRpYWxpemUgSW5zdGFudCBDaGVja291dFxuICAgICAgICAgICAgaWYgKCB3Y19zYl9jaGVja291dC5pc0luc3RhbnRDaGVja291dCgpICkge1xuICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LmluaXRJbnN0YW50Q2hlY2tvdXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogSW5pdGlhbGl6ZSBJbnN0YW50IENoZWNrb3V0XG4gICAgICAgICAqL1xuICAgICAgICBpbml0SW5zdGFudENoZWNrb3V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ0luaXRpYWxpemF0aW9uIG9mIEluc3RhbnQgQ2hlY2tvdXQuLi4nICk7XG5cbiAgICAgICAgICAgIGlmICggd2Nfc2JfY2hlY2tvdXQuaXNDaGVja2luRW5hYmxlZCgpICkge1xuICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LmhpZGVBZGRyZXNzRmllbGRzKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFVzZSBzYXZlZCBjb25zdW1lclByb2ZpbGVSZWZcbiAgICAgICAgICAgIGxldCBjb25zdW1lclByb2ZpbGVFbG0gPSAkKCAnI3N3ZWRiYW5rLXBheS1jb25zdW1lci1wcm9maWxlJyApO1xuICAgICAgICAgICAgaWYgKCBjb25zdW1lclByb2ZpbGVFbG0ubGVuZ3RoID4gMCApIHtcbiAgICAgICAgICAgICAgICBsZXQgcmVmZXJlbmNlID0gY29uc3VtZXJQcm9maWxlRWxtLmRhdGEoICdyZWZlcmVuY2UnICk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coICdJbml0aWF0ZSBjb25zdW1lclByb2ZpbGVSZWYnLCByZWZlcmVuY2UgKTtcbiAgICAgICAgICAgICAgICAvL3djX3NiX2NoZWNrb3V0LmluaXRDaGVja291dCggcmVmZXJlbmNlICk7XG4gICAgICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQuaW5pdENoZWNrSW4oKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gSW5pdGlhdGUgY2hlY2tpblxuXG4gICAgICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQuaW5pdENoZWNrSW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogTG9hZCBDaGVja0luXG4gICAgICAgICAqIEBwYXJhbSBjb3VudHJ5XG4gICAgICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAgICAgKi9cbiAgICAgICAgbG9hZENoZWNrSW46IGZ1bmN0aW9uKCBjb3VudHJ5ICkge1xuICAgICAgICAgICAgcmV0dXJuICQuYWpheCgge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICB1cmw6IFdDX0dhdGV3YXlfU3dlZGJhbmtfUGF5X0NoZWNrb3V0LmFqYXhfdXJsLFxuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAnc3dlZGJhbmtfcGF5X2NoZWNraW4nLFxuICAgICAgICAgICAgICAgICAgICBub25jZTogV0NfR2F0ZXdheV9Td2VkYmFua19QYXlfQ2hlY2tvdXQubm9uY2UsXG4gICAgICAgICAgICAgICAgICAgIGNvdW50cnk6IGNvdW50cnlcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbidcbiAgICAgICAgICAgIH0gKS5kb25lKCBmdW5jdGlvbiAoIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgaWYgKCAhIGRhdGEuc3VjY2VzcyApIHtcbiAgICAgICAgICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQubG9nRXJyb3IoICdzYi1jaGVja2luLWxvYWRlcicsIGRhdGEgKTtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoIGRhdGEuZGV0YWlscyApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gRGVzdHJveVxuICAgICAgICAgICAgICAgIGlmICggd2luZG93Lmhhc093blByb3BlcnR5KCAncGF5ZXgnICkgJiYgd2luZG93LnBheWV4Lmhhc093blByb3BlcnR5KCAnaG9zdGVkVmlldycgKSApIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCB0eXBlb2Ygd2luZG93LnBheWV4Lmhvc3RlZFZpZXcuY29uc3VtZXIgIT09ICd1bmRlZmluZWQnICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnBheWV4Lmhvc3RlZFZpZXcuY29uc3VtZXIoKS5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gRGVzdHJveSBKU1xuICAgICAgICAgICAgICAgICQoIFwic2NyaXB0W3NyYyo9J3B4LmNvbnN1bWVyLmNsaWVudCddXCIgKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAkKCAnI3N3ZWRiYW5rLXBheS1jaGVja2luIGlmcmFtZScgKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICB3Y19zYl9jaGVja291dC5sb2FkSnMoIGRhdGEuZGF0YSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB3Y19zYl9jaGVja291dC5pbml0Q2hlY2tJbigpO1xuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgIH0gKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogSW5pdGlhbGl6ZSBDaGVja0luXG4gICAgICAgICAqL1xuICAgICAgICBpbml0Q2hlY2tJbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoIHR5cGVvZiBwYXlleCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LndhaXRGb3JMb2FkaW5nKCdwYXlleC5ob3N0ZWRWaWV3LmNvbnN1bWVyJywgZnVuY3Rpb24gKCBlcnIgKSB7XG4gICAgICAgICAgICAgICAgaWYgKCBlcnIgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybiggZXJyICk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBJbml0IFBheUV4IGhvc3RlZFZpZXdcbiAgICAgICAgICAgICAgICB3aW5kb3cucGF5ZXguaG9zdGVkVmlldy5jb25zdW1lcigge1xuICAgICAgICAgICAgICAgICAgICBjb250YWluZXI6ICdzd2VkYmFuay1wYXktY2hlY2tpbicsXG4gICAgICAgICAgICAgICAgICAgIGN1bHR1cmU6IFdDX0dhdGV3YXlfU3dlZGJhbmtfUGF5X0NoZWNrb3V0LmN1bHR1cmUsXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlOiBXQ19HYXRld2F5X1N3ZWRiYW5rX1BheV9DaGVja291dC5jaGVja0luU3R5bGUgPyBKU09OLnBhcnNlKCBXQ19HYXRld2F5X1N3ZWRiYW5rX1BheV9DaGVja291dC5jaGVja0luU3R5bGUgKSA6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIG9uQ29uc3VtZXJJZGVudGlmaWVkOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnaG9zdGVkVmlldzogb25Db25zdW1lcklkZW50aWZpZWQnICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3Y19zYl9jaGVja291dC5vbkNvbnN1bWVySWRlbnRpZmllZCggZGF0YSApO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvbk5ld0NvbnN1bWVyOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnaG9zdGVkVmlldzogb25OZXdDb25zdW1lcicgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0Lm9uQ29uc3VtZXJJZGVudGlmaWVkKCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG9uQ29uc3VtZXJSZW1vdmVkOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnaG9zdGVkVmlldzogb25Db25zdW1lclJlbW92ZWQnICk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG9uQmlsbGluZ0RldGFpbHNBdmFpbGFibGU6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQub25BZGRyZXNzRGV0YWlsc0F2YWlsYWJsZSggJ2JpbGxpbmcnLCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG9uU2hpcHBpbmdEZXRhaWxzQXZhaWxhYmxlOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggV0NfR2F0ZXdheV9Td2VkYmFua19QYXlfQ2hlY2tvdXQubmVlZHNfc2hpcHBpbmdfYWRkcmVzcyB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdDX0dhdGV3YXlfU3dlZGJhbmtfUGF5X0NoZWNrb3V0LnNoaXBfdG9fYmlsbGluZ19hZGRyZXNzX29ubHlcbiAgICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0Lm9uQWRkcmVzc0RldGFpbHNBdmFpbGFibGUoICdiaWxsaW5nJywgZGF0YSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3Y19zYl9jaGVja291dC5vbkFkZHJlc3NEZXRhaWxzQXZhaWxhYmxlKCAnc2hpcHBpbmcnLCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uICggZGF0YSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LmxvZ0Vycm9yKCAnc2ItY2hlY2tpbicsIGRhdGEgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCBkYXRhLmRldGFpbHMgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0Lm9uRXJyb3IoIGRhdGEuZGV0YWlscyApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApLm9wZW4oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIGluaXRDaGVja291dDogZnVuY3Rpb24oIHJlZmVyZW5jZSApIHtcbiAgICAgICAgICAgIC8vIFNob3cgXCJDaGFuZ2Ugc2hpcHBpbmcgaW5mb1wiIGJ1dHRvblxuICAgICAgICAgICAgJCggJyNjaGFuZ2Utc2hpcHBpbmctaW5mbycgKS5zaG93KCk7XG5cbiAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LmZvcm0uZmluZCggJy5zd2VkYmFua19wYXlfY3VzdG9tZXJfcmVmZXJlbmNlJyApLnJlbW92ZSgpO1xuICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQuZm9ybS5hcHBlbmQoIFwiPGlucHV0IHR5cGU9J2hpZGRlbicgY2xhc3M9J3N3ZWRiYW5rX3BheV9jdXN0b21lcl9yZWZlcmVuY2UnIG5hbWU9J3N3ZWRiYW5rX3BheV9jdXN0b21lcl9yZWZlcmVuY2UnIHZhbHVlPSdcIiArIHJlZmVyZW5jZSArIFwiJy8+XCIgKTtcblxuICAgICAgICAgICAgLy93Y19zYl9jaGVja291dC5mb3JtLnN1Ym1pdCgpO1xuICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQub25TdWJtaXQoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBpc0luc3RhbnRDaGVja291dCgpIHtcbiAgICAgICAgICAgIHJldHVybiBXQ19HYXRld2F5X1N3ZWRiYW5rX1BheV9DaGVja291dC5pbnN0YW50X2NoZWNrb3V0O1xuICAgICAgICB9LFxuXG4gICAgICAgIGlzQ2hlY2tpbkVuYWJsZWQoKSB7XG4gICAgICAgICAgICByZXR1cm4gV0NfR2F0ZXdheV9Td2VkYmFua19QYXlfQ2hlY2tvdXQuY2hlY2tpbjtcbiAgICAgICAgfSxcblxuICAgICAgICBpc1BheW1lbnRNZXRob2RDaG9zZW46IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuICQoICcjcGF5bWVudF9tZXRob2RfcGF5ZXhfY2hlY2tvdXQnICkuaXMoICc6Y2hlY2tlZCcgKTtcbiAgICAgICAgfSxcblxuICAgICAgICBibG9jazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBsZXQgZm9ybV9kYXRhID0gd2Nfc2JfY2hlY2tvdXQuZm9ybS5kYXRhKCk7XG4gICAgICAgICAgICBpZiAoIDEgIT09IGZvcm1fZGF0YVsnYmxvY2tVSS5pc0Jsb2NrZWQnXSApIHtcbiAgICAgICAgICAgICAgICB3Y19zYl9jaGVja291dC5mb3JtLmJsb2NrKHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgb3ZlcmxheUNTUzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogJyNmZmYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMC42XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICB1bmJsb2NrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LmZvcm0udW5ibG9jaygpO1xuICAgICAgICB9LFxuXG4gICAgICAgIG9uQ2xvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQudW5ibG9jaygpO1xuICAgICAgICB9LFxuXG4gICAgICAgIG9uUmVhZHk6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coICdSZWFkeScgKTtcbiAgICAgICAgfSxcblxuICAgICAgICBvblVwZGF0ZUNoZWNrb3V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25VcGRhdGVDaGVja291dCcgKTtcblxuICAgICAgICAgICAgaWYgKCAhIHdjX3NiX2NoZWNrb3V0LmlzSW5zdGFudENoZWNrb3V0KCkgKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBAdG9kb1xuICAgICAgICB9LFxuXG4gICAgICAgIG9uVXBkYXRlZENoZWNrb3V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25VcGRhdGVkQ2hlY2tvdXQnICk7XG5cbiAgICAgICAgICAgIGlmICggISB3Y19zYl9jaGVja291dC5pc0luc3RhbnRDaGVja291dCgpICkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCB3Y19zYl9jaGVja291dC5mb3JtLmlzKCAnLnByb2Nlc3NpbmcnICkgKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoICEgd2Nfc2JfY2hlY2tvdXQudmFsaWRhdGVGb3JtKCkgKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coICdvblVwZGF0ZWRDaGVja291dDogVmFsaWRhdGlvbiBpcyBmYWlsZWQnICk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkKCAnLndvb2NvbW1lcmNlLU5vdGljZUdyb3VwLWNoZWNrb3V0LCAud29vY29tbWVyY2UtZXJyb3IsIC53b29jb21tZXJjZS1tZXNzYWdlJyApLnJlbW92ZSgpO1xuICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQudXBkYXRlT3JkZXIoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBvblN1Ym1pdDogZnVuY3Rpb24oIGUgKSB7XG4gICAgICAgICAgICBpZiAoIHdjX3NiX2NoZWNrb3V0LmZvcm1fc3VibWl0ICkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIHdjX3NiX2NoZWNrb3V0LmlzUGF5bWVudE1ldGhvZENob3NlbigpICkge1xuICAgICAgICAgICAgICAgIGlmICggdHlwZW9mIGUgIT09ICd1bmRlZmluZWQnICkge1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCAhIHdjX3NiX2NoZWNrb3V0LnZhbGlkYXRlRm9ybSgpICkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coICdvblN1Ym1pdCcgKTtcblxuICAgICAgICAgICAgICAgIGlmICggd2Nfc2JfY2hlY2tvdXQuZm9ybS5pcyggJy5wcm9jZXNzaW5nJyApICkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJCggJy53b29jb21tZXJjZS1Ob3RpY2VHcm91cC1jaGVja291dCwgLndvb2NvbW1lcmNlLWVycm9yLCAud29vY29tbWVyY2UtbWVzc2FnZScgKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICB3Y19zYl9jaGVja291dC5mb3JtLmFkZENsYXNzKCAncHJvY2Vzc2luZycgKTtcbiAgICAgICAgICAgICAgICB3Y19zYl9jaGVja291dC5ibG9jaygpO1xuICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LnBsYWNlT3JkZXIoKVxuICAgICAgICAgICAgICAgICAgICAuYWx3YXlzKCBmdW5jdGlvbiAoIHJlc3BvbnNlICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQuZm9ybS5yZW1vdmVDbGFzcyggJ3Byb2Nlc3NpbmcnICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3Y19zYl9jaGVja291dC51bmJsb2NrKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gKVxuICAgICAgICAgICAgICAgICAgICAuZmFpbCggZnVuY3Rpb24oIGpxWEhSLCB0ZXh0U3RhdHVzICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQub25FcnJvciggdGV4dFN0YXR1cyApO1xuICAgICAgICAgICAgICAgICAgICB9IClcbiAgICAgICAgICAgICAgICAgICAgLmRvbmUoIGZ1bmN0aW9uICggcmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCByZXNwb25zZSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCByZXNwb25zZS5yZXN1bHQgIT09ICdzdWNjZXNzJyApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWxvYWQgcGFnZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggcmVzcG9uc2UuaGFzT3duUHJvcGVydHkoJ3JlbG9hZCcpICYmIHRydWUgPT09IHJlc3BvbnNlLnJlbG9hZCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVHJpZ2dlciB1cGRhdGUgaW4gY2FzZSB3ZSBuZWVkIGEgZnJlc2ggbm9uY2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIHRydWUgPT09IHJlc3BvbnNlLnJlc3VsdC5yZWZyZXNoICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCBkb2N1bWVudC5ib2R5ICkudHJpZ2dlciggJ3VwZGF0ZV9jaGVja291dCcgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3Y19zYl9jaGVja291dC5vbkVycm9yKCByZXNwb25zZS5tZXNzYWdlcyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTG9hZCBTd2VkQmFuayBQYXkgQ2hlY2tvdXQgZnJhbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LmpzX3VybCA9IHJlc3BvbnNlWydqc191cmwnXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LmluaXRQYXltZW50SlMoIHdjX3NiX2NoZWNrb3V0LmpzX3VybCApO1xuICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlc2V0Q2hlY2tvdXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQuZm9ybV9zdWJtaXQgPSBmYWxzZTtcbiAgICAgICAgfSxcblxuICAgICAgICB2YWxpZGF0ZUZvcm06IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciAkcmVxdWlyZWRfaW5wdXRzLFxuICAgICAgICAgICAgICAgIHZhbGlkYXRlZCA9IHRydWU7XG5cbiAgICAgICAgICAgIC8vIGNoZWNrIHRvIHNlZSBpZiB3ZSBuZWVkIHRvIHZhbGlkYXRlIHNoaXBwaW5nIGFkZHJlc3NcbiAgICAgICAgICAgIGlmICggJCggJyNzaGlwLXRvLWRpZmZlcmVudC1hZGRyZXNzLWNoZWNrYm94JyApLmlzKCAnOmNoZWNrZWQnICkgKSB7XG4gICAgICAgICAgICAgICAgJHJlcXVpcmVkX2lucHV0cyA9ICQoICcud29vY29tbWVyY2UtYmlsbGluZy1maWVsZHMgLnZhbGlkYXRlLXJlcXVpcmVkLCAud29vY29tbWVyY2Utc2hpcHBpbmctZmllbGRzIC52YWxpZGF0ZS1yZXF1aXJlZCcgKS5maW5kKCdpbnB1dCwgc2VsZWN0Jykubm90KCAkKCAnI2FjY291bnRfcGFzc3dvcmQsICNhY2NvdW50X3VzZXJuYW1lJyApICk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRyZXF1aXJlZF9pbnB1dHMgPSAkKCAnLndvb2NvbW1lcmNlLWJpbGxpbmctZmllbGRzIC52YWxpZGF0ZS1yZXF1aXJlZCcgKS5maW5kKCdpbnB1dCwgc2VsZWN0Jykubm90KCAkKCAnI2FjY291bnRfcGFzc3dvcmQsICNhY2NvdW50X3VzZXJuYW1lJyApICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICggJHJlcXVpcmVkX2lucHV0cy5sZW5ndGggKSB7XG4gICAgICAgICAgICAgICAgJHJlcXVpcmVkX2lucHV0cy5lYWNoKCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyICR0aGlzID0gJCggdGhpcyApLFxuICAgICAgICAgICAgICAgICAgICAgICAgJHBhcmVudCAgICAgICAgICAgPSAkdGhpcy5jbG9zZXN0KCAnLmZvcm0tcm93JyApLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVfcmVxdWlyZWQgPSAkcGFyZW50LmlzKCAnLnZhbGlkYXRlLXJlcXVpcmVkJyApLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVfZW1haWwgICAgPSAkcGFyZW50LmlzKCAnLnZhbGlkYXRlLWVtYWlsJyApO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICggdmFsaWRhdGVfcmVxdWlyZWQgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoICdjaGVja2JveCcgPT09ICR0aGlzLmF0dHIoICd0eXBlJyApICYmICEgJHRoaXMuaXMoICc6Y2hlY2tlZCcgKSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoICR0aGlzLnZhbCgpID09PSAnJyApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICggdmFsaWRhdGVfZW1haWwgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoICR0aGlzLnZhbCgpICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzI4NTU4NjUvanF1ZXJ5LXZhbGlkYXRlLWUtbWFpbC1hZGRyZXNzLXJlZ2V4ICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBuZXcgUmVnRXhwKC9eKCgoW2Etel18XFxkfFshI1xcJCUmJ1xcKlxcK1xcLVxcLz1cXD9cXF5fYHtcXHx9fl18W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKyhcXC4oW2Etel18XFxkfFshI1xcJCUmJ1xcKlxcK1xcLVxcLz1cXD9cXF5fYHtcXHx9fl18W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKykqKXwoKFxceDIyKSgoKChcXHgyMHxcXHgwOSkqKFxceDBkXFx4MGEpKT8oXFx4MjB8XFx4MDkpKyk/KChbXFx4MDEtXFx4MDhcXHgwYlxceDBjXFx4MGUtXFx4MWZcXHg3Zl18XFx4MjF8W1xceDIzLVxceDViXXxbXFx4NWQtXFx4N2VdfFtcXHUwMEEwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdKXwoXFxcXChbXFx4MDEtXFx4MDlcXHgwYlxceDBjXFx4MGQtXFx4N2ZdfFtcXHUwMEEwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdKSkpKSooKChcXHgyMHxcXHgwOSkqKFxceDBkXFx4MGEpKT8oXFx4MjB8XFx4MDkpKyk/KFxceDIyKSkpQCgoKFthLXpdfFxcZHxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSl8KChbYS16XXxcXGR8W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKFthLXpdfFxcZHwtfFxcLnxffH58W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKihbYS16XXxcXGR8W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKSlcXC4pKygoW2Etel18W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pfCgoW2Etel18W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKFthLXpdfFxcZHwtfFxcLnxffH58W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKihbYS16XXxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSkpKVxcLj8kL2kpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggISBwYXR0ZXJuLnRlc3QoICR0aGlzLnZhbCgpICApICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHZhbGlkYXRlZDtcbiAgICAgICAgfSxcblxuICAgICAgICB3YWl0Rm9yTG9hZGluZzogZnVuY3Rpb24gKCB2YXJfc3RyaW5nLCBjYWxsYmFjayApIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIG9iaiA9IGV2YWwoIHZhcl9zdHJpbmcgKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayggZSApO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IGF0dGVtcHRzID0gMDtcbiAgICAgICAgICAgIGxldCB0aW1lciA9IHdpbmRvdy5zZXRJbnRlcnZhbCggZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKCB0eXBlb2Ygb2JqICE9PSAndW5kZWZpbmVkJyApIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwoIHRpbWVyICk7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCBudWxsLCBvYmogKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhdHRlbXB0cysrO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIGF0dGVtcHRzID49IDEyMCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKCB0aW1lciApO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soICdUaW1lb3V0JyApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgNTAwICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIExvYWQgSlNcbiAgICAgICAgICogQHBhcmFtIGpzXG4gICAgICAgICAqIEBwYXJhbSBjYWxsYmFja1xuICAgICAgICAgKi9cbiAgICAgICAgbG9hZEpzOiBmdW5jdGlvbiAoIGpzLCBjYWxsYmFjayApIHtcbiAgICAgICAgICAgIC8vIENyZWF0ZXMgYSBuZXcgc2NyaXB0IHRhZ1xuICAgICAgICAgICAgbGV0IHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdzY3JpcHQnICk7XG5cbiAgICAgICAgICAgIC8vIFNldCBzY3JpcHQgdGFnIHBhcmFtc1xuICAgICAgICAgICAgc2NyaXB0LnNldEF0dHJpYnV0ZSggJ3NyYycsIGpzICk7XG4gICAgICAgICAgICBzY3JpcHQuc2V0QXR0cmlidXRlKCAndHlwZScsICd0ZXh0L2phdmFzY3JpcHQnICk7XG4gICAgICAgICAgICBzY3JpcHQuc2V0QXR0cmlidXRlKCAnYXN5bmMnLCAnJyApO1xuICAgICAgICAgICAgc2NyaXB0LmFkZEV2ZW50TGlzdGVuZXIoICdsb2FkJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICB9LCBmYWxzZSApO1xuXG4gICAgICAgICAgICAvLyBHZXRzIGRvY3VtZW50IGhlYWQgZWxlbWVudFxuICAgICAgICAgICAgbGV0IG9IZWFkID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoICdoZWFkJyApWzBdO1xuICAgICAgICAgICAgaWYgKCBvSGVhZCApIHtcbiAgICAgICAgICAgICAgICAvLyBBZGQgc2NyaXB0IHRhZyB0byBoZWFkXG4gICAgICAgICAgICAgICAgb0hlYWQuYXBwZW5kQ2hpbGQoIHNjcmlwdCApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gc2NyaXB0O1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbml0aWF0ZSBQYXltZW50IEphdmFzY3JpcHRcbiAgICAgICAgICogQHBhcmFtIHVybFxuICAgICAgICAgKiBAcGFyYW0gY2FsbGJhY2tcbiAgICAgICAgICovXG4gICAgICAgIGluaXRQYXltZW50SlM6IGZ1bmN0aW9uICggdXJsLCBjYWxsYmFjayApIHtcbiAgICAgICAgICAgIGlmICggdHlwZW9mIGNhbGxiYWNrID09PSAndW5kZWZpbmVkJyApIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayA9IGZ1bmN0aW9uICgpIHt9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBEZXN0cm95XG4gICAgICAgICAgICBpZiAoIHdpbmRvdy5oYXNPd25Qcm9wZXJ0eSggJ3BheWV4JyApICYmIHdpbmRvdy5wYXlleC5oYXNPd25Qcm9wZXJ0eSggJ2hvc3RlZFZpZXcnICkgKSB7XG4gICAgICAgICAgICAgICAgaWYgKCB0eXBlb2Ygd2luZG93LnBheWV4Lmhvc3RlZFZpZXcucGF5bWVudE1lbnUgIT09ICd1bmRlZmluZWQnICkge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cucGF5ZXguaG9zdGVkVmlldy5wYXltZW50TWVudSgpLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJCggJyNwYXltZW50LXN3ZWRiYW5rLXBheS1jaGVja291dCBpZnJhbWUnICkucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgLy9kZWxldGUgd2luZG93LnBheWV4Lmhvc3RlZFZpZXc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIERlc3Ryb3kgSlNcbiAgICAgICAgICAgICQoIFwic2NyaXB0W3NyYyo9J3B4LnBheW1lbnRtZW51LmNsaWVudCddXCIgKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgLy8gTG9hZCBKU1xuICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQubG9hZEpzKCB1cmwsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkKCAnI3BheW1lbnQtc3dlZGJhbmstcGF5LWNoZWNrb3V0IGlmcmFtZScgKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgICAgIC8vIExvYWQgU3dlZEJhbmsgUGF5IENoZWNrb3V0IGZyYW1lXG4gICAgICAgICAgICAgICAgaWYgKCB3Y19zYl9jaGVja291dC5pc0luc3RhbnRDaGVja291dCgpICkge1xuICAgICAgICAgICAgICAgICAgICAkKCAnI3BheW1lbnQnICkuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICB3Y19zYl9jaGVja291dC5pbml0UGF5bWVudE1lbnUoICdwYXltZW50LXN3ZWRiYW5rLXBheS1jaGVja291dCcgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkLmZlYXRoZXJsaWdodCggJzxkaXYgaWQ9XCJzd2VkYmFuay1wYXktcGF5bWVudG1lbnVcIj4mbmJzcDs8L2Rpdj4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50OiAnZmVhdGhlcmxpZ2h0LXN3ZWRiYW5rLXBheScsXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VPbkNsaWNrOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlT25Fc2M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXJPcGVuOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQuaW5pdFBheW1lbnRNZW51KCAnc3dlZGJhbmstcGF5LXBheW1lbnRtZW51JyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyQ2xvc2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3Y19zYl9jaGVja291dC5mb3JtLnJlbW92ZUNsYXNzKCAncHJvY2Vzc2luZycgKS51bmJsb2NrKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpXG4gICAgICAgICAgICB9ICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluaXRpYXRlIFBheW1lbnQgTWVudS5cbiAgICAgICAgICogUGF5bWVudCBKYXZhc2NyaXB0IG11c3QgYmUgbG9hZGVkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gaWRcbiAgICAgICAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAgICAgICAqL1xuICAgICAgICBpbml0UGF5bWVudE1lbnU6IGZ1bmN0aW9uICggaWQsIGNhbGxiYWNrICkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coICdpbml0UGF5bWVudE1lbnUnICk7XG5cbiAgICAgICAgICAgIGlmICggdHlwZW9mIGNhbGxiYWNrID09PSAndW5kZWZpbmVkJyApIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayA9IGZ1bmN0aW9uICgpIHt9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBMb2FkIFN3ZWRCYW5rIFBheSBDaGVja291dCBmcmFtZVxuICAgICAgICAgICAgdGhpcy5wYXltZW50TWVudSA9IHdpbmRvdy5wYXlleC5ob3N0ZWRWaWV3LnBheW1lbnRNZW51KCB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyOiBpZCxcbiAgICAgICAgICAgICAgICBjdWx0dXJlOiBXQ19HYXRld2F5X1N3ZWRiYW5rX1BheV9DaGVja291dC5jdWx0dXJlLFxuICAgICAgICAgICAgICAgIHN0eWxlOiBXQ19HYXRld2F5X1N3ZWRiYW5rX1BheV9DaGVja291dC5wYXltZW50TWVudVN0eWxlID8gSlNPTi5wYXJzZSggV0NfR2F0ZXdheV9Td2VkYmFua19QYXlfQ2hlY2tvdXQucGF5bWVudE1lbnVTdHlsZSApIDogbnVsbCxcbiAgICAgICAgICAgICAgICBvbkFwcGxpY2F0aW9uQ29uZmlndXJlZDogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25BcHBsaWNhdGlvbkNvbmZpZ3VyZWQnICk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LmlzUGF5bWVudE1lbnVMb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayggbnVsbCApO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgb25QYXltZW50TWVudUluc3RydW1lbnRTZWxlY3RlZDogZnVuY3Rpb24gKCBkYXRhICkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uUGF5bWVudE1lbnVJbnN0cnVtZW50U2VsZWN0ZWQnICk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0Lm9uUGF5bWVudE1lbnVJbnN0cnVtZW50U2VsZWN0ZWQoIGRhdGEubmFtZSwgZGF0YS5pbnN0cnVtZW50ICk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvblBheW1lbnRDcmVhdGVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25QYXltZW50Q3JlYXRlZCcgKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9uUGF5bWVudENvbXBsZXRlZDogZnVuY3Rpb24gKCBkYXRhICkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uUGF5bWVudENvbXBsZXRlZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIGRhdGEgKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5sb2NhdGlvbi5ocmVmID0gZGF0YS5yZWRpcmVjdFVybDtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9uUGF5bWVudENhbmNlbGVkOiBmdW5jdGlvbiAoIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnb25QYXltZW50Q2FuY2VsZWQnICk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LmxvZ0Vycm9yKCAncGF5bWVudC1tZW51LWNhbmNlbCcsIGRhdGEgKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9uUGF5bWVudEZhaWxlZDogZnVuY3Rpb24gKCBkYXRhICkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uUGF5bWVudEZhaWxlZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIGRhdGEgKTtcbiAgICAgICAgICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQubG9nRXJyb3IoICdwYXltZW50LW1lbnUtZmFpbGVkJywgZGF0YSApO1xuICAgICAgICAgICAgICAgICAgICAvL3NlbGYubG9jYXRpb24uaHJlZiA9IGRhdGEucmVkaXJlY3RVcmw7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvbkVycm9yOiBmdW5jdGlvbiAoIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LmxvZ0Vycm9yKCAncGF5bWVudC1tZW51LWVycm9yJywgZGF0YSApO1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayggZGF0YSApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgdGhpcy5wYXltZW50TWVudS5vcGVuKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlZnJlc2hcbiAgICAgICAgICovXG4gICAgICAgIHJlZnJlc2hQYXltZW50TWVudTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ3JlZnJlc2hQYXltZW50TWVudScgKTtcbiAgICAgICAgICAgIGlmICggdHlwZW9mIHRoaXMucGF5bWVudE1lbnUgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgICAgICAgICAgdGhpcy5wYXltZW50TWVudSAmJlxuICAgICAgICAgICAgICAgIHRoaXMucGF5bWVudE1lbnUuaGFzT3duUHJvcGVydHkoICdyZWZyZXNoJyApICYmXG4gICAgICAgICAgICAgICAgdHlwZW9mIHRoaXMucGF5bWVudE1lbnUucmVmcmVzaCA9PT0gJ2Z1bmN0aW9uJyApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXltZW50TWVudS5yZWZyZXNoKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybiggJ3JlZnJlc2hQYXltZW50TWVudTogcmVmcmVzaCB3b3JrYXJvdW5kJyApO1xuICAgICAgICAgICAgICAgIC8vd2Nfc2JfY2hlY2tvdXQuaW5pdFBheW1lbnRKUyggd2Nfc2JfY2hlY2tvdXQuanNfdXJsIClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogUGxhY2UgT3JkZXJcbiAgICAgICAgICogQHJldHVybiB7SlF1ZXJ5UHJvbWlzZTxhbnk+fVxuICAgICAgICAgKi9cbiAgICAgICAgcGxhY2VPcmRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coICdwbGFjZU9yZGVyJyApO1xuICAgICAgICAgICAgbGV0IGZpZWxkcyA9ICQoJy53b29jb21tZXJjZS1jaGVja291dCcpLnNlcmlhbGl6ZSgpO1xuXG4gICAgICAgICAgICByZXR1cm4gJC5hamF4KCB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIHVybDogV0NfR2F0ZXdheV9Td2VkYmFua19QYXlfQ2hlY2tvdXQuYWpheF91cmwsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdzd2VkYmFua19wYXlfcGxhY2Vfb3JkZXInLFxuICAgICAgICAgICAgICAgICAgICBub25jZTogV0NfR2F0ZXdheV9Td2VkYmFua19QYXlfQ2hlY2tvdXQubm9uY2UsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGZpZWxkc1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJ1xuICAgICAgICAgICAgfSApLmRvbmUoIGZ1bmN0aW9uICggcmVzcG9uc2UgKSB7XG4gICAgICAgICAgICAgICAgLy8gUmVsb2FkIHBhZ2VcbiAgICAgICAgICAgICAgICBpZiAoIHJlc3BvbnNlLmhhc093blByb3BlcnR5KCdyZWxvYWQnKSAmJiB0cnVlID09PSByZXNwb25zZS5yZWxvYWQgKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgXHRcdH1cblxuICAgICAgICAgICAgICAgIGlmICggcmVzcG9uc2UuaGFzT3duUHJvcGVydHkoJ3Jlc3VsdCcpICYmIHJlc3BvbnNlLnJlc3VsdCA9PT0gJ2ZhaWx1cmUnICkge1xuICAgICAgICAgICAgICAgICAgICB3Y19zYl9jaGVja291dC5sb2dFcnJvciggJ3NiLXBsYWNlLW9yZGVyJywgcmVzcG9uc2UgKTtcbiAgICAgICAgICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQub25FcnJvciggcmVzcG9uc2UubWVzc2FnZXMgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9ICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFVwZGF0ZSBPcmRlclxuICAgICAgICAgKiBAcGFyYW0gY29tcGF0aWJpbGl0eVxuICAgICAgICAgKiBAcmV0dXJuIHtKUXVlcnlQcm9taXNlPGFueT59XG4gICAgICAgICAqL1xuICAgICAgICB1cGRhdGVPcmRlcjogZnVuY3Rpb24gKCBjb21wYXRpYmlsaXR5ICkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coICd1cGRhdGVPcmRlcicgKTtcbiAgICAgICAgICAgIGxldCBmaWVsZHMgPSAkKCcud29vY29tbWVyY2UtY2hlY2tvdXQnKS5zZXJpYWxpemUoKTtcblxuICAgICAgICAgICAgaWYgKCB0eXBlb2YgY29tcGF0aWJpbGl0eSA9PT0gJ3VuZGVmaW5lZCcgKSB7XG4gICAgICAgICAgICAgICAgY29tcGF0aWJpbGl0eSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmaWVsZHMgKz0gJyZjb21wYXRpYmlsaXR5PScgKyBjb21wYXRpYmlsaXR5O1xuXG4gICAgICAgICAgICB3Y19zYl9jaGVja291dC5mb3JtLmFkZENsYXNzKCAncHJvY2Vzc2luZycgKTtcbiAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LmJsb2NrKCk7XG5cbiAgICAgICAgICAgIGlmICggd2Nfc2JfY2hlY2tvdXQueGhyICkge1xuICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0Lnhoci5hYm9ydCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3Y19zYl9jaGVja291dC54aHIgPSAkLmFqYXgoIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgdXJsOiBXQ19HYXRld2F5X1N3ZWRiYW5rX1BheV9DaGVja291dC5hamF4X3VybCxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ3N3ZWRiYW5rX3BheV91cGRhdGVfb3JkZXInLFxuICAgICAgICAgICAgICAgICAgICBub25jZTogV0NfR2F0ZXdheV9Td2VkYmFua19QYXlfQ2hlY2tvdXQubm9uY2UsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGZpZWxkc1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJ1xuICAgICAgICAgICAgfSApXG4gICAgICAgICAgICAgICAgLmFsd2F5cyggZnVuY3Rpb24gKCByZXNwb25zZSApIHtcbiAgICAgICAgICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQueGhyID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LmZvcm0ucmVtb3ZlQ2xhc3MoICdwcm9jZXNzaW5nJyApO1xuICAgICAgICAgICAgICAgICAgICB3Y19zYl9jaGVja291dC51bmJsb2NrKCk7XG4gICAgICAgICAgICAgICAgfSApXG4gICAgICAgICAgICAgICAgLmZhaWwoIGZ1bmN0aW9uKCBqcVhIUiwgdGV4dFN0YXR1cyApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coICd1cGRhdGVPcmRlciBlcnJvcjonICsgdGV4dFN0YXR1cyApO1xuICAgICAgICAgICAgICAgICAgICB3Y19zYl9jaGVja291dC5vbkVycm9yKCB0ZXh0U3RhdHVzICk7XG4gICAgICAgICAgICAgICAgfSApXG4gICAgICAgICAgICAgICAgLmRvbmUoIGZ1bmN0aW9uICggcmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIHJlc3BvbnNlICk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCByZXNwb25zZS5oYXNPd25Qcm9wZXJ0eSgncmVzdWx0JykgJiYgcmVzcG9uc2UucmVzdWx0ID09PSAnc3VjY2VzcycgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWZyZXNoIFBheW1lbnQgTWVudVxuICAgICAgICAgICAgICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQuanNfdXJsID0gcmVzcG9uc2VbJ2pzX3VybCddO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQucmVmcmVzaFBheW1lbnRNZW51KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICggcmVzcG9uc2UuaGFzT3duUHJvcGVydHkoJ3Jlc3VsdCcpICYmIHJlc3BvbnNlLnJlc3VsdCA9PT0gJ2ZhaWx1cmUnICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3dlZEJhbmsgUGF5bWVudCByZXR1cm5zIGVycm9yIHRoYXQgT3JkZXIgdXBkYXRlIGlzIG5vdCBhdmFpbGFibGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggcmVzcG9uc2UubWVzc2FnZXMuaW5kZXhPZiggJ09yZGVyIHVwZGF0ZSBpcyBub3QgYXZhaWxhYmxlLicgKSA+IC0xICYmICEgY29tcGF0aWJpbGl0eSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGb3JjZSByZWxvYWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oICdyZWZyZXNoUGF5bWVudE1lbnU6IHJlZnJlc2ggd29ya2Fyb3VuZC4gRm9yY2UgcmVsb2FkLicgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3Y19zYl9jaGVja291dC51cGRhdGVPcmRlciggdHJ1ZSApLmRvbmUoIGZ1bmN0aW9uICggcmVzcG9uc2UgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggcmVzcG9uc2UuaGFzT3duUHJvcGVydHkoJ2pzX3VybCcpICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQuaW5pdFBheW1lbnRKUyggcmVzcG9uc2UuanNfdXJsICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBSZWxvYWQgcGFnZVxuICAgICAgICAgICAgICAgICAgICBpZiAoIHJlc3BvbnNlLmhhc093blByb3BlcnR5KCdyZWxvYWQnKSAmJiB0cnVlID09PSByZXNwb25zZS5yZWxvYWQgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgdXBkYXRlIGluIGNhc2Ugd2UgbmVlZCBhIGZyZXNoIG5vbmNlXG4gICAgICAgICAgICAgICAgICAgIGlmICggdHJ1ZSA9PT0gcmVzcG9uc2UucmVzdWx0LnJlZnJlc2ggKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCBkb2N1bWVudC5ib2R5ICkudHJpZ2dlciggJ3VwZGF0ZV9jaGVja291dCcgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LmxvZ0Vycm9yKCAnc2ItdXBkYXRlLW9yZGVyJywgcmVzcG9uc2UgKTtcbiAgICAgICAgICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQub25FcnJvciggcmVzcG9uc2UubWVzc2FnZXMgKTtcbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gIHdjX3NiX2NoZWNrb3V0LnhocjtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogT24gQ29uc3VtZXIgSWRlbnRpZmllZFxuICAgICAgICAgKiBAcGFyYW0gZGF0YVxuICAgICAgICAgKiBAcmV0dXJucyB7Kn1cbiAgICAgICAgICovXG4gICAgICAgIG9uQ29uc3VtZXJJZGVudGlmaWVkOiBmdW5jdGlvbiAoIGRhdGEgKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uQ29uc3VtZXJJZGVudGlmaWVkJywgZGF0YSApO1xuICAgICAgICAgICAgJCggJyNjaGFuZ2Utc2hpcHBpbmctaW5mbycgKS5zaG93KCk7XG5cbiAgICAgICAgICAgIHJldHVybiAkLmFqYXgoIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgdXJsOiBXQ19HYXRld2F5X1N3ZWRiYW5rX1BheV9DaGVja291dC5hamF4X3VybCxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ3N3ZWRiYW5rX3BheV9jaGVja291dF9jdXN0b21lcl9wcm9maWxlJyxcbiAgICAgICAgICAgICAgICAgICAgbm9uY2U6IFdDX0dhdGV3YXlfU3dlZGJhbmtfUGF5X0NoZWNrb3V0Lm5vbmNlLFxuICAgICAgICAgICAgICAgICAgICBjb25zdW1lclByb2ZpbGVSZWY6IGRhdGEuY29uc3VtZXJQcm9maWxlUmVmXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXG4gICAgICAgICAgICB9ICkuYWx3YXlzKCBmdW5jdGlvbiAoIHJlc3BvbnNlICkge1xuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICB9ICkuZG9uZSggZnVuY3Rpb24gKCByZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQocmVzcG9uc2UuZGF0YS5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIEluaXRpYXRlIENoZWNrb3V0XG4gICAgICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQuaW5pdENoZWNrb3V0KCBkYXRhLmNvbnN1bWVyUHJvZmlsZVJlZiApO1xuICAgICAgICAgICAgfSApO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBPbiBBZGRyZXNzIERldGFpbHMgQXZhaWxhYmxlXG4gICAgICAgICAqIEBwYXJhbSB0eXBlXG4gICAgICAgICAqIEBwYXJhbSBkYXRhXG4gICAgICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAgICAgKi9cbiAgICAgICAgb25BZGRyZXNzRGV0YWlsc0F2YWlsYWJsZTogZnVuY3Rpb24oIHR5cGUsIGRhdGEgKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uQWRkcmVzc0RldGFpbHNBdmFpbGFibGUnLCB0eXBlLCBkYXRhICk7XG5cbiAgICAgICAgICAgICQoICcjY2hhbmdlLXNoaXBwaW5nLWluZm8nICkuc2hvdygpO1xuXG4gICAgICAgICAgICB3Y19zYl9jaGVja291dC5ibG9jaygpO1xuICAgICAgICAgICAgcmV0dXJuICQuYWpheCgge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICB1cmw6IFdDX0dhdGV3YXlfU3dlZGJhbmtfUGF5X0NoZWNrb3V0LmFqYXhfdXJsLFxuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAnc3dlZGJhbmtfcGF5X2NoZWNrb3V0X2dldF9hZGRyZXNzJyxcbiAgICAgICAgICAgICAgICAgICAgbm9uY2U6IFdDX0dhdGV3YXlfU3dlZGJhbmtfUGF5X0NoZWNrb3V0Lm5vbmNlLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IGRhdGEudXJsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXG4gICAgICAgICAgICB9ICkuYWx3YXlzKCBmdW5jdGlvbiAoIHJlc3BvbnNlICkge1xuICAgICAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LnVuYmxvY2soKTtcbiAgICAgICAgICAgIH0gKS5kb25lKCBmdW5jdGlvbiAoIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2Uuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICB3Y19zYl9jaGVja291dC5sb2dFcnJvcignc2ItYWRkcmVzcy1kZXRhaWxzJywgcmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICBhbGVydChyZXNwb25zZS5kYXRhLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gUHJvY2VzcyBhZGRyZXNzXG4gICAgICAgICAgICAgICAgbGV0IGRhdGEgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgICAgICQuZWFjaChkYXRhLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBbdHlwZV0uZm9yRWFjaChmdW5jdGlvbihzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZWwgPSAkKCdpbnB1dFtuYW1lPVwiJyArIHNlY3Rpb24gKyAnXycgKyBrZXkgKyAnXCJdJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWwubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBlbC5wcm9wKCdyZWFkb25seScsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsLmNsb3Nlc3QoJy5mb3JtLXJvdycpLnJlbW92ZUNsYXNzKCdzd2VkYmFuay1wYXktbG9ja2VkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbC52YWwodmFsdWUpLmNoYW5nZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ID09PSAnY291bnRyeScgfHwga2V5ID09PSAnc3RhdGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVsMSA9ICQoJyMnICsgc2VjdGlvbiArICdfJyArIGtleSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cuU2VsZWN0MiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwxLnNlbGVjdDIoJ3ZhbCcsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiAkLmZuLmNob3NlbiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hvc2VuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsMS52YWwodmFsdWUpLnRyaWdnZXIoJ2Nob3Nlbjp1cGRhdGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vZWwxLmNob3NlbigpLmNoYW5nZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsMS5jaGFuZ2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgJCggZG9jdW1lbnQuYm9keSApLnRyaWdnZXIoICd1cGRhdGVfY2hlY2tvdXQnICk7XG4gICAgICAgICAgICB9ICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE9uIFBheW1lbnQgTWVudSBJbnN0cnVtZW50IFNlbGVjdGVkXG4gICAgICAgICAqIEBwYXJhbSBuYW1lXG4gICAgICAgICAqIEBwYXJhbSBpbnN0cnVtZW50XG4gICAgICAgICAqL1xuICAgICAgICBvblBheW1lbnRNZW51SW5zdHJ1bWVudFNlbGVjdGVkOiBmdW5jdGlvbiAoIG5hbWUsIGluc3RydW1lbnQgKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uUGF5bWVudE1lbnVJbnN0cnVtZW50U2VsZWN0ZWQnLCBuYW1lLCBpbnN0cnVtZW50ICk7XG4gICAgICAgICAgICAkKCBkb2N1bWVudC5ib2R5ICkudHJpZ2dlciggJ3NiX3BheW1lbnRfbWVudV9pbnN0cnVtZW50X3NlbGVjdGVkJywgW25hbWUsIGluc3RydW1lbnRdICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIExvZyBFcnJvclxuICAgICAgICAgKiBAcGFyYW0gaWRcbiAgICAgICAgICogQHBhcmFtIGRhdGFcbiAgICAgICAgICogQHJldHVybnMgeyp9XG4gICAgICAgICAqL1xuICAgICAgICBsb2dFcnJvcjogZnVuY3Rpb24gKCBpZCwgZGF0YSApIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybiggZGF0YSApO1xuXG4gICAgICAgICAgICByZXR1cm4gJC5hamF4KCB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIHVybDogV0NfR2F0ZXdheV9Td2VkYmFua19QYXlfQ2hlY2tvdXQuYWpheF91cmwsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdzd2VkYmFua19wYXlfY2hlY2tvdXRfbG9nX2Vycm9yJyxcbiAgICAgICAgICAgICAgICAgICAgbm9uY2U6IFdDX0dhdGV3YXlfU3dlZGJhbmtfUGF5X0NoZWNrb3V0Lm5vbmNlLFxuICAgICAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KCBkYXRhIClcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbidcbiAgICAgICAgICAgIH0gKTtcbiAgICAgICAgfSxcblxuICAgICAgICBvbkVycm9yOiBmdW5jdGlvbiAoIGRhdGEgKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ29uRXJyb3InLCBkYXRhICk7XG4gICAgICAgICAgICB3Y19zYl9jaGVja291dC5zdWJtaXRfZXJyb3IoICc8ZGl2IGNsYXNzPVwid29vY29tbWVyY2UtZXJyb3JcIj4nICsgZGF0YSArICc8L2Rpdj4nICk7XG4gICAgICAgIH0sXG4gICAgICAgIHN1Ym1pdF9lcnJvcjogZnVuY3Rpb24oIGVycm9yX21lc3NhZ2UgKSB7XG4gICAgICAgICAgICAkKCAnLndvb2NvbW1lcmNlLU5vdGljZUdyb3VwLWNoZWNrb3V0LCAud29vY29tbWVyY2UtZXJyb3IsIC53b29jb21tZXJjZS1tZXNzYWdlJyApLnJlbW92ZSgpO1xuICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQuZm9ybS5wcmVwZW5kKCAnPGRpdiBjbGFzcz1cIndvb2NvbW1lcmNlLU5vdGljZUdyb3VwIHdvb2NvbW1lcmNlLU5vdGljZUdyb3VwLWNoZWNrb3V0XCI+JyArIGVycm9yX21lc3NhZ2UgKyAnPC9kaXY+JyApO1xuICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQuZm9ybS5yZW1vdmVDbGFzcyggJ3Byb2Nlc3NpbmcnICkudW5ibG9jaygpO1xuICAgICAgICAgICAgd2Nfc2JfY2hlY2tvdXQuZm9ybS5maW5kKCAnLmlucHV0LXRleHQsIHNlbGVjdCwgaW5wdXQ6Y2hlY2tib3gnICkudHJpZ2dlciggJ3ZhbGlkYXRlJyApLmJsdXIoKTtcbiAgICAgICAgICAgIHdjX3NiX2NoZWNrb3V0LnNjcm9sbF90b19ub3RpY2VzKCk7XG4gICAgICAgICAgICAkKCBkb2N1bWVudC5ib2R5ICkudHJpZ2dlciggJ2NoZWNrb3V0X2Vycm9yJyApO1xuICAgICAgICB9LFxuICAgICAgICBzY3JvbGxfdG9fbm90aWNlczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBsZXQgc2Nyb2xsRWxlbWVudCA9ICQoICcud29vY29tbWVyY2UtTm90aWNlR3JvdXAtdXBkYXRlT3JkZXJSZXZpZXcsIC53b29jb21tZXJjZS1Ob3RpY2VHcm91cC1jaGVja291dCcgKTtcbiAgICAgICAgICAgIGlmICggISBzY3JvbGxFbGVtZW50Lmxlbmd0aCApIHtcbiAgICAgICAgICAgICAgICBzY3JvbGxFbGVtZW50ID0gJCggJy5mb3JtLmNoZWNrb3V0JyApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkLnNjcm9sbF90b19ub3RpY2VzKCBzY3JvbGxFbGVtZW50ICk7XG4gICAgICAgIH0sXG4gICAgICAgIGhpZGVBZGRyZXNzRmllbGRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkKCAnLndvb2NvbW1lcmNlLWJpbGxpbmctZmllbGRzX19maWVsZC13cmFwcGVyLCAud29vY29tbWVyY2Utc2hpcHBpbmctZmllbGRzJyApLmhpZGUoKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2hvd0FkZHJlc3NGaWVsZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICQoICcud29vY29tbWVyY2UtYmlsbGluZy1maWVsZHNfX2ZpZWxkLXdyYXBwZXIsIC53b29jb21tZXJjZS1zaGlwcGluZy1maWVsZHMnICkuc2hvdygpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgICQoZG9jdW1lbnQpLnJlYWR5KCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHdjX3NiX2NoZWNrb3V0LmluaXQoICQoIFwiZm9ybS5jaGVja291dCwgZm9ybSNvcmRlcl9yZXZpZXcsIGZvcm0jYWRkX3BheW1lbnRfbWV0aG9kXCIgKSApO1xuICAgIH0gKTtcbn0pO1xuXG4iXX0=
